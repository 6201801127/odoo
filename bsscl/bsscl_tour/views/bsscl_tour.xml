<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <data>
        <!--============ Apply tour form view =============== -->
        <record id="bsscl_tour_view_form_id" model="ir.ui.view">
            <field name="name">BSSCL: Tour from views</field>
            <field name="model">bsscl.tour</field>
            <field name="arch" type="xml">
                <form string="Tour Form">
                    <script >
                        $('textarea[name="purpose_of_travel"]').on("input", function() {
                            $('#description').show()
                            var currentLength = $(this).val().length;
                            $('textarea[name="purpose_of_travel"]').attr('maxlength',500);
                            var textlen = 500 - $(this).val().length;
                            $('#description').text(textlen + " Left");
                        });
                        
                        $('#description').text() == '500 Left'?$('#description').hide():$('#description').show()
                    </script>
                    <header>
                        <button name="action_apply_tour" string="Apply / आवेदन करना" class="btn btn-primary" type="object" attrs="{'invisible':[('state','!=','Draft')]}"/>
                        <button name="action_approve_tour_by_manager" string="Approve / 
                        मंज़ूरी देना" groups="bsscl_tour.bsscl_tour_manager_group_id" class="btn btn-primary" type="object" attrs="{'invisible':[('state','!=','Applied')]}"/>
                        <!-- <button name="action_approve_tour_by_deputy_comm" string="Approve / 
                        मंज़ूरी देना" groups="bsscl_employee.deputy_com_id" class="btn btn-primary" type="object" attrs="{'invisible':[('state','!=','approved_by_manager')]}"/> -->
                        <!-- <button name="action_approve_tour_by_commissioner" string="Approve / 
                        मंज़ूरी देना" groups="bsscl_employee.commissioner_id" class="btn btn-primary" type="object" attrs="{'invisible':[('state','!=','approved_by_deputy')]}"/> -->
                        <button name="bsscl_tour.tour_rejection_action" string="Reject / अस्वीकार करना" groups="bsscl_tour.bsscl_tour_manager_group_id,bsscl_employee.commissioner_id,bsscl_employee.deputy_com_id" class="btn btn-primary" type="action" attrs="{'invisible':['|','|','|',('state','in',['Draft','completed','cancelled']),('boolean_checked_by_manager','!=',False),('boolean_checked_by_deputy_comm','!=',False),('state','not in',['Draft','completed','cancelled','Applied','approved_by_manager','approved_by_deputy'])]}"/>
                        <field name="state" widget="statusbar" />
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="apply_for" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                                <field name="employee_id" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}" options="{'no_create':True,'no_open':True,'no_create_edit': True}"/>
                                <field name="date_of_travel" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                                <field name="originating_place_id" required="1" options="{'no_create':True,'no_open':True,'no_create_edit': True}" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                                <!-- <field name="purpose_of_travel" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/> -->
                                <label for="purpose_of_travel"/>
                                <div>
                                    <field name="purpose_of_travel" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                                    <p id="description"></p>
                                    <field name="word_limit" invisible="1"/>
                                </div>
                                <field name="boolean_checked_by_manager" invisible="1"/>
                                <field name="boolean_checked_by_deputy_comm" invisible="1"/>
                                <field name="boolean_checked_by_commissioner" invisible="1"/>
                                <field name="manager_rejection_reason" attrs="{'invisible':['|',('state','not in',['Applied','cancelled']),('manager_rejection_reason','=',False)],'readonly':[('state','in',['cancelled'])]}"/>
                                <field name="deputy_rejection_reason" attrs="{'invisible':['|',('state','not in',['approved_by_manager','cancelled']),('deputy_rejection_reason','=',False)],'readonly':[('state','in',['cancelled'])]}"/>
                                <field name="commissioner_rejection_reason" attrs="{'invisible':['|',('state','not in',['approved_by_deputy','cancelled']),('commissioner_rejection_reason','=',False)],'readonly':[('state','in',['cancelled'])]}"/>
                            </group>
                            <group>
                                <field name="return_date" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                                <field name="travel_arrangement" required="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                                <field name="currency_id" invisible="1"/>
                                <field name="advance_amount" widget="monetary" readonly="1" attrs="{'invisible':[('advance_amount','=',False)]}"/>
                            </group>
                        </group>
                        <group string="Tour Details / भ्रमण विवरण" >
                            <field name="tour_details_ids" nolabel="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                        </group>
                        <group string="Travel Expense / यात्रा खर्च">
                            <group>
                                <field name="travel_expense_details_ids" readonly="1" force_save="1" nolabel="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                            </group>
                        </group>
                        <group string="Travel Booking Details / यात्रा बुकिंग विवरण">
                            <group>
                                <field name="travel_booking_ids" readonly="1" nolabel="1"/>
                            </group>
                        </group>
                        <group string="Medical Expense / चिकित्सा खर्च">
                            <group>
                                <field name="medical_exp_ids" nolabel="1" readonly="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                            </group>
                        </group>
                        <group string="Telephone Bill Expense / टेलीफोन बिल खर्च">
                            <group>
                                <field name="telephone_bill_exp_ids" nolabel="1" readonly="1" attrs="{'readonly':[('state','in',['completed','cancelled'])]}"/>
                            </group>
                        </group>
                        <group string="Tour Settlement / टूर सेटलमेंट">
                            <group>
                                <field name="tour_settlement_ids" readonly="1" nolabel="1"/>
                                <group class="oe_subtotal_footer oe_right">
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="amount_total"/>
                                    </div>
                                    <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="medical_amount_total"/>
                                    </div>
                                    <field name="medical_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="telephone_amount_total"/>
                                    </div>
                                    <field name="telephone_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="advance_amount_total"/>
                                    </div>
                                    <field name="advance_amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="travel_expense_ammount"/>
                                    </div>
                                    <field name="travel_expense_ammount" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                    <div class="oe_subtotal_footer_separator oe_inline">
                                        <label for="claim_ammount"/>
                                    </div>
                                    <field name="claim_ammount" nolabel="1" class="oe_subtotal_footer_separator" widget="monetary"/>
                                </group>
                            </group>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!--============ Apply tour tree view =============== -->
        <record id="bsscl_tour_view_tree" model="ir.ui.view">
            <field name="name">BSSCL: Tour tree view</field>
            <field name="model">bsscl.tour</field>
            <field name="arch" type="xml">
                <tree string="Tour Tree ">
                    <field name="date_of_travel" />
                    <field name="originating_place_id" />
                    <field name="return_date" />
                    <field name="employee_id" required="1"/>
                    <field name="travel_arrangement" />
                    <field name="purpose_of_travel" />
                    <field name="state"/>
                </tree>
            </field>
        </record>
        <!--============ Apply tour action view =============== -->
        <record id="bsscl_tour_action_id" model="ir.actions.act_window">
            <field name="name">Tour / यात्रा</field>
            <field name="res_model">bsscl.tour</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('create_uid','=',uid)]</field>
        </record>

        <!--============ Apply tour action view for manager =============== -->
        <record id="bsscl_tour_manager_action_id" model="ir.actions.act_window">
            <field name="name">Tour / यात्रा</field>
            <field name="res_model">bsscl.tour</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state', '=','Applied')]</field>
        </record>

        <!--============ Apply tour action view for Deputy-Commissioner =============== -->
        <!-- <record id="bsscl_tour_deputy_comm_action_id" model="ir.actions.act_window">
            <field name="name">Tour / यात्रा</field>
            <field name="res_model">bsscl.tour</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state', '=','approved_by_manager')]</field>
        </record> -->
        <!--============ Apply tour action view for Commissioner =============== -->
        <!-- <record id="bsscl_tour_commissioner_action_id" model="ir.actions.act_window">
            <field name="name">Tour / यात्रा</field>
            <field name="res_model">bsscl.tour</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state', '=','approved_by_deputy')]</field>
        </record> -->

        <!--============ Apply tour action view for Completed =============== -->
        <record id="bsscl_tour_completed_action_id" model="ir.actions.act_window">
            <field name="name">Tour / यात्रा</field>
            <field name="res_model">bsscl.tour</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state', '=','completed')]</field>
            <field name="context">{'create': False,'edit':False}</field>
        </record>
        <!--============ view status tour action ============== -->
        <record id="bsscl_tour_view_status_action_id" model="ir.actions.act_window">
            <field name="name">Tour / यात्रा</field>
            <field name="res_model">bsscl.tour</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'group_by': 'state'}</field>
        </record>



    </data>


</odoo>
