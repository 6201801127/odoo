
<odoo>

    <record id="account_analytic_line_form" model="ir.ui.view">
        <field name="name">account.analytic.line.form</field>
        <field name="model">account.analytic.line</field>
        <field name="arch" type="xml">
            <form>
                <script>
                        $(document).ready(function(){ state=  $("[aria-pressed=true]").text().trim();
                        console.log(state);
                        if((state == 'confirm')){
                            $('.o_form_button_edit').hide();
                        }
                    });
                </script>
                <header>
                    <button string="Confirm" name="confirm_utilization" type="object" attrs="{'invisible':[('state','=','confirm')]}"
                            class="oe_highlight"
                             />
                    <field name="state" widget="statusbar" invisible="0" statusbar_visible="draft,confirm"/>
                </header>
                <sheet>
                    <group>
                        <group name="analytic_entry">
                            <field name="budget_id"  options="{'no_create':True, 'no_edit':True, 'no_open':True}"  required="1" attrs="{'readonly':[('state','=','confirm')]}"/>
<!--                            <field name="coe_id" options="{'no_create':True, 'no_edit':True, 'no_open':True}"  required="1"/>-->
<!--                            <field name="project_id" options="{'no_create':True, 'no_edit':True, 'no_open':True}"  required="1"/>-->
<!--                            <field name="account_id" invisible="1"/>-->
                            <field name="company_id" invisible="1"/>
                            <field name="account_id" readonly="1" force_save="1"/>
<!--                            <field name="bsscl_center_id" invisible="1"/>-->
<!--                            <field name="currency_id" invisible="1"/>-->

<!--                            -->
                        </group>
                        <group>
                            <field name="bsscl_center_id" attrs="{'readonly':[('state','=','confirm')]}"/>
                             <field name="date" attrs="{'readonly':[('state','=','confirm')]}"/>

                        </group>
                        <group>
                            <h1>Budget Utilization Details.</h1><br></br>
                            <field name="actual_general_budget_id"
                                   options="{'no_create':True, 'no_edit':True, 'no_open':True}"
                                    required="1" attrs="{'readonly':[('state','=','confirm')]}"/>
                            <field name="actual_general_account_id"
                                   options="{'no_create':True, 'no_edit':True, 'no_open':True}"
                                   attrs="{'invisible': [('actual_general_budget_id','=',False)], 'readonly':[('state','=','confirm')]}" required="1"/>
<!--                            <field name="actual_investment_detail_id"-->
<!--                                   domain="[('bsscl_center_id', '=', bsscl_center_id)]"-->
<!--                                   options="{'no_open': True, 'no_create': True, 'no_edit': True}"/>-->

                        </group>

                        <group>
                            <h1>Actual Budget Utilization Details.</h1><br></br>

                            <field name="general_budget_id"
                                   options="{'no_create':True, 'no_edit':True, 'no_open':True}"
                                     required="1" attrs="{'readonly':[('state','=','confirm')]}"/>
                            <field name="general_account_id"
                                   options="{'no_create':True, 'no_edit':True, 'no_open':True}"
                                   attrs="{'invisible': [('general_budget_id','=',False)], 'readonly':[('state','=','confirm')]}" required="1" />
<!--                            <field name="investors_ids" widget="many2many_tags"/>-->
                            <field name="investor_partner_id" invisible="1"
                                   options="{'no_create':True, 'no_edit':True, 'no_open':True}"/>
<!--                            <field name="investment_detail_id"-->
<!--                                   domain="[('bsscl_center_id', '=', bsscl_center_id)]"-->
<!--                                   options="{'no_open': True, 'no_create': True, 'no_edit': True}"/>-->
                            <field name="amount" widget="monetary" options="{'currency_field': 'currency_id'}" attrs="{'readonly':[('state','=','confirm')]}"/>

                            <field name="currency_id" invisible="1"/>
                             <field name="name" string="Naration" attrs="{'readonly':[('state','=','confirm')]}"/>
                            <field name="utilization_upload" readonly="0" required="1" attrs="{'readonly':[('state','=','confirm')]}"/>

                        </group>
                    </group>
                    <notebook>
                        <page name="fund_lines">
                            <field name="account_utilization_ids" readonly="1" force_save="1" options="{'no_open': True}">
                                <tree>
                                    <field name="company_id" invisible="1"/>
                                    <field name="currency_id" invisible="1"/>
<!--                                    <field name="partner_id"/>-->
                                    <field name="account_ids" widget="many2many_tags"/>
                                    <field name="declared_amount"/>
                                    <field name="received_amount"/>
                                    <field name="utilized_amount"/>
                                    <field name="balance_amount"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

     <record id="view_analytic_line_filter_inherit" model="ir.ui.view">
            <field name="name">account.analytic.line.select</field>
            <field name="model">account.analytic.line</field>
            <field name="arch" type="xml">
                <search string="Search Analytic Lines">
                    <field name="name"/>
                    <field name="budget_id"/>
                    <field name="general_budget_id"/>
                    <field name="date"/>
                    <field name="general_account_id"/>
                    <group string="Group By..." expand="0" name="groupby">
                        <filter string="Account Code" context="{'group_by':'general_account_id'}" name="general_account_id"/>
                        <filter string="Budget" context="{'group_by':'budget_id'}" name="budget_id"/>
                        <filter string="Budgetary Position" context="{'group_by':'general_budget_id'}" name="general_budget_id"/>
                        <filter string="Date" context="{'group_by':'date'}" name="group_date"/>
                    </group>
                </search>
            </field>
        </record>

    <record model="ir.actions.act_window" id="account_analytic_line_action_entries">
            <field name="name">Fund Utilization</field>
            <field name="res_model">account.analytic.line</field>
            <field name="binding_view_types">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_account_analytic_line_tree_inherit"/>
            <field name="search_view_id" ref="view_analytic_line_filter_inherit"/>
            <field name="context">{'group_by': ['bsscl_center_id']}</field>
            <field name="domain">[]</field>
            <field name="help" type="html">

              <p class="o_view_nocontent_empty_folder">
                No activity yet
              </p><p>
                You can create your budget utilization here!!!.
              </p>
            </field>
        </record>

    <record id="action_tree1_view1" model="ir.actions.act_window.view">
        <field eval="1" name="sequence"/>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="analytic.view_account_analytic_line_tree"/>
        <field name="act_window_id" ref="account_analytic_line_action_entries"/>
    </record>

     <record id="action_form1_view2" model="ir.actions.act_window.view">
        <field eval="2" name="sequence"/>
        <field name="view_mode">form</field>
        <field name="view_id" ref="account_analytic_line_form"/>
        <field name="act_window_id" ref="account_analytic_line_action_entries"/>
    </record>

</odoo>