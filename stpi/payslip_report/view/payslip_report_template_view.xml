<odoo>

    <template id="report_make_payslips_report_template_view">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <head>
                        <style>
                            .custom-bg-color {
                                background-color: #E3EEF7;
                            }
                            .thead-bg-color {
                                background-color: #4c566a;
                            }
                            .custom-row {
                                display: -ms-flexbox;
                                display: flex;
                                -ms-flex-wrap: wrap;
                                flex-wrap: wrap;
                                margin-right: -3px;
                                margin-left: -3px;
                            }
                            .table {
                                width: 100%;
                                margin-bottom: 1rem;
                                background-color: transparent;
                            }
                            .table th,
                            .table td {
                                padding: 0.75rem;
                                vertical-align: top;
                                border-top: 1px solid #dee2e6;
                            }
                            .table-bordered {
                                border: 1px solid #dee2e6;
                            }
                            .table-bordered th,
                            .table-bordered td {
                                border: 1px solid #dee2e6;
                            }

                        </style>
                    </head>
                
                    <div>
                        <t t-set="decimal_precision" t-value="request.env['decimal.precision'].precision_get('Payroll')"/>
                        <div class="oe_structure">
                            <div class="custom-row" style="font-size:11px">
                                <div>
                                    <br/>
                                    <table class="table table-bordered" style="width: 1050px">
                                        <tr class="custom-bg-color">
                                            <td style="font-size:20px;" colspan="4">
                                                <b>
                                                   <center>
                                                    <h4><span t-field="o.name"/></h4>
                                                    </center>
                                                </b>
                                            </td>
                                        </tr>
                                        
                                        <tr>
                                            <td style="font-size:14px;width:510px;" colspan="2">
                                               <t t-if="o.employee_id">
                                                    <strong>Name</strong> :- <span t-field="o.employee_id"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.identify_id">
                                                    <strong>EmpNo</strong>:- <span t-field="o.employee_id.identify_id"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.job_id">
                                                    <strong>Designation</strong>:- <span t-field="o.employee_id.job_id"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.branch_id">
                                                    <strong>Center</strong>:- <span t-field="o.employee_id.branch_id"/><br/>
                                                </t>
                                                <!-- <t t-if="o.employee_id.aadhar_no">
                                                    <strong>Aadhar No</strong> :- <span t-field="o.employee_id.aadhar_no"/><br/>
                                                </t> -->
                                                <!-- <t t-if="o.employee_id.pf_no">
                                                    <strong>P.F.No</strong> :- <span t-field="o.employee_id.pf_no"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.esi_no">
                                                    <strong>ESI No</strong>:- <span t-field="o.employee_id.esi_no"/><br/>
                                                </t> -->
                                            </td>
                                            <td style="font-size:14px;width:510px;" colspan="2">
                                                <t>
                                                    <strong>PAN</strong> :- <span t-field="o.employee_id.pan_no"/><br/>
                                                </t>
                                                <t>
                                                    <strong>PF</strong> :- <span t-field="o.employee_id.pf_number"/><br/>
                                                </t>
                                                <t>
                                                    <strong>UAN</strong> :- <span t-field="o.employee_id.uan_no"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.address_home_id">
                                                    <strong> Residential Address :-  </strong><br/>
                                                    <span t-field="o.employee_id.address_home_id.street"/>
                                                    <span t-field="o.employee_id.address_home_id.street2"/><br/>
                                                    <span t-field="o.employee_id.address_home_id.city"/><br/>
                                                    <span t-field="o.employee_id.address_home_id.state_id.name"/><br/>
                                                    <span t-field="o.employee_id.address_home_id.zip"/><br/>
                                                    <span t-field="o.employee_id.address_home_id.country_id.name"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.address_home_id.phone">
                                                    Phone No:<span t-field="o.employee_id.address_home_id.phone"/><br/>
                                                </t>
                                                <!-- <span t-field="o.employee_id.adhar_card"/><br/> -->
                                            </td>
                                        </tr>

                                        <tr>
                                            <td style="font-size:14px;width:510px;" colspan="2">
                                                <t t-if="o.employee_id.bank_account_id">
                                                    <strong>Bank Name</strong> :- <span t-field="o.employee_id.bank_account_id.bank_id.name"/><br/>
                                                </t>
                                                <t t-if="o.employee_id.bank_account_number">
                                                    <strong>Bank A/C No</strong> :- <span t-field="o.employee_id.bank_account_id.acc_number"/><br/>
                                                </t>
                                            </td>
                                            <td style="font-size:14px;width:510px;" colspan="2">
                                                <t>
                                                    <strong>HPL Deduction</strong> :- <span t-esc="o.compute_hpl_ccl('HPL')"/><br/><br/>
                                                </t>
                                                <t>
                                                    <strong>CCL Deduction</strong> :- <span t-esc="o.compute_hpl_ccl('CCL')"/><br/><br/>
                                                </t>
                                            </td>
                                        </tr>
                                    </table>
                                    <table class="table table-bordered" style="width: 1050px">
                                        <tr class="custom-bg-color">
                                            <td style="font-size:15px;" align="center">
                                                <strong>Earnings</strong>
                                                <table class="table table-bordered">
                                                    
                                                    <tr class="thead-bg-color">
                                                        <td style="font-size:15px;" align="left"><strong>Name</strong></td>
                                                        <td style="font-size:15px;" align="right"><strong>Current Period</strong></td>
                                                        <!-- <td style="font-size:15px;" align="right"><strong>Year To Date</strong></td> -->
                                                    </tr>
                                                    <tbody>
                                                        <t t-foreach="o.line_ids.sorted(key=lambda x: x.sequence)" t-as="h">
                                                        
                                                        <!-- <t t-foreach='data' t-as="hy"> -->
                                                        <t t-if="h.salary_rule_id.appears_on_payslip == True and h.salary_rule_id.appear_in_allowance == True">
                                                            <!-- <t t-set='data' t-value="o.tod_calculate()"/> -->
                                                            <tr>
                                                                <!-- <t t-if="h.total > 0"> -->
                                                                <td style="font-size:15px;" align="left">
                                                                    <span t-esc="h.salary_rule_id.name"/>
                                                                </td>
                                                                <td style="font-size:15px;" align="right">
                                                                    <span t-esc="h.total" t-options='{"widget": "float", "precision": decimal_precision}'/>
                                                                </td>
                                                                <!-- </t> -->
                                                                <!-- <td style="font-size:15px;" align="right">
                                                                    <span t-esc="data[2]"/>
                                                                </td> -->
                                                            </tr>
                                                        <!-- </t> -->
                                                        </t>
                                                        </t>
                                                    </tbody>
                                                    
                                                </table>
                                            </td>
                                               
                                            <td style="font-size:15px;" align="center"><strong>Deductions</strong>
                                                <table class="table table-bordered">
                                                    <tr class="thead-bg-color">
                                                        <td style="font-size:15px;" align="left"><strong>Name</strong></td>
                                                        <td style="font-size:15px;" align="right"><strong>Current Period</strong></td>
                                                        <!-- <td style="font-size:15px;" align="right"><strong>Year To Date</strong></td> -->
                                                    </tr>
                                                    <tbody>
                                                        <t t-foreach="o.line_ids.sorted(key=lambda x: x.sequence)" t-as="h">

                                                        <!-- <t t-foreach='data' t-as="hy"> -->
                                                        <t t-if="h.salary_rule_id.appears_on_payslip == True and h.salary_rule_id.appear_in_allowance == false">
                                                            <!-- <t t-set='data' t-value="o.tod_calculate()"/> -->
                                                            <t t-if="h.code != 'LO'">
                                                                <tr>
                                                                    <!-- <t t-if="h.total > 0"> -->
                                                                    <td style="font-size:15px;" align="left">
                                                                        <span t-esc="h.salary_rule_id.name"/>
                                                                    </td>
                                                                    <td style="font-size:15px;" align="right">
                                                                        
                                                                        <span t-esc="h.total" t-options='{"widget": "float", "precision": decimal_precision}'/>
                                                                    </td>
                                                                    <!-- </t> -->
                                                                    <!-- <td style="font-size:15px;" align="right">
                                                                        <span t-esc="data[2]"/>
                                                                    </td> -->
                                                                </tr>
                                                            </t>
                                                            <t t-else="">
                                                                <tr>
                                                                    <td style="font-size:15px;" align="left">
                                                                        <span t-esc="o.loan_label"/>
                                                                    </td>
                                                                    <td style="font-size:15px;" align="right">
                                                                        
                                                                        <span t-esc="h.total" t-options='{"widget": "float", "precision": decimal_precision}'/>
                                                                    </td>
                                                                </tr>
                                                            </t>
                                                        <!-- </t> -->
                                                        </t>
                                                        </t>
                                                    </tbody>
                                                </table>
                                            
                                            </td>
                                            </tr>
                                        
                                        <!-- <tr  style="background-color:E3EEF7;">
                                            <td style="font-size:14px;" align="center" colspan="2">
                                                <b>Year To Date : </b>
                                                <table class="table table-condensed" style="width:1000px;">
                                                    <tr  style="background-color:E3EEF7;">
                                                        <td style="font-size:15px;" align="center"><strong>Name</strong></td>
                                                        <td style="font-size:15px;" align="center"><strong>Amount</strong></td>
                                                    </tr>
                                                    <tbody>
                                                        <t t-set='data' t-value="o.tod_calculate()"/>
                                                        <t t-foreach='data' t-as="h">
                                                            <tr>
                                                            
                                                                <td style="font-size:15px;" align="left">
                                                                    <span t-esc="h[2]"/>
                                                                </td>
                                                            
                                                                <td style="font-size:15px;" align="right">
                                                                    <span t-esc="h[3]"/>
                                                                </td>
                                                            </tr>
                                                        </t>
                                                        </t>
                                                    </tbody>
                                                </table>
                                            </td>

                                        </tr> -->
                                        <tr class="custom-bg-color">
                                            <t t-foreach="o.line_ids" t-as="h">
                                                <t t-if="h.code == 'GROSS'">
                                                    <td style="font-size:14px;"
                                                        align="left">
                                                        <b>Total Earnings: </b>
                                                        <b><span t-esc="h.total" t-options='{"widget": "float", "precision": decimal_precision}'/>
                                                            
                                                        </b>
                                                        
                                                    </td>
                                                </t>
                                            </t>
                                            <td style="font-size:14px;"
                                                align="left">
                                                <b>Total Deductions: </b>
                                                <b><span t-esc="sum(o.line_ids.filtered(lambda x: x.category_id.code == 'DED').mapped('total'))" t-options='{"widget": "float", "precision": decimal_precision}'/> 
                                                </b>
                                                
                                            </td>
                                        </tr>
                                        <tr class="custom-bg-color">
                                            <td style="font-size:14px;" colspan="3"
                                                align="left">
                                                <b>Total Net Pay: Rs.</b>
                                                <b><span t-esc="o.compute_net_pay()"/> 
                                                <span t-esc="o.amount_total_words" />
                                                    
                                                </b>
                                                
                                            </td>
                                        </tr>
                                        <tr>
                                            <td style="font-size:14px;" colspan="3"
                                                align="left">
                                                This is a computer generated record and doesn't need signature
                                            </td>
                                        </tr>
                                    </table>
                                
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
            </t>
        </t>
        
    </template>

    <!-- Payment Advices Template Changes -->
    <template id="payroll_advice_inherit" inherit_id="l10n_in_hr_payroll.report_payrolladvice">
        <xpath expr="//div[@class='page']/table[1]/tr[4]" position="after">
            <tr>
                <td>
                    <strong><span t-esc="o.bank_id.street"/>,</strong>
                    <strong><span t-esc="o.bank_id.street2"/><br/></strong>
                    <strong><span t-esc="o.bank_id.city"/>,</strong>
                    <strong><span t-esc="o.bank_id.state.name"/></strong>
                    <strong><span t-esc="o.bank_id.country.name"/><br/></strong>
                    <strong><span t-esc="o.bank_id.zip"/><br/><br/></strong>
                </td>
            </tr>
        </xpath>

        <xpath expr="//div[@class='page']/table[1]/tr[7]/td/p" position="replace">
            <strong>
                You are requested to transfer the amount of 
                <span t-esc="sum(o.line_ids.filtered(lambda x: x.employee_id.bank_account_id.bank_id.name.lower().strip() == 'bank of india').mapped('bysal'))" t-options="{'widget': 'monetary', 'display_currency': o.company_id.currency_id}"/>
                Through Bank Transfer as per details from our SB A/C No. <span t-esc="o.company_id.partner_id.bank_ids and o.company_id.partner_id.bank_ids[0].acc_number"/>
            </strong>
        </xpath>

        <xpath expr="//div[@class='page']/table[1]/tr[5]" position="after">
            <tr> 
                <td> 
                    <strong>Subject : Transfer of Funds</strong>
                </td>
            </tr> <br/>
        </xpath>

        <xpath expr="//div[@class='page']/table[1]/tr[8]" position="after">
            <tr>
                <td>
                    <strong>Cheque No.</strong> <span t-field="o.chaque_nos"/>
                </td>
            </tr>
            <tr>
                <td>
                    <strong>Cheque Date</strong> <span t-field="o.cheque_date"/>
                </td>
            </tr>
        </xpath>

        <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[2]" position="after">
            <th>Bank Name</th>
        </xpath>
        <!-- <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[4]" position="after">
            <th>IFSC Code</th>
        </xpath> -->
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[6]" position="replace">
        </xpath>
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[5]" position="after">
            <th>Amount</th>
        </xpath>
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[4]" position="replace">
            <th>Account No.</th>
        </xpath>
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[7]" position="replace">
        </xpath>
        <!-- <xpath expr="//div[@class='page']/table[@class='table table-sm']/thead/tr/th[8]" position="replace">
        </xpath> -->
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/tbody/tr/td[2]" position="after">
            <td>
                <span t-esc="l['bank_name']"/>
            </td>
        </xpath>
        <!-- <xpath expr="//div[@class='page']/table[@class='table table-sm']/tbody/tr/td[4]" position="after">
            <td>
                <span t-esc="l['ifsc_code']"/>
            </td>
        </xpath> -->
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/tbody/tr/td[7]" position="replace">
        </xpath>
        <xpath expr="//div[@class='page']/table[@class='table table-sm']/tbody/tr[2]/td[1]" position="replace">
            <td colspan="3"/>
        </xpath>
        <xpath expr="//div[@class='page']/table[@class='table table-sm']" position="after">
            <br/><p><strong>Please send us the Confirmation/Advice/UTR No. for our records.</strong></p><br/>
        </xpath>


    </template>

    <template id="report_non_boi_payrolladvice">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t t-foreach="docs" t-as="o">
                    <div class="page">
                        <table>
                            <tr>
                                <td><p><span t-esc="time.strftime('%m-%d-%Y')"/></p></td>
                            </tr>
                            <tr>
                                <td><strong><span>To,</span></strong></td>
                            </tr>
                            <tr>
                                <td><strong><span>The Manager,</span></strong></td>
                            </tr>
                            <tr>
                                <td><strong><span t-esc="o.bank_id.name" />Bank</strong></td>
                            </tr>
                            <tr>
                                <td>
                                    <strong><span t-esc="o.bank_id.street"/>,</strong>
                                    <strong><span t-esc="o.bank_id.street2"/><br/></strong>
                                    <strong><span t-esc="o.bank_id.city"/>,</strong>
                                    <strong><span t-esc="o.bank_id.state.name"/></strong>
                                    <strong><span t-esc="o.bank_id.country.name"/><br/></strong>
                                    <strong><span t-esc="o.bank_id.zip"/><br/><br/></strong>
                                </td>
                            </tr>
                            <tr> 
                                <td> 
                                    <strong>Subject : Transfer of Funds</strong>
                                </td>
                            </tr> <br/>
                            <tr>
                                <td><p><span>Dear Sir/Madam,</span></p></td>
                            </tr>
                            <tr>
                                <td>
                                    <p class="text-center">
                                        <strong>
                                            You are requested to transfer the amount of 
                                            <span t-esc="get_bysal_total(o.line_ids)" t-options="{'widget': 'monetary', 'display_currency': o.company_id.currency_id}"/>
                                            Through Bank Transfer as per details from our SB A/C No. <span t-esc="o.company_id.partner_id.bank_ids and o.company_id.partner_id.bank_ids[0].acc_number"/>
                                        </strong>
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><p><span t-esc="o.note" /></p></td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Cheque No.</strong> <span t-field="o.chaque_nos"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <strong>Cheque Date</strong> <span t-field="o.cheque_date"/>
                                </td>
                            </tr>
                        </table>

                        <table class="table table-sm">
                            <thead>
                                <tr style="border-top: 1px solid black">
                                    <th>SI No.</th>
                                    <th>Name Of Employee</th>
                                    <th>Bank Name</th>
                                    <th>Account No.</th>
                                    <th>IFSC Code</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="get_detail(o.line_ids)" t-as="l">
                                    <td>
                                        <span t-esc="l_index+1">.</span>
                                    </td> 
                                    <td>
                                        <span t-esc="l['name']"/>
                                    </td>
                                    <td>
                                        <span t-esc="l['bank_name']"/>
                                    </td>
                                    <td>
                                        <span t-esc="l['acc_no']"/>
                                    </td>
                                    <td>
                                        <span t-esc="l['ifsc_code']"/>
                                    </td>
                                    <td>
                                        <span t-esc="l['bysal']" t-options="{'widget': 'monetary', 'display_currency': o.company_id.currency_id}"/>
                                    </td>
                                </tr>
                                <tr class="border-black" style="border-bottom: 1px solid black">
                                    <td colspan="2"/>
                                    <td colspan="3">
                                        <strong >Total :</strong>
                                    </td>
                                    <td colspan="1">
                                        <strong><span t-esc="get_bysal_total(o.line_ids)" t-options="{'widget': 'monetary', 'display_currency': o.company_id.currency_id}"/></strong>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <br/><p><strong>Please send us the Confirmation/Advice/UTR No. for our records.</strong></p><br/>
                        <p>Yours Sincerely</p>
                        <p>For <span t-esc="o.company_id.name"/></p>
                        <p class="mt32">Authorized Signature</p>
                    </div>
                </t>
            </t>
        </t>
    </template>

</odoo>
