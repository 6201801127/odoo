<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_folder_master_shelf_tree" model="ir.ui.view">
        <field name="name">folder.master.shelf.tree</field>
        <field name="model">folder.master</field>
        <field name="arch" type="xml">
            <tree string="Shelf">
                <field name="same_department" invisible="1" />
                <field name="is_on_shelf" invisible="1"  />
                <field name="version" invisible="1"/>
                <field name="folder_name"/>
                <field name="number"/>
                <field name="subject"/>
                <field name="current_owner_id" string="File put in Shelf By" invisible="not context.get('shelf_mode')"/>
                <field name="action_date" string="File put in Shelf On" invisible="not context.get('shelf_mode')"/>
                
                <field name="incoming_source" invisible="not context.get('subordinate_shelf_mode')"/>
                <field name="action_by_uid" invisible="not context.get('subordinate_shelf_mode')"/>
                <field name="action_date" invisible="not context.get('subordinate_shelf_mode')"/>

                <field name="current_owner_id" string="Subordinate Name" invisible="not context.get('subordinate_shelf_mode')"/>
                <field name="put_in_own_shelf_date" invisible="not context.get('subordinate_shelf_mode')"/>
                <!-- <field name="date"/>
                <field name="department_id"/> -->
                <field name="state" invisible="1"/> 
                <button string="Pull into My Inbox" name="%(action_pull_file_from_shelf_window)d" type="action" class="oe_highlight" 
                        attrs="{'invisible':['|','|',('same_department','=',False),('is_on_shelf','=',False),('state','!=', 'shelf')]}"
                        invisible="not context.get('shelf_mode')"/>
            </tree>
        </field>
    </record>

    <record id="view_folder_master_own_shelf_tree" model="ir.ui.view">
        <field name="name">folder.master.own.shelf.tree</field>
        <field name="model">folder.master</field>
        <field name="arch" type="xml">
            <tree string="Own Shelf">
                <!-- <field name="same_department" invisible="1" /> -->
                <field name="is_on_shelf" invisible="1"  />
                <field name="file_mode" invisible="1"  />
                <field name="is_current_owner" invisible="1"  />
                <field name="folder_name"/>
                <field name="number"/>
                <field name="subject"/>
                <field name="incoming_source"/>
                <field name="action_by_uid"/>
                <field name="action_date"/>
                <field name="put_in_own_shelf_date"/>
                <field name="state" invisible="1"/> 
                <button string="Pull into My Inbox" name="%(action_pull_into_files_my_action_confirm)d" type="action" class="oe_highlight" 
                        attrs="{'invisible':['|','|',('state','!=', 'in_progress'),('is_current_owner','=',False),('file_mode','!=','own_shelf')]}"
                        invisible="not context.get('shelf_mode')"/>
            </tree>
        </field>
    </record>

    <record id="action_folder_master_departmental_shelf" model="ir.actions.act_window">
        <field name="name">Departmental Shelf</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">folder.master</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_folder_master_shelf_tree"/>
        <field name="domain">[]</field>
        <field name="context">{'create':False,'edit':False,'delete':False,'filter_shelf_department':1, 'shelf_mode': True}</field>
    </record>
    <record id="action_folder_master_own_shelf" model="ir.actions.act_window">
        <field name="name">My Shelf</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">folder.master</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree</field>
        <field name="view_id" eval="False"/>
        <field name="view_ids" eval="[(5, 0, 0), 
                (0, 0, {'view_mode': 'tree', 'view_id': ref('view_folder_master_own_shelf_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('foldermaster_form_view')})]"/>
        <field name="domain">[('file_mode','=','own_shelf'),('current_owner_id','=',uid)]</field>
        <field name="context">{'create':False,'edit':False,'delete':False,'shelf_mode': True}</field>
    </record>
    <record id="action_folder_master_subordinates_shelf" model="ir.actions.act_window">
        <field name="name">Subordinates Shelf</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">folder.master</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree</field>
        <field name="view_id" ref="view_folder_master_shelf_tree"/>
        <field name="domain">[('file_mode','=','own_shelf'),('current_owner_id','!=',uid)]</field>
        <field name="context">{'create':False,'edit':False,'delete':False,'filter_subordinates':1, 'subordinate_shelf_mode': True}</field>
    </record>

    <menuitem id="menu_folder_master_shelf" parent="menuitem_files_fol" name="Shelf" sequence="4"/>

    <menuitem id="menu_folder_master_departmental_shelf" parent="menu_folder_master_shelf" action="action_folder_master_departmental_shelf" name="Departmental Shelf" sequence="3"/>
    <menuitem id="menu_folder_master_own_shelf" parent="menu_folder_master_shelf" action="action_folder_master_own_shelf" name="My Shelf" sequence="1"/>
    <menuitem id="menu_folder_master_subordinates_shelf" parent="menu_folder_master_shelf" action="action_folder_master_subordinates_shelf" name="Subordinates Shelf" sequence="2"/>

</odoo>
