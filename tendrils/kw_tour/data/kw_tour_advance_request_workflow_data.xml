<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">

        <record id="kw_tour_advance_request_approval_workflow" model="odoo.workflow">
            <field name="name">Tour Advance Request Approval</field>
            <field name="activities_add" eval="True"/>
            <field name="followers_add" eval="False"/>
            <field name="mail_thread_add" eval="True"/>
            <field name="remove_default_attrs_mod" eval="False"/>
            <field name="model_id" ref="kw_tour.model_kw_tour_advance_request"/>
        </record>


        <record id="kw_tour_advance_request_workflow_node_applied" model="odoo.workflow.node">
            <field name="name">Applied</field>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="node_name">Applied</field>
            <field name="sequence" eval="1"/>
            <field name="is_visible" eval="True"/>
            <field name="flow_start" eval="True"/>
        </record>

        <record id="kw_tour_advance_request_workflow_node_approved" model="odoo.workflow.node">
            <field name="name">Approved</field>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="node_name">Approved</field>
            <field name="sequence" eval="2"/>
            <field name="is_visible" eval="True"/>
            <field name="flow_end" eval="False"/>
        </record>

        <record id="kw_tour_advance_request_workflow_node_grant" model="odoo.workflow.node">
            <field name="name">Grant</field>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="node_name">Grant</field>
            <field name="sequence" eval="3"/>
            <field name="is_visible" eval="True"/>
            <field name="flow_end" eval="False"/>
        </record>

        <record id="kw_tour_advance_request_workflow_node_rejected" model="odoo.workflow.node">
            <field name="name">Rejected</field>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="node_name">Rejected</field>
            <field name="sequence" eval="4"/>
            <field name="is_visible" eval="True"/>
            <field name="flow_end" eval="True"/>
        </record>


        <record id="kw_tour_advance_request_workflow_button_approve" model="odoo.workflow.node.button">
            <field name="sequence" eval="1"/>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="name">Approve</field>
            <field name="node_id" ref="kw_tour_advance_request_workflow_node_applied"/>
            <field name="is_highlight" eval="True"/>
            <field name="custom_domain" eval="True"/>
            <field name="btn_hide_domain" eval="['|',('state', '!=', 'Applied'),('ra_access','=',False)]"/>
            <field name="btn_class">btn-success</field>
            <field name="condition_code">
result = True
            </field>
            <field name="action_type">code</field>
            <field name="code">
form_view_id = env.ref("kw_tour.view_kw_tour_advance_request_approve_remark_form").id 
action= {
    'name':'Remarks',
    'type': 'ir.actions.act_window',
    'res_model': 'kw_tour_advance_request',
    'view_mode': 'form',
    'view_type': 'form',
    'res_id': obj.id,
    'view_id': form_view_id,
    'target': 'new',
    'nodestroy': True,
}
            </field>
        </record>

        <record id="kw_tour_advance_request_workflow_button_reject" model="odoo.workflow.node.button">
            <field name="sequence" eval="2"/>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="name">Reject</field>
            <field name="node_id" ref="kw_tour_advance_request_workflow_node_applied"/>
            <field name="is_highlight" eval="True"/>
            <field name="custom_domain" eval="True"/>
            <field name="btn_hide_domain" eval="['|',('state', '!=', 'Applied'),('ra_access','=',False)]"/>
            <field name="btn_class">btn-danger</field>
            <field name="condition_code">
result = True
            </field>
            <field name="action_type">code</field>
            <field name="code">
form_view_id = env.ref("kw_tour.view_kw_tour_advance_request_reject_remark_form").id 
action= {
    'name':'Remarks',
    'type': 'ir.actions.act_window',
    'res_model': 'kw_tour_advance_request',
    'view_mode': 'form',
    'view_type': 'form',
    'res_id': obj.id,
    'view_id': form_view_id,
    'target': 'new',
    'nodestroy': True,
}

            </field>
        </record>

        <record id="kw_tour_advance_request_workflow_button_grant" model="odoo.workflow.node.button">
            <field name="sequence" eval="1"/>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="name">Grant</field>
            <field name="node_id" ref="kw_tour_advance_request_workflow_node_approved"/>
            <field name="is_highlight" eval="True"/>
            <field name="custom_domain" eval="True"/>
            <field name="btn_hide_domain" eval="[('state', '!=', 'Approved')]"/>
            <field name="btn_class">btn-success</field>
            <field name="condition_code">
result = True
            </field>
            <field name="action_type">code</field>
            <field name="code">
if obj.can_apply_inr and obj.request_inr and not obj.to_be_given_inr:
    warning("Please add amount to be disbursed(INR)")

if obj.can_apply_usd and obj.request_usd and not obj.to_be_given_usd:
    warning("Please add amount to be disbursed(USD)")

form_view_id = env.ref("kw_tour.view_kw_tour_advance_request_grant_remark_form").id 
action= {
    'name':'Remarks',
    'type': 'ir.actions.act_window',
    'res_model': 'kw_tour_advance_request',
    'view_mode': 'form',
    'view_type': 'form',
    'res_id': obj.id,
    'view_id': form_view_id,
    'target': 'new',
    'nodestroy': True,
}
            </field>
        </record>

        <record id="kw_tour_advance_request_workflow_button_grant_reject" model="odoo.workflow.node.button">
            <field name="sequence" eval="2"/>
            <field name="workflow_id" ref="kw_tour_advance_request_approval_workflow"/>
            <field name="name">Reject</field>
            <field name="node_id" ref="kw_tour_advance_request_workflow_node_approved"/>
            <field name="is_highlight" eval="True"/>
            <field name="custom_domain" eval="True"/>
            <field name="btn_hide_domain" eval="[('state', '!=', 'Approved')]"/>
            <field name="btn_class">btn-danger</field>
            <field name="condition_code">
result = True
            </field>
            <field name="action_type">code</field>
            <field name="code">
form_view_id = env.ref("kw_tour.view_kw_tour_advance_request_reject_remark_form").id 
action= {
    'name':'Remarks',
    'type': 'ir.actions.act_window',
    'res_model': 'kw_tour_advance_request',
    'view_mode': 'form',
    'view_type': 'form',
    'res_id': obj.id,
    'view_id': form_view_id,
    'target': 'new',
    'nodestroy': True,
}

            </field>
        </record>
    </data>
</odoo>