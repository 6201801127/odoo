<?xml version="1.0" encoding="UTF-8"?>
<odoo>
       
        <record id="view_dms_versioning_file_form" model="ir.ui.view">
            <field name="name">kw_dms_file.form</field>
            <field name="model">kw_dms.file</field>
            <field name="inherit_id" ref="kw_dms.view_dms_file_form" />
            <field name="arch" type="xml">

                <xpath expr="//header" position="inside">       

                    <!-- attrs="{'invisible':['|',('permission_write', '=', False),('permission_create', '=', False)]}"  -->

                    <button class="oe_highlight" groups="kw_dms.group_dms_manager"  attrs="{'invisible':['|',('version_enabled', '=', False),'|','|',('permission_write', '=', False),('permission_create', '=', False),'|','&amp;',('next_version_id', '!=',False),('latest_version_id', '!=',False),'&amp;',('next_version_id', '=',False),('latest_version_id', '=',False)]}"   name="action_create_new_version" type="object" string="Create New Version"   />

                    <field name="permission_create" invisible="1" />

                </xpath>

                <!-- <xpath expr="//div[@name='button_box']" position="inside">
                      
                    <button name="action_show_download_log" type="object"   class="oe_stat_button" icon="fa-download">
                    	<field name="download_count" readonly="1" string="Downloads" widget="statinfo"/>  
                    </button>

                </xpath> -->

                <xpath expr="//label[@for='name']" position="replace">
                   <label for="document_name" class="oe_edit_only" />
                </xpath>
                
                <xpath expr="//field[@name='name']" position="replace">
                    <!-- <field name="name" invisible="1" nolabel="1"  /> -->
                    <field name="document_name" string="Document Name"
                    required="1"
                     />
                </xpath>

                <xpath expr="//group[@name='content']" position="before">
                    <group>
                        <group >
                            <field name="name" invisible="1" />
                            <field name="version"  attrs="{'invisible':[('version_enabled', '=', False)]}" />
                            <field name="version_enabled" invisible="1" />
                        </group>
                        <group >
                            <field name="description"  />

                             
                        </group>

					</group>
                </xpath>

                 <xpath expr="//page[@name='page_technical']" position="after">

                    <page name="page_versioning" string="Versioning Info" groups="kw_dms.group_dms_manager" attrs="{'invisible':[('version_enabled', '=', False)]}" >
						<group>
							
                                 <field name="prev_version_id" readonly="1" invisible="1" />   
                                 <field name="next_version_id" readonly="1" invisible="1"/>   
                                 <field name="latest_version_id" 
                                 readonly="1" />  

                                 <field name="file_versions_ids" string="All Versions"> 
                                    <tree default_order='version desc'> 
                                        <field name="document_name"/>
                                        <field name="version"/>
                                        <field name="create_date" /> 
                                        <field name="create_uid" string="Author" />
                                        <field name="write_date" />
                                        <field name="name" /> 

                                        <!-- <field name="download_count"  /> -->
                                        
                                        <button name="action_download_file" string="Download" type="object" icon="fa-download" /> 
                                        <!-- <button name="action_show_download_log" type="object"   class="oe_stat_button" icon="fa-eye" /> -->
                                         
                                        <!--<field name="value" eval="'ir.actions.act_window,%d'%action_id"/>
                                             <field name="path_names" widget="path_names" string="Path" /> -->
                                    </tree>  
                                </field>
							
                        
						</group>
					</page>
                </xpath>


            </field>
        </record>


    <record id="view_dms_versioning_file_kanban" model="ir.ui.view">
            <field name="name">kw_dms_versioning_file.kanban</field>
            <field name="model">kw_dms.file</field>
            <field name="inherit_id" ref="kw_dms.view_dms_file_kanban" />
            <field name="arch" type="xml">
              
                <xpath expr="//kanban/templates/t/div/div[2]/div[2]/div/div[1]" position="replace">
               <!--  o_text_overflow -->
                    <div class="o_kanban_record_title ">   
                        <field name="document_name"  />                      
                    </div>
                </xpath>

                <xpath expr="//kanban/templates/t/div/div[2]/div[2]/div/div[2]" position="after">
                   <div class="o_kanban_record_body">
                      <small>Version : <b><field name="version"  /></b> </small> 
                      <!-- <small>Downloads : <b>
                      <button name="action_show_download_log" type="object" class="oe_stat_button" icon="fa-eye" ><field name="download_count"  /></button></b> 
                      </small>  -->
                    </div>
                </xpath>            

            </field>
    </record>


    <record id="view_dms_versioning_file_tree" model="ir.ui.view">
            <field name="name">kw_dms_versioning_file.tree</field>
            <field name="model">kw_dms.file</field>
            <field name="inherit_id" ref="kw_dms.view_dms_file_tree" />
            <field name="arch" type="xml">
                <xpath expr="//field[@name='name']" position="replace">
                  
                        <field name="document_name"  />
                        <field name="version"  />
                      
                </xpath>                  

             </field>
    </record>


    <!-- <record id="search_dms_versioning_file" model="ir.ui.view">
            <field name="name">kw_dms_versioning_file.search</field>
            <field name="model">kw_dms.file</field>
            <field name="inherit_id" ref="kw_dms.search_dms_file" />
            <field name="arch" type="xml">
                <xpath expr="filter[@name='all']" position="before">
                     <filter string="Latest Version Files" name="latest_version_files" domain="[('next_version_id', '=',False)]" />
                </xpath>               

             </field>
    </record> -->


    <record id="kw_dms.action_dms_file" model="ir.actions.act_window">
        <field name="name">Files</field>
        <field name="res_model">kw_dms.file</field>
        <field name="view_mode">kanban,tree,graph,pivot,form</field>
        <field name="domain">[("is_hidden", "=",  False),("next_version_id", "=",  False)]</field>
        <!-- <field name="context">{'search_default_latest_version_files':1}</field> -->
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Add a new File.
            </p>
            <p>
                Files are used to save content directly in Odoo.
            </p>
        </field>
    </record>


</odoo>
