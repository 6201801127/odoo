<?xml version="1.0" encoding="utf-8"?>
<odoo>   

    <data noupdate='0'>
        <record id="group_hr_attendance_roaster" model="res.groups">
            <field name="name">Roster Manager</field>
            <field name="category_id" ref="base.module_category_hr_attendance"/>
            <field name="implied_ids" eval="[(4, ref('hr_attendance.group_hr_attendance'))]"/>
        </record>

        <record id="hr_attendance.group_hr_attendance_manager" model="res.groups">
            <field name="implied_ids" eval="[(4, ref('kw_hr_attendance.group_hr_attendance_roaster'))]"/>
        </record>

        <record id="base.default_user" model="res.users">
            <field name="groups_id" eval="[(4, ref('hr_attendance.group_hr_attendance'))]"/>
        </record>

        <record id="group_hr_attendance" model="res.groups">
            <field name="name">User</field>
        </record>

        <record id="group_kw_hr_attendance_report_manager" model="res.groups">
            <field name="name">Report Manager</field>
            <field name="category_id" ref="base.module_category_hr_attendance"/>
        </record>
        <!-- <record id="model_hr_attendance_manager_rule" model="ir.rule">
            <field name="name">Manager : View all attendances</field>
            <field name="model_id" ref="hr_attendance.model_hr_attendance"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager'))]"/>
            <field name="perm_read" eval="True" />
            <field name="perm_create" eval="True" />
            <field name="perm_write" eval="True" />
            <field name="perm_unlink" eval="True" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="active" eval="True" />
        </record>

        <record id="model_hr_attendance_base_user_rule" model="ir.rule">
            <field name="name">Base User : View own and subordinates attendances.</field>
            <field name="model_id" ref="hr_attendance.model_hr_attendance"/>
            <field name="groups" eval="[(4, ref('base.group_user'))]"/>
            <field name="perm_read" eval="True" />
            <field name="perm_create" eval="False" />
            <field name="perm_write" eval="False" />
            <field name="perm_unlink" eval="False" />
            <field name="domain_force">['|',('employee_id','in',user.employee_ids.ids),('employee_id', 'in', user.employee_ids.child_ids.ids)]</field>
            <field name="active" eval="True" />
        </record> -->

        <record id="model_kw_roaster_group_config_manager_rule" model="ir.rule">
            <field name="name">Manager : View all roaster groups</field>
            <field name="model_id" ref="model_kw_roaster_group_config"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager'))]"/>
            <field name="perm_read" eval="True" />
            <field name="perm_create" eval="True" />
            <field name="perm_write" eval="True" />
            <field name="perm_unlink" eval="True" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="active" eval="True" />
        </record>

        <record id="model_kw_employee_roaster_shift_manager_rule" model="ir.rule">
            <field name="name">Manager : View all roaster shifts</field>
            <field name="model_id" ref="model_kw_employee_roaster_shift"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager'))]"/>
            <field name="perm_read" eval="True" />
            <field name="perm_create" eval="True" />
            <field name="perm_write" eval="True" />
            <field name="perm_unlink" eval="True" />
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="active" eval="True" />
        </record>

        <record id="model_kw_roaster_group_config_roaster_rule" model="ir.rule">
            <field name="name">Roaster : View own groups</field>
            <field name="model_id" ref="model_kw_roaster_group_config"/>
            <field name="groups" eval="[(4, ref('group_hr_attendance_roaster'))]"/>
            <field name="perm_read" eval="True" />
            <field name="perm_create" eval="False" />
            <field name="perm_write" eval="True" />
            <field name="perm_unlink" eval="False" />
            <field name="domain_force">[('group_head_id', 'in', user.employee_ids.ids)]</field>
            <field name="active" eval="True" />
        </record>

        <record id="model_kw_employee_roaster_shift_roaster_rule" model="ir.rule">
            <field name="name">Roaster : View shifts in which employees belongs to his group.</field>
            <field name="model_id" ref="model_kw_employee_roaster_shift"/>
            <field name="groups" eval="[(4, ref('group_hr_attendance_roaster'))]"/>
            <field name="perm_read" eval="True" />
            <field name="perm_create" eval="False" />
            <field name="perm_write" eval="True" />
            <field name="perm_unlink" eval="False" />
            <field name="domain_force">[('employee_id', 'in', user.employee_ids.roaster_group_ids.group_member_ids.ids)]</field>
            <field name="active" eval="True" />
        </record>   
    

        <!-- START :: Employee Attendance Requests  -->

            <record id="kw_employee_apply_attendance_rule_manager" model="ir.rule">
                <field name="name">Employee Attendance Request: manager: no limit</field>
                <field name="model_id" ref="model_kw_employee_apply_attendance"/>
                <field name="domain_force">[(1, '=', 1)]</field>
                <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager'))]"/>
            </record>

            <record id="kw_employee_apply_attendance_rule_employee" model="ir.rule">
                <field name="name">Employee Attendance Request: employee: read own/sub-ordinates</field>
                <field name="model_id" ref="model_kw_employee_apply_attendance"/>
                <field name="domain_force">['|',('employee_id.user_id','=',user.id),('employee_id.parent_id.user_id', '=', user.id)]</field> 
                <field name="perm_read" eval="True"/>           
                <field name="perm_create" eval="True"/>
                <field name="perm_write" eval="True"/>
                <field name="perm_unlink" eval="False"/> 
                <field name="groups" eval="[(4,ref('base.group_user'))]"/>
            </record>

           <!--  <record id="kw_employee_apply_attendance_rule_employee_update" model="ir.rule">
                <field name="name">Employee Attendance Request: employee: create/write/unlink own/sub-ordinates</field>
                <field name="model_id" ref="model_kw_employee_apply_attendance"/>
                <field name="domain_force">['&amp;',('state', 'in', ['1','2']),'|',('employee_id.user_id','=',user.id),('employee_id.parent_id.user_id', '=', user.id)]</field>
                <field name="perm_read" eval="False"/>
                <field name="perm_unlink" eval="False"/>
                <field name="groups" eval="[(4,ref('base.group_user'))]"/>
            </record> -->

            <record id="kw_employee_apply_attendance_rule_employee_update" model="ir.rule">
                <field name="name">Employee Attendance Request: employee: create/write/unlink not validated own</field>
                <field name="model_id" ref="model_kw_employee_apply_attendance"/>
                <field name="domain_force">[('employee_id.user_id','=',user.id),('state', 'in', ['6','5'])]</field>               
                <field name="perm_write" eval="False"/>
                <field name="perm_unlink" eval="False"/> 
                <field name="groups" eval="[(4,ref('base.group_user'))]"/>
            </record>                 

            <record id="kw_employee_apply_attendance_rule_manager_update" model="ir.rule">
                <field name="name">Employee Attendance Request: manager: read/create/write/unlink not validated own</field>
                <field name="model_id" ref="model_kw_employee_apply_attendance"/>
                <field name="domain_force">[('state', 'in', ['3'])]</field>
                <field name="perm_read" eval="True"/>
                <field name="perm_create" eval="True"/>
                <field name="perm_write" eval="True"/>
                <field name="perm_unlink" eval="True"/>
                <field name="groups" eval="[(4,ref('hr_attendance.group_hr_attendance_manager'))]"/>
            </record>
        <!-- END ::  Employee Atendance Requests    -->

        
        <record id="hr_attendance_rule_attendance_manager" model="ir.rule">
            <field name="name">attendance officer: full access</field>
            <field name="model_id" ref="model_hr_attendance"/>
            <field name="domain_force">[(1,'=',1)]</field>
            <field name="groups" eval="[(4,ref('hr_attendance.group_hr_attendance_manager'))]"/>
        </record>

        <record id="hr_attendance_rule_attendance_employee" model="ir.rule">
            <field name="name">user: modify own attendance only</field>
            <field name="model_id" ref="model_hr_attendance"/>
            <field name="domain_force">['|',('employee_id.user_id','=',user.id),('employee_id.parent_id.user_id', '=', user.id)]</field>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_create" eval="1"/>
            <field name="perm_unlink" eval="0"/>
            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>
        <!-- END :: Attendance Log Report -->

        <!-- START :: Attendance Summary Report -->
        <record id="kw_employee_attendance_summary_report_manager_rule" model="ir.rule">
            <field name="name">Manager : View all attendance summary report</field>
            <field name="model_id" ref="model_kw_employee_attendance_summary_report"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager')),(4, ref('kw_hr_attendance.group_kw_hr_attendance_report_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="active" eval="True" />
        </record>

        <record id="kw_employee_attendance_summary_report_rule_employee" model="ir.rule">
            <field name="name">Attendance Summary Report: employee: read own/sub-ordinates</field>
            <field name="model_id" ref="model_kw_employee_attendance_summary_report"/>
            <field name="domain_force">[('employee_id','child_of',user.employee_ids.ids)]</field> 
            <!-- domain_force modified to root subordinate hierarchy 25-Feb-2021 (Gouranga) -->
            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>
        <!-- END :: Attendance Summary Report -->

        <!-- START :: Daily Employee Attendance Summary Report -->
        <record id="model_kw_daily_employee_attendance_manager_rule" model="ir.rule">
            <field name="name">Manager : View all daily attendance summary report</field>
            <field name="model_id" ref="model_kw_daily_employee_attendance"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager')),(4, ref('kw_hr_attendance.group_kw_hr_attendance_report_manager'))]"/>            
            <field name="domain_force">[(1, '=', 1)]</field>
        </record>

        <record id="kw_daily_employee_attendance_rule_employee" model="ir.rule">
            <field name="name">Daily Attendance Summary Report: employee: read own/sub-ordinates/Forwarded</field>
            <field name="model_id" ref="model_kw_daily_employee_attendance"/>
            <field name="domain_force">['|',('employee_id','child_of',user.employee_ids.ids),
            '|',('le_forward_to.user_id','=',user.id),('le_approval_log_ids.forward_to.user_id','in',[user.id])]</field>            
            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>

        <record id="kw_daily_employee_attendance_rule_roster_manager" model="ir.rule">
            <field name="name">Daily Attendance Summary Report: roster manager: read/edit members attendance records</field>
            <field name="model_id" ref="model_kw_daily_employee_attendance"/>
            <field name="domain_force">[('employee_id', 'in', user.employee_ids.roaster_group_ids.group_member_ids.ids)]</field>
            <field name="perm_read" eval="1"/>
            <field name="perm_write" eval="1"/>
            <field name="perm_unlink" eval="0"/>           
            <field name="groups" eval="[(4,ref('kw_hr_attendance.group_hr_attendance_roaster'))]"/>
        </record>

        <!-- END :: Daily Employee Attendance Summary Report -->

        <!-- START :: Late Attendance Summary Report -->
        <record id="model_kw_late_attendance_summary_report_manager_rule" model="ir.rule">
            <field name="name">Manager : View all late attendance summary report</field>
            <field name="model_id" ref="model_kw_late_attendance_summary_report"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager')),(4, ref('kw_hr_attendance.group_kw_hr_attendance_report_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
        </record>

        <record id="kw_late_attendance_summary_report_rule_employee" model="ir.rule">
            <field name="name">Late Attendance Summary Report: employee: read own/sub-ordinates</field>
            <field name="model_id" ref="model_kw_late_attendance_summary_report"/>
            <field name="domain_force">[('employee_id','child_of',user.employee_ids.ids)]</field> 
            <!-- domain_force modified to root subordinate hierarchy 25-Feb-2021 (Gouranga) -->

            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>
        <!-- END :: Late Attendance Summary Report -->

        <!-- START :: Attendance Summary Pivot Report -->
        <record id="model_kw_attendance_summary_report_manager_rule" model="ir.rule">
            <field name="name">Manager : View all attendance summary report(pivot)</field>
            <field name="model_id" ref="model_kw_attendance_summary_report"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager'))]"/>            
            <field name="domain_force">[(1, '=', 1)]</field>
        </record>

        <record id="kw_attendance_summary_report_rule_employee" model="ir.rule">
            <field name="name">Attendance Summary Report: employee: read own/sub-ordinates(pivot)</field>
            <field name="model_id" ref="model_kw_attendance_summary_report"/>
            <field name="domain_force">['|',('employee_id.user_id','=',user.id),('employee_id.parent_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>
        <!-- END :: Late Attendance Summary Pivot Report -->

        <!-- START :: Productivity Hour Summary Report -->
        <record id="model_kw_productive_summary_report_manager_rule" model="ir.rule">
            <field name="name">Manager : View all productivity hour summary report</field>
            <field name="model_id" ref="model_kw_productive_summary_report"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager')),(4, ref('kw_hr_attendance.group_kw_hr_attendance_report_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
        </record>

        <record id="kw_productive_summary_report_rule_employee" model="ir.rule">
            <field name="name">Productivity Hour Summary Report: employee: read own/sub-ordinates</field>
            <field name="model_id" ref="model_kw_productive_summary_report"/>
            <field name="domain_force">[('employee_id','child_of',user.employee_ids.ids)]</field>
            <!-- domain_force modified to root subordinate hierarchy 25-Feb-2021 (Gouranga) -->
            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>
        <!-- END :: Productivity Hour Summary Report -->

        <!-- START :: Department Wise Attendance Summary Report -->
        <record id="model_kw_effort_estimation_report_manager_rule" model="ir.rule">
            <field name="name">Manager : View all employee effort estimation wise attendance summary report</field>
            <field name="model_id" ref="model_kw_effort_estimation_report"/>
            <field name="groups" eval="[(4, ref('hr_attendance.group_hr_attendance_manager'))]"/>
            <field name="domain_force">[(1, '=', 1)]</field>
        </record>

        <record id="kw_effort_estimation_report_rule_employee" model="ir.rule">
            <field name="name">Effort Estimation Report: employee: read own/sub-ordinates</field>
            <field name="model_id" ref="model_kw_effort_estimation_report"/>
            <field name="domain_force">['|',('employee_id.user_id','=',user.id),('employee_id.parent_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4,ref('base.group_user'))]"/>
        </record>
        <!-- END :: Department Wise Attendance Summary Report -->

        
     </data>
</odoo>
