<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <record id="kw_apply_attendance_request_email_template" model="mail.template">
            <field name="name">Apply Attendance Request Template</field>
            <field name="email_from">${object.company_id and object.company_id.email or ''}</field>
            <field name="subject">Update Attendance Request on ${format_tz(object.attendance_date, format="%d-%b-%Y")} | ${object.employee_id.name}</field>
            <!-- <field name="email_to">${object.employee_id.parent_id.work_email}</field> -->
           <field name="email_to">${(object.employee_id.parent_id.work_email if object.employee_id and object.employee_id.parent_id and object.employee_id.parent_id.parent_id else ''|safe)}</field>
            <field name="email_cc">${(object.employee_id.coach_id.work_email if object.employee_id and object.employee_id.coach_id and object.employee_id.coach_id.parent_id else ''|safe)}</field>
            <field name="model_id" ref="kw_hr_attendance.model_kw_employee_apply_attendance"/>
            <field name="auto_delete" eval="False"/>
            <field name="body_html">
                <![CDATA[
                    <table border="0">
                        <tr>
                            <td>
                                <div style="margin-left: 1.2rem;margin-bottom:1em;">
                                    <h5 style="font-weight: 400;margin-bottom: 0;font-size: 16px;color:#676767;">
                                        <span style="color:rgb(22, 123, 158);font-size: 16px;margin-right: 2px;font-weight: 600;">Dear</span>
                                        ${object.employee_id.parent_id.name},
                                    </h5>
                                    <p style="color: #676767;line-height: 145%;margin: 10px 0 0 0;font-size: 16px;">
                                        ${object.employee_id.name} has applied an attendance update request for ${format_tz(object.attendance_date, format="%d-%b-%Y")}.
                                    </p>
                                </div>
                               
                                <table border="0" style="border-collapse: collapse;font-size: 16px;">
                                    <tr>
                                        <td style="color:#676767;padding-left: 20px;height: 34px;" width="200px">
                                            Attendance Date
                                        </td>
                                        <td style="color:#167b9e;height: 34px;">
                                            ${format_tz(object.attendance_date, format="%d-%b-%Y")}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:#676767;padding-left: 20px;height: 34px;" width="200px">
                                            Office In
                                        </td>
                                        <td style="color:#167b9e;height: 34px;">
                                            ${format_tz(object.check_in_datetime, format="%d-%b-%Y %H:%M:%S")}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:#676767;padding-left: 20px;height: 34px;" width="200px">
                                            Office Out
                                        </td>
                                        <td style="color:#167b9e;height: 34px;">
                                            ${format_tz(object.check_out_datetime, format="%d-%b-%Y %H:%M:%S")}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:#676767;padding-left: 20px;height: 34px;" width="200px">
                                            Request For
                                        </td>
                                        <td style="color:#167b9e;height: 34px;">
                                            ${object.request_for}
                                        </td>
                                    </tr>
                                    <tr>
                                        <td style="color:#676767;padding-left: 20px;height: 34px;" width="200px">
                                            Reason
                                        </td>
                                        <td style="color:#167b9e;height: 34px;">
                                            ${object.reason}
                                        </td>
                                    </tr>
                                </table>
                                
                                %if object.employee_id.parent_id and object.employee_id.parent_id.department_id.name[0:3].lower() == 'ceo' :
                                    <div style="margin-left: 1.2rem;margin-bottom:1em;">
                                        <table border="0" style="width: 100%;">
                                            <tr>
                                                <td>
                                                    <a href="/attendance-request/approve?token=${'token' in ctx and ctx['token'] or ''}" target="_blank" 
                                                    style="padding: .5rem 3rem;border-radius: .2em;border: none;color: #fff;background-color: #30a20f;font-size: 16px;margin-top: 1.5rem;display:inline-block;white-space: nowrap;text-decoration: none;">
                                                        Approve
                                                    </a>
                                                </td>

                                                <td>
                                                    <a href="/attendance-request/reject?token=${'token' in ctx and ctx['token'] or ''}" target="_blank" 
                                                    style="padding: .5rem 3rem;border-radius: .2em;border: none;color: #fff;background-color: #ff0000;font-size: 16px;margin-top:1.5rem;display:inline-block;white-space: nowrap;text-decoration: none;">
                                                       Reject
                                                    </a>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                %endif

                                <div style="margin-left: 1.2rem;margin-bottom:1em;">
                                    <p style="color: #676767;line-height: 145%;margin: 10px 0 0 0;font-size: 16px;">
                                        Please login to Tendrils to take action.<br/>
                                        ---------------------------------------------------
                                        <br/>
                                        This is a system generated mail. Please do not reply to this email. 
                                    </p>
                                </div>
                            </td>
                        </tr>
                    </table>
                ]]>
            </field>
        </record>
    </data>
</odoo>
