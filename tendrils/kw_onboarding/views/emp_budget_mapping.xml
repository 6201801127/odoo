<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>

        <record id="emp_budget_mapping_view_tree" model="ir.ui.view">
            <field name="name">Employee Budget Mapping Tree</field>
            <field name="model">hr.employee.budget.mapping</field>
            <field name="arch" type="xml">
                <tree create='0' edit='0' delete='0' import='0' decoration-danger="active_display == 'Inactive'">
                    <field name="emp_id" invisible='1'/>
                    <field name="job_branch_id"/>
                    <field name="department_id"/>
                    <!-- <field name="sl_no"/> -->
                    <field name="emp_code"/>
                    <field name="name" class="font-weight-bold"/>
                    <field name="date_of_joining"/>
                    <field name="job_id"/>
                    <field name="requisition_type"/>
                    <field name="employement_type"/>
                    <field name="emp_role"/>
                    <field name="active_display" invisible='1'/>
                    <field name="emp_category"/>
                    <!-- <field name="budget_effective_from"/> -->
                    <button class="btn btn-info" string="Budget History" name="button_budget_settings" type="object" groups="kw_onboarding.group_kw_onboarding_finance,hr.group_hr_manager"/>
                            
                </tree>
            </field>
        </record>

        <record id="emp_budget_mapping_action" model="ir.actions.act_window">
            <field name="name">Employee Budget Mapping</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">hr.employee.budget.mapping</field>
            <field name="view_mode">tree</field>
            <field name="view_type">form</field>
            <field name="context">{'search_default_active_employees':1}</field>
            <field name="search_view_id" ref="emp_budget_mapping_search"/>
        </record>

        <!-- Search view for "model" -->
        <record id="emp_budget_mapping_search" model="ir.ui.view">
            <field name="name">Employee Budget Mappin Search</field>
            <field name="model">hr.employee.budget.mapping</field>
            <field name="type">search</field>
            <field name="mode">primary</field>
            <field name="priority" eval="16" />
            <field name="active" eval="True" />
            <field name="arch" type="xml">
                <search string="Employee Budget Mappin Search">
                    <field name="name"/>
                    <field name="department_id"/>
                    <field name="job_id"/>
                    <field name="emp_role"/>
                    <field name="emp_category"/>
                    <field name="active_display"/>
                    <filter string="Active" name="active_employees" domain="[('active_display','=','Active')]"/>
                    <filter string="Project Budget" domain="[('requisition_type','=','project')]" name="project_budget"/>
                    <filter string="Treasury Budget" domain="[('requisition_type','=','treasury')]" name="treasury_budget"/>
                    <filter string="FTE" domain="[('employement_type.code','=','P')]" name="fte"/>
                    <filter string="RET-Overhead" domain="[('employement_type.code','=','S')]" name="ret_overhead"/>
                    <filter string="RET-Project" domain="[('employement_type.code','=','C')]" name="ret_project"/>
                    <filter string="Contractual" domain="[('employement_type.code','=','O')]" name="contractual"/>
                </search>
            </field>
        </record>

        <menuitem id="emp_tagging_menu"
                  name="Employee Budget Mapping"
                  sequence="3"
                  parent="kw_onboarding.postonboarding_parent_menu"
                  groups="kw_onboarding.group_kw_onboarding_finance"
                  action='emp_budget_mapping_action'
        />
        <record id="budget_mapping_wizard_form" model="ir.ui.view">
            <field name="name">budget_mapping_wizard.form</field>
            <field name="model">hr.employee.budget_mapping_wizard_data</field>
            <field name="arch" type="xml">
                <form string="Budget Mapping">
                    <sheet>
                        <group>
                            <field name="emp_rec">
                                <tree create="false" delete="false" edit="false">
                                    <field name="emp_id" invisible='1'/>
                                    <field name="job_branch_id"/>
                                    <field name="department_id"/>
                                    <!-- <field name="sl_no"/> -->
                                    <field name="emp_code"/>
                                    <field name="name" class="font-weight-bold"/>
                                    <field name="date_of_joining"/>
                                    <field name="job_id"/>
                                    <field name="requisition_type"/>
                                    <field name="employement_type"/>
                                    <field name="emp_role"/>
                                    <field name="emp_category"/>
                                </tree>
                            </field>
                            <field name="emp_role" required="1" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                            <field name="emp_category" required="1" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                            <field name="budget_effective_from" required="1"/>
                        </group>
                    </sheet>
                    <footer>
                        <button name="update_budget_record_employee" string="Update Role &amp; Category " type="object"
                                class="btn btn-warning" icon="fa-check"/>

                        <button string="Close" class="btn-secondary" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <act_window id="action_budget_mapping_share_onboarding_wizard"
                    name="Budget Mapping"
                    src_model="hr.employee.budget.mapping"
                    res_model="hr.employee.budget_mapping_wizard_data"
                    view_type="form"
                    view_mode="form"
                    view_id="budget_mapping_wizard_form"
                    key2="client_action_multi"
                    target="new"/>


    </data>
</odoo>