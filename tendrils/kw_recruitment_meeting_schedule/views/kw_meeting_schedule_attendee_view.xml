<?xml version="1.0"?>
<odoo>
    <data>

    <!-- tree view -->

        <record id="kw_recruitment_meeting_meeting_attendee_tree" model="ir.ui.view">
            <field name="name">recruitment.kw_meeting_events.tree</field>
            <field name="model">kw_meeting_events</field>
            <field name="priority" eval="99" />
            <field name="arch" type="xml">
                <tree string="Meetings" decoration-bf="message_needaction==True" default_order="final_date,stop desc" create="false" delete="false" import="false">
                    <field name="name" string="Subject"/>
                    <field name="allday" invisible="True"/>
                    <!--<field name="start" string="Start Date"/>
                    <field name="stop" string="End Date"/>
                    <field name="partner_ids"/> 
                    <field name="location"/> -->

                    <field name="display_time"/>
                    <field name="recurrency"/>
                    <field name="rrule_type"/>
                    <field name="final_date"/>
                    <field name="meeting_room_id"/>
                    <field name="agenda_ids"/>
                    <field name="state" invisible="True"/>
                    <field name="duration" widget="float_time"/>
                    <field name="message_needaction" invisible="1"/>
                </tree>
            </field>
        </record>

    <!-- form view -->

        <record id="kw_recruitment_meeting_meeting_attendee_form" model="ir.ui.view">
            <field name="name">recruitment.kw_meeting_events.form</field>
            <field name="model">kw_meeting_events</field>
            <field name="priority" eval="99" />
            <field name="arch" type="xml">
                <form string="Meetings" create="false" edit="false" delete="false" action="false">
                    <sheet>
                        <div name="button_box" class="oe_button_box">
                        <button class="oe_stat_button" 
                        icon="fa-book" type="object" name="action_open_document"
                        attrs="{'invisible': [('applicant_ids', '=', [])]}">
                        <span class="o_stat_text font-weight-bold">
                                Documents
                        </span>
                        </button>

                        <button class="oe_stat_button" type="object" 
                        name="open_feedback_wizard" icon="fa-users">
                        <span class="o_stat_text font-weight-bold">
                                Download Feedback
                        </span>
                        </button>
                        </div>
                        <field name="applicant_ids" invisible="1"/>
                        <field name="res_model" invisible="1"/>
                        <field name="res_id" invisible="1"/>
                        <field name="state" invisible="1"/>
                        <field name="is_meeting_responsible" invisible="1"/>
                        <field name="meeting_start_status" invisible="1"/>
                        <group name="meeting_name">
                            <group>
                                <field name="name" placeholder="e.g. Project Review" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False),('recurrency','=',True)]}" string="Meeting Title"/>
                                <field name="meeting_category" attrs="{'required':True,'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}" widget="radio" options="{'horizontal': true}"/>

                                <field name="project" options="{'no_create': True}" attrs="{'required': [('meeting_category','=','project')],'invisible': [('meeting_category','!=','project')],'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                            </group>
                            <group>
                                <field name="categ_ids" widget="many2many_tags" options="{'limit':1,'no_create': True}" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}" invisible="1"/>
                                <field name="meeting_type_id" options="{'no_create': True,'no_open': True}" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                                <field name="meetingtype_code" invisible="1"/>
                            </group>
                        </group>
                        <group name="meeting_detail_main">
                            <group string="Meeting Details" name="meeting_detail">
                                <field name="start" attrs="{'invisible': True}"/>
                                <field name="stop" attrs="{'invisible': True}"/>
                                <field name="id" attrs="{'invisible': True}"/>

                                <field name="start_date" string="Starting at" attrs="{'required': [('allday','=',True)], 'invisible': [('allday','=',False)], 'readonly': [('id', '!=', False), ('recurrency','=',True)]}"/>
                                <field name="stop_date" string="Ending at" attrs="{'required': [('allday','=',True)],'invisible': [('allday','=',False)], 'readonly': [('id', '!=', False), ('recurrency','=',True)]}"/>

                                <field name="start_datetime" invisible="1"/>

                                <label for="kw_start_meeting_date" string="Date &amp; Time"/>
                                <div class="address_format">
                                    <field name="kw_start_meeting_date" style="width: 50%" attrs="{'required': [('allday','=',False)], 'invisible': [('allday','=',True)], 'readonly': ['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                                    <field name="kw_start_meeting_time" style="width: 50%;" attrs="{'required': [('allday','=',False)], 'invisible': [('allday','=',True)], 'readonly': ['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                                </div>

                                <field name="stop_datetime" invisible="1"/>

                                <label for="duration" attrs="{'invisible': [('allday','=',True)]}"/>
                                <div attrs="{'invisible': [('allday','=',True)]}">
                                    <field name="duration" invisible="1"/>
                                    <field name="kw_duration" attrs="{'required':True,'invisible': [('allday','=',True)],'readonly': ['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                                </div>
                                <field name="allday" invisible="1"/>
                                <field name="company_id" invisible="1"/>
                                <field name="location_id" options="{'no_create': True,'no_open': True}" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                                <field name="meeting_room_id" options="{'no_create': True,'no_open': True}" widget="form.kwmeeting_room_onchange" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                            </group>
                            <group name="meeting_detail_right">
                                <div>
                                    <group string="Interview Details" attrs="{'invisible': [('meetingtype_code','!=', 'interview')]}" name="interview_detail">
                                        <field name="applicant_ids" widget="many2many_tags" options="{'no_create': True,'no_open': True}" attrs="{'invisible': ['|',('meetingtype_code','!=', 'interview'),('meeting_type_id','=', False)]}"/>
                                        <field name="survey_id" options="{'no_create': True,'no_open': True}" attrs="{'invisible': [('meetingtype_code','!=', 'interview')]}"/>
                                        <field name="mode_of_interview" attrs="{'invisible': [('meetingtype_code','!=', 'interview')]}"/>
                                        
                                        <field name="telephone" attrs="{'invisible': [('mode_of_interview','!=', 'telephonic')]}"/>
                                    </group>
                                    <group name="recurrency_group">
                                        <field name="recurrency" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),('id', '!=', False)],'invisible': [('id', '!=', False),('recurrency', '=',False)] }"/>
                                        <field name="recurrent_id" invisible="1"/>
                                    </group>
                                    <div attrs="{'invisible': [('recurrency', '=', False)]}">
                                        <group>
                                            <label for="interval"/>
                                            <div class="o_row">
                                                <field name="interval" attrs="{'required': [('recurrency', '=', True)],'readonly':[('id', '!=', False)]}"/>
                                                <field name="rrule_type" attrs="{'required': [('recurrency', '=', True)],'readonly':[('id', '!=', False)]}"/>
                                            </div>
                                            <label string="Until" for="end_type"/>
                                            <div class="o_row">
                                                <field name="end_type" attrs="{'required': [('recurrency', '=', True)],'readonly':[('id', '!=', False)]}"/>
                                                <field name="count" attrs="{'invisible': [('end_type', '!=', 'count')], 'required': [('recurrency', '=', True)],'readonly':[('id', '!=', False)]}"/>
                                                <field name="final_date" attrs="{'invisible': [('end_type', '!=', 'end_date')], 'required': [('end_type', '=', 'end_date')], 'readonly':[('id', '!=', False)]}"/>
                                            </div>
                                        </group>
                                        <group attrs="{'invisible': [('rrule_type', '!=', 'weekly')] }" name="weekdays">
                                            <field name="mo" attrs="{'readonly':[('id', '!=', False)]}"/>
                                            <field name="tu" attrs="{'readonly':[('id', '!=', False)]}"/>
                                            <field name="we" attrs="{'readonly':[('id', '!=', False)]}"/>
                                            <field name="th" attrs="{'readonly':[('id', '!=', False)]}"/>
                                            <field name="fr" attrs="{'readonly':[('id', '!=', False)]}"/>
                                            <field name="sa" attrs="{'readonly':[('id', '!=', False)]}"/>
                                            <field name="su" attrs="{'readonly':[('id', '!=', False)]}"/>
                                        </group>
                                        <group attrs="{'invisible': [('rrule_type', '!=', 'monthly')],'readonly':[('id', '!=', False)]}">
                                            <label string="Day of Month" for="month_by"/>
                                            <div class="o_row">
                                                <field name="month_by" attrs="{'readonly':[('id', '!=', False)]} "/>
                                                <field name="day" attrs="{'required': [('month_by', '=', 'date'), ('rrule_type', '=', 'monthly')],                                                                 'invisible': [('month_by', '!=', 'date')],'readonly':[('id', '!=', False)]}"/>
                                                <field name="byday" string="The" attrs="{'required': [('month_by', '=', 'day'), ('rrule_type', '=', 'monthly')],                                                                 'invisible': [('month_by', '!=', 'day')],'readonly':[('id', '!=', False)]}"/>
                                                <field name="week_list" nolabel="1" attrs="{'required': [('month_by', '=', 'day'), ('rrule_type', '=', 'monthly')],                                                                 'invisible': [('month_by', '!=', 'day')],'readonly':[('id', '!=', False)]}"/>
                                            </div>
                                        </group>
                                    </div>
                                </div>
                            </group>
                        </group>
                        <label for="meeting_room_availability_status"/>
                        <field name="meeting_room_availability_status" invisible="1"/>
                        <!-- widget="form.kwmeeting_room_availability" -->
                        <div id="meeting_room_availability_status"/>
                        <!-- </page> -->
                        <!-- <page name="agenda_page" string="Meeting Agenda"> -->
                        <group string="Meeting Agenda">

                            <field name="agenda_ids" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}">
                                <tree create="true" delete="true" editable="top">
                                    <field name="name"/>
                                </tree>
                            </field>

                            <field name="description" string="Required Information/ Pre-Preparatory" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>

                            <field name="reference_document" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>

                        </group>
                        <!-- </page> -->
                        <!-- <page name="participant_page" string="Participant Details"> -->
                        <group string="Participant Details">
                            <group>
                                <field name="employee_ids" options="{'no_create': True,'no_open': True,'no_create': True}" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}" string="Internal">
                                    <tree>
                                        <field name="image_small" string="Photo" class="oe_avatar" widget="image"/>
                                        <field name="name"/>
                                        <field name="job_id" string="Designation"/>
                                        <!-- 
                                            <field name="mobile_phone" string="Mobile No" /> -->
                                    </tree>
                                </field>

                                <field name="attendee_notify_option" widget="radio" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)], 'invisible': [('id', '=', 'False')], }" invisible="1"/>
                                <!-- <field name="partner_ids" string="Attendees" invisible="1"/> -->
                            </group>
                            <group>
                                <field name="external_attendee_ids">

                                </field>
                                <!--                                    <field name="external_participant_ids" options="{'no_open': True}" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}" />-->
                            </group>
                        </group>

                        <group string="Meeting Feedback" attrs="{'invisible': [('meetingtype_code','!=', 'interview')]}">
                            <field name="response_ids">
                                <tree create="false" edit="false" open="false" delete="false">
                                    <field name="applicant_id" invisible="0" string="Applicant"/>
                                    <field name="survey_id" invisible="1"/>
                                    <field name="partner_id" string="Interviewer" style="pointer-events:none;"/>
                                    <field name="create_date" string="Date" style="pointer-events:none;" invisible="1"/>
                                    <field name="score" string="Score" style="pointer-events:none;"/>
                                    <field name="remark" string="Remark" style="pointer-events:none;"/>
                                    <field name="relevant_exp" style="pointer-events:none;"/>
                                    <field name="current_user" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                    <button name="view_cv"
                                            type="object"
                                            string="View CV"
                                            class="oe_highlight"
                                            invisible="0"/>
                                    <button name="view_feedback" type="object" string="View Feedback" class="oe_highlight" attrs="{'invisible':[('state','=','new')]}"/>

                                    <button name="give_feedback" type="object" string="Submit Feedback" class="oe_highlight" attrs="{'invisible':[('state','!=','new')]}"/>
                                    <button name="print_feedback" type="object" string="PDF" attrs="{'invisible':[('state','=','new')]}" class="oe_highlight"/>

                                </tree>
                            </field>
                        </group>
                        <!-- </page> -->
                        <!-- <page name="page_options" string="Other Details"> -->
                        <group string="Other Details">
                            <group>
                                <field name="mom_required" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>

                                <field name="mom_controller_id" options="{'no_create': True}" attrs="{'required': [('mom_required', '=', True)],'invisible': [('mom_required','=',False)],'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}" domain="[('id','in',employee_ids)]"/>

                            </group>
                            <group>
                                <field name="privacy" invisible="1" attrs="{'readonly':['|',('state', 'in', ['cancelled']),'|',('meeting_start_status', '=',True),'&amp;',('id', '!=', False), ('recurrency','=',True)]}"/>
                                <!-- <field name="show_as"/> -->
                                <field name="reminder_id" options="{'no_create': True}" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}"/>

                            </group>
                        </group>

                        <group string="Notification">
                            <group>

                                <field name="send_email" string="E-mail" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}"/>
                                <field name="send_sms" string="SMS" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}"/>
                                <field name="send_whatsapp" string="WhatsApp" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}"/>
                                <field name="notify_to_nsa" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}" string="IT Authority"/>
                                <field name="notify_to_admin" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}" string="Admin Authority"/>
                            </group>
                            <group>
                                <field name="email_subject_line" readonly="1"/>
                                <field name="reminder_id"  options="{'no_create': True}" attrs="{'readonly':['|',('meeting_start_status', '=',True),('id', '!=', False)]}" />
                                <field name="sms_content" attrs="{'invisible': [('send_sms','=',False)]}" string="SMS Content"/>
                                <field name="whatsapp_message" attrs="{'invisible': [('send_whatsapp','=',False)]}" string="WhatsApp Content"/>
                            </group>
                        </group>

                        <!-- </page> -->
                        <!-- <page name="page_invitations" string="Invitations" groups="base.group_no_one" attrs="{'invisible': ['|',('recurrency','=',True),('state', 'in', ['cancelled'])]}"> -->
                        <group string="Invitations" groups="base.group_no_one" attrs="{'invisible': ['|',('recurrency','=',True),('state', 'in', ['cancelled'])]}">
                            <button name="action_sendmail" type="object" string="Send mail" icon="fa-envelope" class="oe_link"/>
                            <field name="attendee_ids" widget="one2many" attrs="{'invisible': [('recurrency','=',True)],'readonly':[('state', 'in', ['cancelled'])]}">
                                <tree string="Invitation details" editable="top" create="false" delete="false">
                                    <field name="partner_id"/>
                                    <field name="state"/>
                                    <field name="email" widget="email"/>
                                    <field name="event_recurrency" invisible="1"/>
                                    <field name="event_state" invisible="1"/>
                                    <button name="do_tentative" states="needsAction,declined,accepted" string="Uncertain" type="object" icon="fa-asterisk"/>
                                    <button name="do_accept" string="Accept" states="needsAction,tentative,declined" type="object" icon="fa-check text-success"/>
                                    <button name="do_decline" string="Decline" states="needsAction,tentative,accepted" type="object" icon="fa-times-circle text-danger"/>
                                </tree>
                            </field>
                        </group>
                        <!-- </page> -->
                        <!--  <page name="page_misc" string="Misc" groups="base.group_no_one">
                            <group>
                                <label for="user_id" string="Owner"/>
                                <field name="user_id" nolabel="1"/>
                            </group>
                        </page> -->
                        <!-- </notebook> -->
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="action_kw_meeting_events_attendee" model="ir.actions.act_window">
            <field name="name">Meetings</field>
            <field name="res_model">kw_meeting_events</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('applicant_ids','!=',[])]</field>
            <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'tree', 'view_id': ref('kw_recruitment_meeting_meeting_attendee_tree')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('kw_recruitment_meeting_meeting_attendee_form')})]"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
				    No meeting found.
                </p>
            </field>
        </record>

    </data>
</odoo>
