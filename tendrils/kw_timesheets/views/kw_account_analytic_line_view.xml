<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
      <!-- start : addons menu modified -->
      
        <record id="hr_timesheet.menu_hr_time_tracking" model="ir.ui.menu">
            <field name="groups_id" eval="[[6,0,[ref('hr_timesheet.group_hr_timesheet_user'),ref('group_kw_timesheets_report_manager')]]]"/>
        </record>

        <record id="hr_timesheet.timesheet_menu_activity_mine" model="ir.ui.menu">
            <field name="groups_id" eval="[[6,0,[ref('hr_timesheet.group_hr_timesheet_user'),ref('group_kw_timesheets_report_manager')]]]"/>
        </record>

        <record id="hr_timesheet.act_hr_timesheet_report" model="ir.actions.act_window">
            <field name="context">{'search_default_filter_this_month':1,'search_default_filter_this_week':1,'search_default_filter_today':1,'search_default_groupby_employee':1,'create':False,'edit':False,'delete':False,'view_pm':True}</field>
            <field name="view_ids" eval=""/>
        </record>
            

        <record id="hr_timesheet.timesheet_action_report_by_project" model="ir.actions.act_window">
            <field name="context">{'search_default_groupby_project':1,'search_default_filter_this_month':1,'search_default_filter_this_week':1,'search_default_filter_today':1,'create':False,'edit':False,'delete':False,'view_pm':True}</field>
        </record>

        <record id="hr_timesheet.timesheet_action_report_by_task" model="ir.actions.act_window">
            <field name="context">{'search_default_groupby_task':1,'search_default_filter_this_month':1,'create':False,'edit':False,'delete':False,'view_pm':True}</field>
        </record>

        <record model="ir.ui.menu" id="hr_timesheet.menu_timesheets_reports">
            <field name="groups_id" eval="[[6,0,[ref('hr_timesheet.group_hr_timesheet_user'),ref('group_kw_timesheets_report_manager'),ref('group_kw_timesheets_sbu_representative')]]]"/>
        </record>

        <record model="ir.ui.menu" id="hr_timesheet.menu_timesheets_reports_timesheet">
            <field name="groups_id" eval="[[6,0,[ref('kw_timesheets.group_kw_timesheets_report_manager'),ref('kw_timesheets.group_kw_timesheets_sbu_representative')]]]"/>
        </record>
        
        <record model="ir.ui.menu" id="hr_timesheet.menu_hr_activity_analysis">
          <field name="groups_id" eval="[[6,0,[ref('kw_timesheets.group_kw_timesheets_report_manager'),ref('kw_timesheets.group_kw_timesheets_sbu_representative')]]]"/>
        </record>
        
        <record model="ir.ui.menu" id="hr_timesheet.timesheet_menu_report_timesheet_by_project">
          <field name="groups_id" eval="[[6,0,[ref('kw_timesheets.group_kw_timesheets_report_manager'),ref('kw_timesheets.group_kw_timesheets_sbu_representative')]]]"/>
        </record>
        
       

        <!-- <record id="timesheet_grid.menu_timesheet_grid_validate_previous_week" model="ir.ui.menu">
            <field name="action" eval="False"/>
        </record>
         -->
        <record id="hr_timesheet.timesheet_menu_report_timesheet_by_task" model="ir.ui.menu">
            <field name="active" eval="False"/>
            <field name="groups_id" eval="[[6,0,[ref('kw_timesheets.group_kw_timesheets_report_manager')]]]"/>
        </record>
        
      <!-- end : addons menu modified -->

        <record model="ir.ui.view" id="kw_timesheet_reporting_search">
            <field name="name">kw_timesheet.account.analytic.line.search</field>
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="hr_timesheet.hr_timesheet_line_search"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='month']" position="after">
                    <filter string="This Month" name="filter_this_month" domain="[('date','&lt;=',(datetime.date.today()+relativedelta(day=31)).strftime('%Y-%m-%d')),('date','&gt;=',(datetime.date.today()-relativedelta(day=1)).strftime('%Y-%m-%d'))]" />
                    <separator/>
                    <filter string="This Week" name="filter_this_week" domain="[('date', '&lt;=', ((context_today()+relativedelta(weeks=0, weekday=-1)).strftime('%Y-%m-%d'))),('date', '&gt;=', ((context_today()-relativedelta(weeks=1, weekday=0)).strftime('%Y-%m-%d')))]"/>
                    <separator/>
                    <filter string="Today" name="filter_today" domain="[('date', '&gt;=', datetime.datetime.now().strftime('%Y-%m-%d 00:00:00')),('date', '&lt;=',datetime.datetime.now().strftime('%Y-%m-%d 23:23:59'))]"/>
                    <separator/>
                    <filter string="Delivery" name="filter_delivery_department" domain="[('employee_id.department_id.code','=ilike','delivery')]"/>
                    <separator/>
                  <filter string="Other" name="filter_other_department" domain="['|',('employee_id.department_id.code','=',False),('employee_id.department_id.code','not ilike','delivery')]"/>
              </xpath>
            </field>
        </record>

        <record id="project_category_tree_view" model="ir.ui.view">
            <field name="name">project_category_tree_view</field>
            <field name="model">kw_project_category_master</field>
            <field name="arch" type="xml">
                <tree string="">
                    <field name="name" />
                    <field name="mapped_to" />
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="kw_account_analytic_line_inherit_view">
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="timesheet_grid.timesheet_view_form"/>
            <field name="arch" type="xml">

                <xpath expr="/form" position="attributes">
                    <attribute name="string">Add Your Task</attribute>
                </xpath>

                <xpath expr="//field[@name='project_id']" position="before">
                    <field name="hide_tagged_to" invisible="1"/>
                    <field name="show_oppertunity_mapped" invisible="1"/>
                    <field name="prject_category_id" required="1" options="{'no_open': True,'no_create':True,'no_edit':True}"  context="{'tree_view_ref': 'kw_timesheets.project_category_tree_view'}"/>
                    <field name="crm_lead_id" options="{'no_open': True,'no_create':True,'no_edit':True}" attrs="{'invisible': [('show_oppertunity_mapped', '=', False)],'required': [('show_oppertunity_mapped', '=', True)]}"/>
                    <!-- <field name="get_project_category"  widget="many2many_tags"/> -->
                </xpath>
                <xpath expr="//field[@name='project_id']" position="attributes">
                    <attribute name="string">Tagged To Project</attribute>
                    <attribute name="options">{'no_open': True,'no_create':True,'no_edit':True}</attribute>
                    <attribute name="attrs">{'invisible': [('hide_tagged_to', '=', True)]}</attribute>
                    <attribute name="context">{'tree_view_ref':'kw_timesheets.view_project_id_tree'}</attribute>

                </xpath>
                <xpath expr="//field[@name='crm_lead_id']" position="attributes">
                    <attribute name="context">{'tree_view_ref':'kw_timesheets.view_crm_lead_id_tree', 'search_view_ref':'kw_timesheets.kw_crm_lead_search'}</attribute>
                </xpath>
                <xpath expr="//field[@name='project_id']" position="after">
                    <field name="is_project_activity" invisible="1"/>
                    <!-- <field name="module_id" attrs="{'invisible':[('is_project_activity','=',False)],'required':[('is_project_activity','=',True)]}" -->
                    <field name="module_id" attrs="{'invisible':[('is_project_activity','=',False)],'required':[('is_project_activity', '=', True)]}" options="{'no_open': True,'no_create':True,'no_edit':True,'no_create_edit':True}"/>
                    <field name="parent_task_id" options="{'no_open': True,'no_create':True,'no_edit':True,'no_create_edit':True}" attrs="{'invisible':[('hide_tagged_to', '=', True)],'required':[('hide_tagged_to', '=', False)]}"/>
                </xpath>
                <xpath expr="//field[@name='task_id']" position="attributes">
                    <attribute name="string">Task</attribute>
                    <attribute name="required">True</attribute>
                    <attribute name="options">{'no_open': True,'no_create':True,'no_edit':True}</attribute>
                    <attribute name="context">{'tree_view_ref':'kw_timesheets.view_project_task_id_tree'}</attribute>
                </xpath>
                <xpath expr="//field[@name='employee_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='user_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='date']" position="replace">
                    <field name="date" options="{'datepicker':{'maxDate': 'now'}}"/>
                </xpath>
                <xpath expr="//field[@name='unit_amount']" position="after">
                    <field name="task_start_date" attrs="{'invisible':[('hide_tagged_to', '=', True),('is_project_activity','=',False)]}"/>
                    <field name="task_end_date" attrs="{'invisible':[('hide_tagged_to', '=', True),('is_project_activity','=',False)]}"/>
                    <field name="task_planned_hours" widget="float_time" attrs="{'invisible':[('hide_tagged_to', '=', True),('is_project_activity','=',False)]}"/>
                   
                    <field name="task_status" attrs="{'invisible':[('hide_tagged_to', '=', True)],'required':[('hide_tagged_to', '=', False)]}"/>
                    <field name="name"/>
                </xpath>
                <!-- <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="required">0</attribute>
                </xpath> -->
            </field>

        </record>

        <record model="ir.ui.view" id="kw_account_analytic_line_inherit_tree_view">
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="hr_timesheet.hr_timesheet_line_tree"/>
            <field name="arch" type="xml">
                <xpath expr="//tree" position="attributes">
                    <attribute name="create">false</attribute>
                    <attribute name="edit">false</attribute>
                </xpath>

                <xpath expr="//field[@name='task_id']" position="after" readonly="1">
                    <field name="name" attrs="{'readonly':[('validated','=',True)]}"/>
                    <field name="hide_tagged_to" invisible="1"/>
                    <field name="task_status" readonly="1" attrs="{'invisible':[('hide_tagged_to', '=', True)]}"/>
                </xpath>

                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <xpath expr="//field[@name='unit_amount']" position="attributes">
                    <attribute name="attrs">{'readonly':[('validated','=',True)]}</attribute>
                    <attribute name="required">1</attribute>
                </xpath>

                <xpath expr="//field[@name='name']" position="before">
                    <field name="emp_category_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                    <field name="prject_category_id" invisible="1"/>
                </xpath>

                <xpath expr="//field[@name='date']" position="before">
                    <field name="employee_id" options="{'no_open': True,'no_create':True,'no_edit':True}" invisible="not context.get('view_pm',False)"/>
                    <field name="department_id" options="{'no_open': True,'no_create':True,'no_edit':True}" invisible="not context.get('view_pm',False)"/>
                    <field name="job_id" options="{'no_open': True,'no_create':True,'no_edit':True}" invisible="not context.get('view_pm',False)"/>
                </xpath>

                <xpath expr="//field[@name='date']" position="attributes">
                    <attribute name="attrs">{'readonly':[('validated','=',True)]}</attribute>
                    <attribute name="required">1</attribute>
                </xpath>

                <xpath expr="//field[@name='project_id']" position="attributes">
                    <attribute name="options">{'no_open': True,'no_create':True,'no_edit':True}</attribute>
                    <attribute name="readonly">1</attribute>
                </xpath>

                <xpath expr="//field[@name='task_id']" position="attributes">
                    <attribute name="options">{'no_open': True,'no_create':True,'no_edit':True}</attribute>
                    <attribute name="attrs">{'readonly':[('validated','=',True)]}</attribute>
                    <attribute name="required">1</attribute>
                    <attribute name="readonly">1</attribute>
                </xpath>

                <xpath expr="//field[@name='task_id']" position="before">
                    <field name="project_manager_id" options="{'no_open': True,'no_create':True,'no_edit':True}" invisible="not context.get('view_pm',False)"/>
                    <field name="approved_by" readonly="1"/>
                    <field name="crm_lead_id" invisible="1" readonly="context.get('custom_timesheet_report',False)" attrs="{'readonly':[('validated','=',True)]}" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                </xpath>

            </field>

        </record>

        <!-- Kanban view -->
        <record model="ir.ui.view" id="kw_account_analytic_line_inherit_kanban_view">
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="hr_timesheet.view_kanban_account_analytic_line"/>
            <field name="arch" type="xml">
                <xpath expr="//kanban" position="attributes">
                    <attribute name="create">false</attribute>
                    <attribute name="edit">false</attribute>
                </xpath>
            </field>
        </record>

        <!-- <record id="hr_timesheet.act_hr_timesheet_line_view_kanban" model="ir.actions.act_window.view">
            <field name="view_mode">kanban</field>
            <field name="sequence">99</field>
            <field name="view_id" ref="hr_timesheet.view_kanban_account_analytic_line"/>
            <field name="act_window_id" ref="kw_timesheets.kw_project_timesheet_report_act_window"/>
            <field name="active" eval="False"/>
        </record> -->

        <record id="hr_timesheet_attendance.menu_hr_timesheet_attendance_report" model="ir.ui.menu">
            <field name="action" eval="False"/>
        </record>

        <record id="view_project_id_tree" model="ir.ui.view">
            <field name="name">view.project.project.tree</field>
            <field name="model">project.project</field>
            <field name="type">tree</field>
            <field name="mode">primary</field>
            <field name="priority" eval="99"/>
            <field name="active" eval="True"/>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <!-- CRM LEAD TREE -->
        <record id="view_crm_lead_id_tree" model="ir.ui.view">
            <field name="name">view_crm_lead_id.tree</field>
            <field name="model">crm.lead</field>
            <field name="type">tree</field>
            <field name="mode">primary</field>
            <field name="priority" eval="99"/>
            <field name="active" eval="True"/>
            <field name="arch" type="xml">
                <tree>
                    <field name="code"/>
                    <field name="name" string="Name"/>
                </tree>
            </field>
        </record>

        <record id="kw_crm_lead_search" model="ir.ui.view">
            <field name="name">crm_lead.search</field>
            <field name="model">crm.lead</field>
            <field name="arch" type="xml">
                <search string="CRM Search">
                    <field name="name" string="Name"/>
                    <field name="code"/>
                    <group expand="0" string="Group By">
                        <filter name="name" string="Name" invisible="1"/>
                    </group>
                </search>
            </field>
        </record>

        <record id="view_project_task_id_tree" model="ir.ui.view">
            <field name="name">view.project.task.tree</field>
            <field name="model">project.task</field>
            <field name="type">tree</field>
            <field name="mode">primary</field>
            <field name="priority" eval="99"/>
            <field name="active" eval="True"/>
            <field name="arch" type="xml">
                <tree>
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <!-- Inherit Timesheet View Tree User -->
        <record model="ir.ui.view" id="kw_timesheet_view_tree_user">
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="hr_timesheet.timesheet_view_tree_user"/>
            <field name="arch" type="xml">

                <xpath expr="//tree" position="attributes">
                    <attribute name="delete">false</attribute>
                </xpath>

                <xpath expr="//field[@name='employee_id']" position="replace" />
                <xpath expr="//field[@name='employee_id']" position="attributes">
                    <attribute name="readonly">1</attribute>
                </xpath>
                
                <xpath expr="//field[@name='crm_lead_id']" position="attributes">
                    <attribute name="readonly">1</attribute>
                </xpath>
                <xpath expr="//field[@name='date']" position="replace">
                    <field name="date" options="{'datepicker':{'maxDate': 'now'}}" readonly="1"/>
                </xpath>
                <xpath expr="//field[@name='project_id']" position="after">
                    <field name="project_code"/>
                </xpath>
            </field>

        </record>

        <record model="ir.ui.view" id="kw_timesheet_view_form_user">
            <field name="model">account.analytic.line</field>
            <field name="inherit_id" ref="analytic.view_account_analytic_line_form"/>
            <field name="arch" type="xml">

                <xpath expr="//form" position="attributes">
                    <attribute name="edit">false</attribute>
                    <attribute name="create">false</attribute>
                    <attribute name="delete">false</attribute>
                </xpath>

            </field>

        </record>

        <record id="account_analytic_line_view_tree" model="ir.ui.view">
            <field name="name">account.analytic.line.view.validate.tree</field>
            <field name="model">account.analytic.line</field>
            <field name="priority" eval="99"/>
            <field name="arch" type="xml">
                <tree import="0" editable="top">
                    <field name="date" readonly="1"/>
                    <field name="employee_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}" />
                    <field name="hide_tagged_to" invisible="1" />
                    <field name="prject_category_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="project_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="task_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="name" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="task_status" readonly="1"  attrs="{'invisible':[('hide_tagged_to', '=', True)]}"/> 
                     <field name="work_hours" readonly="1" widget="float_time"/>
                    <field name="unit_amount" string="Timesheet fill (Hours)" sum="Total" widget="float_time"/>
                    <button name="action_validate_timesheet" type="object" string="Validate" class="oe_highlight"/>
                </tree>
            </field>
        </record>
            
        

        <record id="kw_timesheets_validate_window_action" model="ir.actions.act_window">
            <field name="name">Validate Timesheets</field>
            <field name="res_model">account.analytic.line</field>
            <field name="view_mode">tree</field>
            <field name="domain">[]</field>
            <field name="context">{'create':False,'delete':False,'filter_ra_pm_reviewer_timesheet':1}</field>
            <field name="view_ids" eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('kw_timesheets.account_analytic_line_view_tree')})]"/>
            <field name="help" type="html">
                <p>No timesheet found...</p>
            </field>
        </record>
         <record id="timesheet_grid.menu_timesheet_grid_validate" model="ir.ui.menu">
            <field name="groups_id" eval="[[6,0,[ref('hr_timesheet.group_hr_timesheet_user'),ref('group_kw_timesheets_report_manager')]]]"/>
            <field name="action" ref="kw_timesheets_validate_window_action"/>
        </record>

        <record id="account_analytic_line_view_rcm_tree" model="ir.ui.view">
            <field name="name">account.analytic.line.view.rcm.tree</field>
            <field name="model">account.analytic.line</field>
            <field name="priority" eval="99"/>
            <field name="arch" type="xml">
                <tree create='0' edit='0' delete='0' import='0'>
                    <field name="date" readonly="1"/>
                    <field name="employee_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}" />
                    <field name="hide_tagged_to" invisible="1" />
                    <field name="prject_category_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="project_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="task_id" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="name" readonly="1" options="{'no_open': True,'no_create':True,'no_edit':True,'no_edit':True}"/>
                    <field name="task_status" readonly="1"  attrs="{'invisible':[('hide_tagged_to', '=', True)]}"/>
                    <field name="approved_by" readonly="1"/>
                    <field name="work_hours" readonly="1" widget="float_time"/>
                    <field name="unit_amount" string="Timesheet fill (Hours)" sum="Total" widget="float_time"/>
                </tree>
            </field>
        </record>
           
          <record id="kw_timesheets_validate_rcm_window_action" model="ir.actions.act_window">
            <field name="name">RCM Timesheets</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">account.analytic.line</field>
            <field name="view_mode">tree</field>
            <field name="view_type">form</field>
        </record>


    </data>
</odoo>
