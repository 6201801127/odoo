<?xml version="1.0" encoding="UTF-8"?>
<odoo>
      <data noupdate='0'>
            <record model="ir.module.category" id="module_category_kw_announcement">
                  <field name="name">Announcement</field>
                  <field name="description">User access level for this module</field>
                  <field name="sequence">3</field>
            </record>

            <record id="group_kw_announcement_subscriber" model="res.groups">
                  <field name="name">Subscriber</field>
                  <field name="category_id" ref="kw_announcement.module_category_kw_announcement"/>
                   <field name="users" eval="[(4, ref('base.user_root'))]"/>
            </record>

            <record id="group_kw_announcement_publisher" model="res.groups">
                  <field name="name">Publisher</field>
                  <field name="category_id" ref="kw_announcement.module_category_kw_announcement"/>
                  <field name="implied_ids" eval="[(4, ref('kw_announcement.group_kw_announcement_subscriber'))]"/>
            </record>

            <record id="group_kw_announcement_manager" model="res.groups">
                  <field name="name">Manager</field>
                  <field name="category_id" ref="kw_announcement.module_category_kw_announcement"/>
                  <field name="implied_ids" eval="[(4, ref('kw_announcement.group_kw_announcement_publisher'))]"/>
                  <field name="users" eval="[(4, ref('base.user_admin'))]"/>
            </record>

            <record id="base.default_user" model="res.users">
                  <field name="groups_id" eval="[(4,ref('kw_announcement.group_kw_announcement_subscriber'))]"/>
            </record>

            <!-- Category Record rule to show the records for assigned group only For Publisher group -->
            <record model="ir.rule" id="category_assigned_rule_publisher_read">
                  <field name="name">Assigned Category</field>
                  <field name="model_id" ref="model_kw_announcement_category"/>
                  <field name="domain_force">[('assigned_groups','in',[g.id for g in user.groups_id])]</field>
                  <field name="perm_create" eval="False"/>
                  <field name="perm_write" eval="False"/>
                  <field name="perm_unlink" eval="False"/>
                  <field name="groups" eval="[(4,ref('kw_announcement.group_kw_announcement_publisher'))]"/>
            </record>

            <record id="kw_announcement_category_rule_manager" model="ir.rule">
                  <field name="name">Category: manager: no limit</field>
                  <field name="model_id" ref="model_kw_announcement_category"/>
                  <field name="domain_force">[(1, '=', 1)]</field>
                  <field name="groups" eval="[(4, ref('group_kw_announcement_manager'))]"/>
            </record>

            <record id="kw_announcement_category_rule_subscriber" model="ir.rule">
                  <field name="name">Category: subscriber: no limit</field>
                  <field name="model_id" ref="model_kw_announcement_category"/>
                  <field name="domain_force">[(1, '=', 1)]</field>
                  <field name="perm_create" eval="False"/>
                  <field name="perm_write" eval="False"/>
                  <field name="perm_unlink" eval="False"/>
                  <field name="groups" eval="[(4, ref('group_kw_announcement_subscriber'))]"/>
            </record>

            <record id="kw_announcement_rule_manager" model="ir.rule">
                  <field name="name">Announcements: manager: no limit</field>
                  <field name="model_id" ref="model_kw_announcement"/>
                  <field name="domain_force">[(1, '=', 1)]</field>
                  <field name="groups" eval="[(4, ref('group_kw_announcement_manager'))]"/>
            </record>

            <record id="kw_announcement_comments_rule_manager" model="ir.rule">
                  <field name="name">Announcement Comments: manager: no limit</field>
                  <field name="model_id" ref="model_kw_announcement_comments"/>
                  <field name="domain_force">[(1, '=', 1)]</field>
                  <field name="groups" eval="[(4, ref('group_kw_announcement_manager'))]"/>
            </record>



            <!-- Announcement Record rule to show the records for assigned group only For Publisher group -->

            <record model="ir.rule" id="announcement_assigned_cat_rule_publisher_write">
                  <field name="name">Edit/Delete Created Announcements</field>
                  <field name="model_id" ref="model_kw_announcement"/>
                  <field name="domain_force">[('create_uid','=', user.id)]</field>
                  <field name="perm_read" eval="False"/>
                  <field name="perm_create" eval="True"/>
                  <field name="perm_write" eval="True"/>
                  <field name="perm_unlink" eval="True"/>
                  <field name="groups" eval="[(4,ref('kw_announcement.group_kw_announcement_publisher'))]"/>
            </record>

            <record model="ir.rule" id="announcement_assigned_cat_rule_publisher_read">
                  <field name="name">Read Created Announcements</field>
                  <field name="model_id" ref="model_kw_announcement"/>
                  <field name="domain_force">['|', ('create_uid', '=', False), ('create_uid', '=', user.id)]</field>
                  <field name="perm_read" eval="True"/>
                  <field name="perm_create" eval="False"/>
                  <field name="perm_write" eval="False"/>
                  <field name="perm_unlink" eval="False"/>
                  <field name="groups" eval="[(4,ref('kw_announcement.group_kw_announcement_publisher'))]"/>
            </record>

            <record id="kw_announcement_rule_subscriber" model="ir.rule">
                  <field name="name">Announcements: subscriber: audience </field>
                  <field name="model_id" ref="model_kw_announcement"/>
                  <field name="domain_force">['&amp;','&amp;',('state','=','published'),('enable_location','=',False),'|',('broadcasting_group','in',[g.id for g in user.groups_id]),('broadcasting_group','=',False)] </field>
                  <field name="perm_read" eval="True"/>
                  <field name="perm_create" eval="False"/>
                  <field name="perm_write" eval="False"/>
                  <field name="perm_unlink" eval="False"/>
                  <field name="groups" eval="[(4, ref('group_kw_announcement_subscriber'))]"/>
            </record>

            <record id="kw_announcement_rule_subscriber_location" model="ir.rule">
                  <field name="name">Announcements: subscriber: location specific audience </field>
                  <field name="model_id" ref="model_kw_announcement"/>
                  <field name="domain_force">['&amp;','&amp;',('state','=','published'),('enable_location','=',True),('broadcast_location','in',[emp.work_location_id.id for emp in user.employee_ids])]</field>
                  <field name="perm_read" eval="True"/>
                  <field name="perm_create" eval="False"/>
                  <field name="perm_write" eval="False"/>
                  <field name="perm_unlink" eval="False"/>
                  <field name="groups" eval="[(4, ref('group_kw_announcement_subscriber'))]"/>
            </record>


      </data>
</odoo>