<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>


		<!-- Tree view for "model" -->
		<record id="view_kw_mrf_tree" model="ir.ui.view">
			<field name="name">view.kw_mrf.tree</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">tree</field>
			<field name="mode">primary</field>
			<field name="arch" type="xml">
				<tree import="false" decoration-success="state=='approve'"
				      decoration-danger="state=='reject'" default_order='id desc'>
					<field name="order_sequence" invisible="1"/>
					<field name="code"/>
					<field name="requisition_type"/>
					<field name="type_employment" invisible="1"/>
					<field name="resource"/>
					<field name="employee_id" widget="many2many_tags" string="Replacement For" invisible="1"/>
					<field name="role_id"/>
					<field name="categ_id"/>
					<field name="req_raised_by_id" string="Raised By"/>
					<field name="state"/>
					<field name="pending_at"/>
					<field name="active" widget="boolean_toggle" invisible="1"/>
					<field name="approved_user_id"/>
				</tree>
			</field>
		</record>


		<record id="view_kw_mrf_kanban" model="ir.ui.view">
			<field name="name">kw_mrf.kanban</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="priority">16</field>
			<field name="arch" type="xml">
				<kanban import="false" class="oe_background_grey o_kanban_dashboard o_hr_recruitment_kanban">
					<field name="code"/>
					<field name="requisition_type"/>
					<field name="type_employment" invisible="1"/>
					<field name="resource"/>
					<field name="employee_id"/>
					<field name="role_id"/>
					<field name="categ_id"/>
					<field name="req_raised_by_id"/>
					<field name="state"/>
					<field name="pending_at"/>
					<field name="active"/>
					<field name="approved_user_id"/>
					<templates>
						<t t-name="kanban-box">
							<div class="oe_kanban_global_click">
								<div class="o_kanban_card_content">
									<p class="badge badge-warning h2 mt-0 p-2 mb-2 font-weight-bold"
									   style="font-size:16px">
										<field name="code"/>
									</p>
									<br/>
									<table class="table table-borderless">
										<tr>
											<td style="width:50%">Employment Type</td>
											<td style="width:5%">:</td>
											<td>
												<field name="type_employment" invisible="1"/>
											</td>
										</tr>
										<tr>
											<td>Raised By</td>
											<td>:</td>
											<td>
												<field name="req_raised_by_id"/>
											</td>
										</tr>
										<tr>
											<td>Raised On</td>
											<td>:</td>
											<td>
												<field name="create_date"/>
											</td>
										</tr>
									</table>

								</div>
							</div>
						</t>
					</templates>
				</kanban>
			</field>
		</record>

		<!-- Form view for "model" -->
		<record id="view_kw_mrf_form" model="ir.ui.view">
			<field name="name">view.model.form</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">form</field>
			<field name="mode">primary</field>
			<field name="priority">1</field>
			<field name="arch" type="xml">
				<form string="Manpower Requisition" import="false">
					<style>
                        .o_form_view .o_group.o_inner_group > tbody > tr > td.o_td_label{min-width: 200px !important;}
                    </style>
					<header>
						<button name="send_for_approval" type="object"
						        string="Send for Approval" class="btn btn-success"
						        attrs="{'invisible':[('state','!=','draft')]}"
						/>
						<field name="state" widget="statusbar" statusbar_visible="draft,sent,approve,reject"/>
						<field name="user_inv" invisible="1"/>
						<field name="is_final_approver" invisible="1"/>
						<field name="forwarded" invisible="1"/>
					</header>
					<sheet>
						<group>
							<group string="General Requirement">
								<field name="rcm_check" invisible="1"/>
								<field name="is_report_manager" invisible="1"/>
								<field name="is_mrf_user" invisible="1"/>
								<field name="rcm_head" invisible="1"/>
								<field name="hod_check" invisible="1"/>
								<field name="is_tag_user" invisible="1"/>
								<field name="forward_to_ceo" invisible='1'/>
							   <field name="forward_check" invisible='1'/>
								<field name="last_approver_ids" invisible="1"/>
								<field name="current_user" invisible="1"/>
								<field name="hide_sal" invisible="1"/>
								<field name="code" string="Reference No."/>
								<field name="req_raised_by" readonly="1"/>
								<field name="req_raised_by_id" invisible="1"/>
								<field name="approver_field" invisible="1"/>
								<field name="dept_name" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'readonly':['|','|', ('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True),('rcm_check','=',False)],'required': True}"/>
								<field name="approver_id"
										attrs="{'readonly':['|',('rcm_check','=',False),('state','in',['hold','reject','approve','forward'])],'required': True}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"/>
								<field name="forwarder_id"
								       attrs="{'invisible':['|',('is_final_approver','=', False),('state','in',['hold','approve','reject','forward'])]}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"/>
								<field name="field_edit_post_approval" invisible="1"/>
								<field name="branch_id" options="{'no_open': True,'no_edit':True,'no_create':True}"
								       widget="many2many_tags"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
								<field name="resource" string="Resource Type"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>

								<field name="employee_id"
								       attrs="{'invisible':['|','&amp;',('resource','=',False),('employee_id','=',False),('resource','=','new')],'required':[('resource','!=','new')],'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       widget="many2many_tags" string="Replacement for"/>

								<field name="current_ctc"
								       force_save="1"
								       readonly="1"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       string="Current CTC" invisible="1"/>

								<field name="type_employment"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       invisible="1"/>
							</group>
							<group string="Budget Settings">
                                <field name="is_type_of_project" invisible='1'/>
								<field name="requisition_type" string="Budget Type"
								       attrs="{'readonly':['|', ('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>

								<field name="role_id" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       domain="[('budget_type','=',requisition_type)]"
								       attrs="{'invisible':[('role_id','=',False),('is_type_of_project','=',False)],'required': ['|',('requisition_type','=', 'project'),('is_type_of_project','=',True)],
									   'readonly':['|','|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True),('role_id','=',True)]}"/>
								<field name="categ_id" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'invisible':[('role_id','=',False),('is_type_of_project','=',False)],'required': ['|',('requisition_type','=', 'project'),('is_type_of_project','=',True)],
									   'readonly':['|','|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True),('role_id','=',True)]}" 
									   domain="[('role_ids', '=', role_id)]"/>
								<field name="type_project"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('is_type_of_project','=',False)],'required': ['|',('requisition_type','=', 'project'),('is_type_of_project','=',True)],'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],}"/>
								<field name="project"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('is_type_of_project','=',False)],'required': ['|',('requisition_type','=', 'project'),('is_type_of_project','=',True)],'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"/>
								<field name="duration"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('is_type_of_project','=',False)],'required': ['|',('requisition_type','=', 'project'),('is_type_of_project','=',True)],'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],}"/>
								<field name="name_of_business" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('is_type_of_project','=',False)],'required': ['|',('requisition_type','=', 'project'),('is_type_of_project','=',True)],'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],}"
								       />
								<field name="employment_is" attrs="{'invisible':['|','&amp;',('requisition_type','=',False),('type_project','=',False),('requisition_type','=','project')],'required': [('requisition_type','=', 'treasury')],'readonly':['|',('state','in',['hold','reject','forward']),('field_edit_post_approval','=', True)],}"
								       widget="radio" options="{'horizontal':True}" invisible="1"/>
								<field name="employment_duration" invisible="1"/>
							</group>
						</group>
						<group>
							<group string="Requisition Details">
								<field name="job_position" string='Position'
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
								<field name="date_requisition"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
								<field name="no_of_resource" force_save='1'
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('rcm_head','=',True)],'required': True}"/>
								<field name="skill_set"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
								<field name="qualification"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
								<field name='technology' options="{'no_open': True,'no_edit':True}"
								       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"
									   invisible="0"/>
							</group>
							<group string="Experience">
								<label for="experience" class="oe_inline"/>
								<div>
									<group>
										<field name="min_exp_year"
										       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
										<field name="max_exp_year"
										       attrs="{'readonly':['|',('state','in',['hold','reject','forward','approve']),('field_edit_post_approval','=', True)],'required': True}"/>
									</group>
								</div>
								<field name="dept_planned_budget"   readonly='1' invisible='1' force_save='1'/>
								<field name="dept_remaining_budget" string="Dpt. Remaining Budget (TP-TI)" readonly='1' invisible='1' force_save='1'/>
								<field name="max_sal" string="Salary per Month" force_save='1'
									attrs="{'readonly':['|','|','|','|',('field_edit_post_approval','=', True),('rcm_head','=',True),('hod_check','=',True),('is_report_manager','=',True),('state','in',['forward','approve','hold','reject'])],'invisible':['|','|',('state','=','draft'),('is_mrf_user','=',True),('is_tag_user','=',True)],'required':True,}"/>
								<field name="avg_replacement_sal" readonly='1' attrs="{'invisible':[('resource','=','new')]}"/>
								<field name="extra_load_on_budget" string="Extra Load on Budget"
									   readonly="1" force_save="1" invisible="1"/>
								<field name="description" attrs="{'readonly':['|',('state','not in',['draft','sent']),('field_edit_post_approval','=', True)]}"/>
								<field name="forwared_note" readonly="1" invisible="1"/>
								<field name="approved_note" readonly="1" invisible="1"/>
							</group>
						</group>
					</sheet>
					<group name="hide_chatter_mrf" attrs="{'invisible':[('hide_sal','=',True)]}">
						<div class="oe_chatter">
							<field name="message_follower_ids" widget="mail_followers"/>
							<field name="activity_ids" widget="mail_activity"/>
							<field name="message_ids" widget="mail_thread"/>
						</div>
					</group>
				</form>
			</field>
		</record>

		<record id="view_kw_mrf_search" model="ir.ui.view">
			<field name="name">view.kw_mrf.search</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">search</field>
			<field name="arch" type="xml">
				<search>
					<field name="code"/>
					<field name="req_raised_by_id" string="Raised By"/>
					<field name="create_date" string="Applied On"/>
					<field name="requisition_type"/>
					<field name="type_employment" invisible="1"/>
					<field name="resource"/>
					<field name="role_id"/>
					<field name="categ_id"/>
					<field name="state"/>
					<field name="employee_id" string="Replacement For"/>
					<separator/>
					<group expand="0" string="Group By">
						<filter name="group_state" string="State" context="{'group_by':'state'}"/>
					</group>
				</search>
			</field>
		</record>


		<!-- Main window action for "model" -->
		<record id="kw_mrf_act_window" model="ir.actions.act_window">
			<field name="type">ir.actions.act_window</field>
			<field name="name">Manpower Requisitions</field>
			<field name="res_model">kw_recruitment_requisition</field>
			<field name="view_mode">tree,form</field>
			<field name="view_type">form</field>
			<field name="search_view_id" ref="view_kw_mrf_search"/>
			<field name="domain">['|',('state','!=','draft'),('state','=','draft')]</field>
            <field name="context">{'manpower_requisition_context':True}</field>
			<field name="view_ids" eval="[(5, 0, 0),
		(0, 0, {'view_mode': 'tree', 'view_id': ref('view_kw_mrf_tree')}),
		(0, 0, {'view_mode': 'form', 'view_id': ref('view_kw_mrf_form')}),
		(0, 0, {'view_mode': 'kanban', 'view_id': ref('view_kw_mrf_kanban')})]"/>

			<!-- <field name="view_id" ref="view_kw_mrf_tree"/> -->
			<field name="help" type="html">
				<p class="o_view_nocontent_smiling_face">
					No record found..
				</p>
			</field>

		</record>
		<!-- Tree view for pending actions. -->
		<record id="view_kw_mrf_rcm_checkpoint_tree" model="ir.ui.view">
			<field name="name">view.kw_mrf.tree</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">tree</field>
			<field name="mode">primary</field>
			<field name="arch" type="xml">
				<tree create="false" import="false">
					<field name="code"/>
					<field name="req_raised_by_id" string="Raised By"/>
					<field name="create_date" string="Applied On"/>
					<field name="requisition_type"/>
					<field name="type_employment" invisible="1"/>
					<field name="resource"/>
					<field name="employee_id" widget="many2many_tags" string="Replacement For" invisible="1"/>
					<field name="role_id"/>
					<field name="categ_id"/>
					<field name="state"/>
					<field name="only_mrf_user" invisible='1'/>
					<button name="action_button_rcm_checkpoint" context="{'show_validation': True,'hide_alert': True}"  type="object" string="Take Action" class="oe_highlight" />
				</tree>
			</field>
		</record>

		<record id="view_kw_mrf_approve_action_tree" model="ir.ui.view">
			<field name="name">view.kw_mrf.tree</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">tree</field>
			<field name="mode">primary</field>
			<field name="arch" type="xml">
				<tree create="false" import="false">
					<field name="code"/>
					<field name="req_raised_by_id" string="Raised By"/>
					<field name="create_date" string="Applied On"/>
					<field name="requisition_type"/>
					<field name="type_employment" invisible="1"/>
					<field name="resource"/>
					<field name="employee_id" widget="many2many_tags" string="Replacement For" invisible="1"/>
					<field name="role_id"/>
					<field name="categ_id"/>
					<field name="state"/>
				</tree>
			</field>
		</record>

		<!-- Form view for RCM Check Point  -->
		<record id="view_kw_mrf_rcm_checkpoint_form" model="ir.ui.view">
			<field name="name">view.model.form</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">form</field>
			<field name="mode">primary</field>
			<field name="priority">20</field>
			<field name="arch" type="xml">
				<form string="Manpower Requisition" create="false" import="false">
					<header>
						<field name="forward_check" invisible='1'/>
						<button name="action_forward_to_ceo" type="object"
						        string="Proceed" class="btn btn-success"
						        attrs="{'invisible':['|',('state','!=','sent'),('forward_check','=',False)]}"
								groups='kw_resource_management.group_budget_manager'
						/>
						<button name="action_validate" 
								type="object" string="Proceed"
						        class="btn btn-success"
								attrs="{'invisible':['|',('state','!=','sent'),('forward_check','=',True)]}" 
								groups='kw_resource_management.group_budget_manager'/>

						<button name="action_reject" type="object" 
								string="Decline" class="btn-danger"
								groups='kw_resource_management.group_budget_manager'
								attrs="{'invisible':[('state','in',['approve','reject','draft','forward','hold'])]}"/>

						<button name="send_to_tag" type="object" 
								string="Notify TAG for Employee Role &amp; Category" class="btn btn-success" 
								groups='kw_resource_management.group_budget_manager'
								attrs="{'invisible':['|','|','|',('state','in',['approve','reject','draft','forward','hold']),('role_id','!=',False),('requisition_type','=','project'),('type_project','=','opportunity')]}"/>
						
						<!-- <button name="update_budget_rcm" type="object" 
								string="Update Budget" class="btn btn-primary" 
								groups='kw_recruitment.group_tag_budget_user,kw_resource_management.group_budget_manager'
								attrs="{'invisible':['|','|',('state','in',['approve','reject','draft','forward','hold']),('requisition_type','=','project'),('type_project','=','opportunity')]}"/> -->
						
						<button name="send_to_rcm" type="object" 
								string="Notify To RCM"
								class="btn btn-success"  
								groups='kw_recruitment.group_tag_budget_user'
								attrs="{'invisible':['|','|',('state','in',['approve','reject','draft','forward']),('requisition_type','=','project'),('type_project','=','opportunity')]}"/>

						<button name="action_approved" type="object" 
								string="Approve" class="btn-success"
								attrs="{'invisible':['|','|',('state','in',['approve','reject','draft','sent']),('rcm_check','=',True),('hod_check','=',False)]}" 
								/>

						<button name="action_hold" type="object" string="Hold"
						        attrs="{'invisible':['|','|',('state','not in',['forward']),('rcm_check','=',True),('hod_check','=',False)]}"
						        class="btn-warning" />

						<button name="action_reject" type="object" string="Decline"
								attrs="{'invisible':['|','|',('state','not in',['forward','hold']),('rcm_check','=',True),('hod_check','=',False)]}"
						        class="btn-danger" />	
						
						<field name="state" widget="statusbar" statusbar_visible="draft,sent,forward,approve,reject"/>
						<field name="user_inv" invisible="1"/>
						<field name="is_final_approver" invisible="1"/>
						<field name="forwarded" invisible="1"/>
					</header>
					<sheet>
						<group>
							<group string="General Requirement">
								<field name="last_approver_ids" invisible="1"/>
								<field name="current_user" invisible="1"/>
								<field name="hide_sal" invisible="1"/>
								<field name="code" string="Reference No."/>
								<field name="req_raised_by" readonly="1"/>
								<field name="req_raised_by_id" invisible="1"/>
								<field name="field_edit_post_approval" invisible="1"/>
								<field name="dept_name" options="{'no_open': True,'no_create':True,'no_edit':True}"
										attrs="{'readonly':[('rcm_check','=',False)]}"
								       readonly="1"/>
								<field name="approver_id"
								attrs="{'readonly':[('rcm_check','=',False)],'required': True}"
								options="{'no_open': True,'no_create':True,'no_edit':True}" readonly="1"/>
								
								<field name="branch_id" options="{'no_open': True,'no_edit':True}"
								       widget="many2many_tags" readonly="1"
								       attrs="{'required': True}"/>
								<field name="resource" string="Resource Type" readonly="1"
								attrs="{'required': True}"/>
								
								<field name="employee_id" readonly="1"
								       attrs="{'invisible':['|','&amp;',('resource','=',False),('employee_id','=',False),('resource','=','new')],'required':[('resource','!=','new')],'readonly':[('state','in',['approve','reject'])],}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       widget="many2many_tags" string="Replacement for"/>
								        
								<field name="current_ctc"
								       force_save="1"
								       readonly="1"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       string="Current CTC" invisible="1"/>
									   <field name="type_employment"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								      	invisible="1"/>
								<field name="forwarder_id"
								attrs="{'invisible':['|',('is_final_approver','=', False),('state','in',['approve','reject'])]}"
								options="{'no_open': True,'no_create':True,'no_edit':True}" readonly="1"/>
								
								<field name="approver_field" invisible="1"/>
							</group>
							<group string="Budget Settings">
								<field name="rcm_check" invisible="1"/>
								<!-- <field name="rcm_group" invisible="1"/> -->
								<field name="hod_check" invisible="1"/>
								<field name="is_tag_user" invisible="1"/>
								<field name="forward_to_ceo" invisible='1'/>
                                <field name="is_type_of_project" invisible='1'/>
								<field name="is_report_manager" invisible='1'/>
								<field name="requisition_type" string="Budget Type" 
								attrs="{'readonly':['|','|',('state','in',['reject','draft','approve']),('is_tag_user','=',False),('is_report_manager','=',True)],'required': True} "/>

								<field name="role_id" options="{'no_open': True,'no_create':True,'no_edit':True}" 
								       domain="[('budget_type','=',requisition_type)]"
								       attrs="{'readonly':['|','|',('is_tag_user','=',False),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('rcm_check','=',True),('is_tag_user','=',True)]}"/>
								
								<field name="categ_id" options="{'no_open': True,'no_create':True,'no_edit':True}" 
								   attrs="{'readonly':['|','|',('is_tag_user','=',False),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('rcm_check','=',True),('is_tag_user','=',True)]}" domain="[('role_ids', '=', role_id)]"/>
								
								<field name="type_project"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('type_project','!=','opportunity')],'readonly':['|',('is_tag_user','=',False),('is_report_manager','=',True)],'required':['|',('type_project','=','opportunity'),('requisition_type','=','project')]}"/>
								<field name="project"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('type_project','!=','opportunity')],'readonly':['|',('is_tag_user','=',False),('is_report_manager','=',True)],'required':['|',('type_project','=','opportunity'),('requisition_type','=','project')]}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"/>
								<field name="duration"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('type_project','!=','opportunity')],'readonly':['|',('is_tag_user','=',False),('is_report_manager','=',True)],'required':['|',('type_project','=','opportunity'),('requisition_type','=','project')]}"/>
								<field name="name_of_business" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'invisible':[('requisition_type','=','treasury'),('type_project','!=','opportunity')],'readonly':['|',('is_tag_user','=',False),('is_report_manager','=',True)],'required':['|',('type_project','=','opportunity'),('requisition_type','=','project')]}"/>
								<field name="employment_is" attrs="{'invisible':['|','&amp;',('requisition_type','=',False),('type_project','=',False),('requisition_type','=','project')],'required': [('requisition_type','=', 'treasury')],'readonly':[('state','in',['reject','forward','draft'])]}"
								       widget="radio" options="{'horizontal':True}" invisible="1"/>
								<field name="employment_duration" attrs="{'invisible':['|','|','&amp;',('requisition_type','=',False),('type_project','=',False),('requisition_type','=','project'),('employment_is','!=','temporary')],'required': [('requisition_type','=', 'treasury'),('employment_is','=','temporary')],'readonly':['|',('state','in',['reject','forward']),('field_edit_post_approval','=', True)],}"/>
							</group>
						</group>
						<group>
							<group string="Requisition Details">
								<field name="job_position" string='Position' 
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('is_tag_user','=',True),('rcm_check','=',False)]}"/>
								<field name="date_requisition"
								       attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('is_tag_user','=',True),('rcm_check','=',False)]}"/>
								<field name="no_of_resource" style="width:20%%"  force_save='1'
									attrs="{'readonly':['|','|',('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('rcm_check','=',False),('rcm_check','=',True)]}"/>
								<field name="skill_set" readonly="0"
								       attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('is_tag_user','=',True),('rcm_check','=',False)]}"/>
								<field name="qualification"
								       attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('is_tag_user','=',True),('rcm_check','=',False)]}"/>

								<field name="technology" readonly="0" options="{'no_open': True,'no_edit':True}" invisible="0"
								attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': True}"/>


							</group>
							<group string="Experience">

								<label for="experience" class="oe_inline"/>
								<div>
									<group>
										<field name="min_exp_year" 
										       attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('is_tag_user','=',True),('rcm_check','=',True)]}"/>
										<field name="max_exp_year"
										       attrs="{'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': ['|',('is_tag_user','=',True),('rcm_check','=',True)]}"/>
									</group>
								</div>
								<field name="dept_planned_budget" attrs="{'invisible':[('type_project','=','work')]}" readonly='1' force_save='1'/>
								<field name="dept_remaining_budget" string="Dpt. Remaining Budget (TP-TI)" readonly='1' attrs="{'invisible':[('type_project','=','work')]}" force_save='1'/>
								<field name="max_sal" string="Salary Budget per Month" force_save='1'
									   attrs="{'invisible':[('state','=','draft')],'readonly':['|','|','|',('rcm_check','=',False),('is_tag_user','=',True),('hod_check','=',True),('is_report_manager','=',True)],'required': True}"/>
								<field name="avg_replacement_sal" readonly='1' attrs="{'invisible':[('resource','=','new')]}"/>
								<field name="extra_load_on_budget" string="Extra Load on Budget"
									   readonly="1" force_save="1" invisible="1"/>
								<field name="description" readonly="1"/>

							</group>
						</group>
						
					</sheet>
					<group>
						<div class="oe_chatter">
							<field name="message_follower_ids" widget="mail_followers"/>
							<field name="activity_ids" widget="mail_activity"/>
							<field name="message_ids" widget="mail_thread"/>
						</div>
					</group>
				</form>
			</field>
		</record>

		<!-- Form view for approve actions -->
		<record id="view_kw_mrf_approve_actions_form" model="ir.ui.view">
			<field name="name">view.model.form</field>
			<field name="model">kw_recruitment_requisition</field>
			<field name="type">form</field>
			<field name="mode">primary</field>
			<field name="priority">999</field>
			<field name="arch" type="xml">
				<form string="Manpower Requisition" create="false" import="false" edit="false">
					<header>
						<!-- <button name="send_for_approval" type="object" string="Send for Approval" class="oe_highlight" states="draft" /> -->
						<button name="action_approved_forward" type="object" string="Approve &amp; Forward"
						        class="btn btn-success"
						        attrs="{'invisible':['|','|',('user_inv','=',True),('state','not in',['sent','hold',]),('is_final_approver','=', True)]}"/>

						<button name="action_approved" type="object" string="Approve" class="oe_highlight"
						        attrs="{'invisible':['|',('is_final_approver','=', False),('state','in',['approve','reject'])]}"/>


						<button name="action_hold" type="object" string="Hold"
						        attrs="{'invisible':['|','|',('user_inv','=',True),('state','not in',['sent']),('is_final_approver','=', True)]}"
						        class="btn-warning"/>

						<button name="action_hold" type="object" string="Hold"
						        attrs="{'invisible':['|',('is_final_approver','=', False),('state','in',['approve','hold','reject'])]}"
						        class="btn-warning"/>

						<button name="action_reject" type="object" string="Decline"
						        attrs="{'invisible':['|','|',('user_inv','=',True),('state','not in',['sent','hold']),('is_final_approver','=', True)]}"
						        class="btn-danger"/>
						<button name="action_reject" type="object" string="Decline"
						        attrs="{'invisible':['|',('is_final_approver','=', False),('state','in',['approve','reject'])]}"
						        class="btn-danger"/>

						<button name="action_create_job" type="object" string="Create Job" class="oe_highlight"
						        states="approve" groups="hr_recruitment.group_hr_recruitment_manager"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,sent,approve,reject"/>
						<field name="user_inv" invisible="1"/>
						<field name="is_final_approver" invisible="1"/>
						<field name="forwarded" invisible="1"/>
					</header>
					<sheet>
						<group>
							<group string="General Requirement">
								<field name="rcm_check" invisible="1"/>
								<field name="hod_check" invisible="1"/>
								<field name="is_tag_user" invisible="1"/>
								<field name="last_approver_ids" invisible="1"/>
								<field name="current_user" invisible="1"/>
								<field name="hide_sal" invisible="1"/>
								<field name="code" string="Reference No."/>
								<field name="req_raised_by" readonly="1"/>
								<field name="req_raised_by_id" invisible="1"/>
								<field name="dept_name" options="{'no_open': True,'no_create':True,'no_edit':True}"
										attrs="{'readonly':[('rcm_check','=',False)]}"
								       readonly="1"/>
								<field name="approver_id"
								       attrs="{'readonly':[('rcm_check','=',False)],'required': True}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}" readonly="1"/>

								<field name="approver_field" invisible="1"/>
								<field name="requisition_type" string="Budget Type"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="type_project"
								       attrs="{'invisible':['|','&amp;',('requisition_type','=',False),('type_project','=',False),('requisition_type','=','treasury')],'required': [('requisition_type','=', 'project')],'readonly':[('state','in',['approve','reject'])],}"/>
								<field name="project"
								       attrs="{'invisible':['|','&amp;',('requisition_type','=',False),('project','=',False),('requisition_type','=','treasury')],'required': [('requisition_type','=', 'project')],'readonly':[('state','in',['approve','reject'])],}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"/>

								<field name="duration"
								       attrs="{'invisible':['|','&amp;',('requisition_type','=',False),('duration','=',False),('requisition_type','=','treasury')],'required': [('requisition_type','=', 'project')],'readonly':[('state','in',['approve','reject'])],}"/>
								<field name="name_of_business" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'invisible':['|','&amp;',('requisition_type','=',False),('name_of_business','=',False),('requisition_type','=','treasury')],'required': [('requisition_type','=', 'project')],'readonly':[('state','in',['approve','reject'])],}"
								       />
							</group>
							<group string="Details">
								<field name="branch_id" options="{'no_open': True,'no_edit':True}"
								       widget="many2many_tags"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="resource" string="Resource Type"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>

								<field name="employee_id"
								       attrs="{'invisible':['|','&amp;',('resource','=',False),('employee_id','=',False),('resource','=','new')],'required':[('resource','!=','new')],'readonly':[('state','in',['approve','reject'])],}"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       widget="many2many_tags" string="Replacement for"/>
								<field name="type_employment"
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       invisible="1"/>
								
								<field name="role_id" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="categ_id" options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
							</group>
						</group>
						<group>
							<group string="Requisition Details">
								<field name="job_position" string='Position'
								       options="{'no_open': True,'no_create':True,'no_edit':True}"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="date_requisition"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="no_of_resource" force_save='1'
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="skill_set"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="qualification"
								       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
								<field name="technology"
								       attrs="{'readonly':[('state','in',['approve','reject'])]}"
									   options="{'no_open': True,'no_edit':True}" invisible="0"/>
									   
							</group>
							<group string="Experience">

								<label for="experience" class="oe_inline"/>
								<div>
									<group>
										<field name="min_exp_year"
										       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
										<field name="max_exp_year"
										       attrs="{'readonly':[('state','in',['approve','reject'])],'required': True}"/>
									</group>
								</div>
								<field name="dept_planned_budget" attrs="{'invisible':[('type_project','=','work')]}" force_save='1'/>
								<field name="dept_remaining_budget" string="Dpt. Remaining Budget (TP-TI)" readonly='1' attrs="{'invisible':[('type_project','=','work')]}" force_save='1'/>
								<field name="max_sal" string="Salary per Month"
										       attrs="{'readonly':[('state','in',['approve','reject'])], 'required': [('hide_sal','=',False)], 'invisible':[('state','=','draft')]}"/>
								<field name="avg_replacement_sal" readonly='1' attrs="{'invisible':['|',('state','=','draft'),('resource','=','new')]}"/>
								<field name="description" attrs="{'readonly':[('state','not in',['draft','sent'])]}"/>
							</group>
						</group>

					</sheet>
					<group name="hide_chatter_mrf" attrs="{'invisible':[('hide_sal','=',True)]}">
						<div class="oe_chatter">
							<field name="message_follower_ids" widget="mail_followers"/>
							<field name="activity_ids" widget="mail_activity"/>
							<field name="message_ids" widget="mail_thread"/>
						</div>
					</group>
				</form>
			</field>
		</record>


		<!-- Act window for pending actions view -->

		<record id="kw_mrf_rcm_checkpoint_act_window" model="ir.actions.act_window">
			<field name="type">ir.actions.act_window</field>
			<field name="name">Take Action</field>
			<field name="res_model">kw_recruitment_requisition</field>
			<field name="view_mode">tree</field>
			<field name="domain">[('state','in',['sent'])]</field>
			<field name="context">{'manpower_requisition_context':True}</field>
			<field name="view_type">form</field>
			<field name="view_ids" eval="[(5, 0, 0),
		(0, 0, {'view_mode': 'tree', 'view_id': ref('view_kw_mrf_rcm_checkpoint_tree')}),
		(0, 0, {'view_mode': 'form', 'view_id': ref('view_kw_mrf_rcm_checkpoint_form')})]"/>

			<field name="help" type="html">
				<p class="o_view_nocontent_smiling_face">
					No pending request found..
				</p>
			</field>
		</record>

		<record id="kw_mrf_approved_act_window" model="ir.actions.act_window">
			<field name="type">ir.actions.act_window</field>
			<field name="name">Approved MRF</field>
			<field name="res_model">kw_recruitment_requisition</field>
			<field name="view_mode">tree,form</field>
			<field name="domain">[('state','in',['forward'])]</field>
			<field name="context">{'create': False,'edit':False,'delete':False, 'import': False,'manpower_requisition_context':True}</field>
			<field name="view_type">form</field>
			<field name="view_ids" eval="[(5, 0, 0),
		(0, 0, {'view_mode': 'tree', 'view_id': ref('view_kw_mrf_approve_action_tree')}),
		(0, 0, {'view_mode': 'form', 'view_id': ref('view_kw_mrf_approve_actions_form')})]"/>

			<!-- <field name="view_id" ref="view_kw_mrf_tree"/> -->
			<field name="help" type="html">
				<p class="o_view_nocontent_smiling_face">
					No pending request found..
				</p>
			</field>
		</record>
		<!-- MRFs parent menu -->
		<menuitem parent="hr_recruitment.menu_hr_recruitment_root"
		          id="menu_kw_mrf_view"
		          name="MRF"
		          sequence="99"
		          groups="group_kw_mrf_user,base.group_user,kw_recruitment.group_kw_mrf_report_manager"
		/>
		<!-- MRF All Requests -->
		<record id="menu_kw_mrf_view_server_action" model="ir.actions.server">
            <field name="name">All MRF</field>
            <field name="condition">True</field>
            <field name="model_id" ref="kw_recruitment.model_kw_recruitment_requisition"/>
            <field name="state">code</field>
            <field name="code">action = model.action_redirect_mrf_all_view()</field>
        </record>
		<menuitem id="kw_all_mrf_menu"
		          name="All MRF"
		          sequence="2"
		          parent="menu_kw_mrf_view"
				  action="menu_kw_mrf_view_server_action"
		          groups="group_kw_mrf_user,hr_recruitment.group_hr_recruitment_manager,kw_recruitment.group_kw_mrf_report_manager"/>
		          <!-- action="kw_mrf_act_window" -->
		
		<!--  MRF take action-->
		<record id="menu_kw_mrf_takeaction_view_server_action" model="ir.actions.server">
            <field name="name">Take Action</field>
            <field name="condition">True</field>
            <field name="model_id" ref="kw_recruitment.model_kw_recruitment_requisition"/>
            <field name="state">code</field>
            <field name="code">action = model.action_redirect_mrf_takeaction_view()</field>
        </record>

		<menuitem id="kw_mrf_pending_menu"
		          name="Take Action"
		          sequence="1"
		          parent="menu_kw_mrf_view"
		          action="menu_kw_mrf_takeaction_view_server_action"
		          groups="group_kw_mrf_user,hr_recruitment.group_hr_recruitment_manager"/>
		          <!-- action="kw_mrf_rcm_checkpoint_act_window" -->
		
		<record id="menu_kw_approved_mrf_view_server_action" model="ir.actions.server">
            <field name="name">Approved MRF</field>
            <field name="condition">True</field>
            <field name="model_id" ref="kw_recruitment.model_kw_recruitment_requisition"/>
            <field name="state">code</field>
            <field name="code">action = model.action_redirect_approved_mrf_view()</field>
        </record>

		<menuitem id="kw_mrf_approve_menu"
		          name="Approved MRF"
		          sequence="3"
		          parent="menu_kw_mrf_view"
				  action="menu_kw_approved_mrf_view_server_action"
		          groups="kw_recruitment.group_hr_recruitment_accounts,hr_recruitment.group_hr_recruitment_manager,kw_recruitment.group_tag_budget_user"/>
		          <!-- action="kw_mrf_approved_act_window" -->

		<record id="hr_recruitment.menu_hr_recruitment_root" model="ir.ui.menu">
			<field name="groups_id" eval="[(4,ref('group_kw_mrf_user')),(4,ref('group_hr_recruitment_accounts')),(4,ref('kw_recruitment.group_kw_mrf_report_manager'))]"/>
		</record>
		<menuitem name="Employee Roles"
		          id="kw_recruitment_emp_role"
		          parent="hr_recruitment.menu_hr_recruitment_configuration"
		          action="kw_employee.kwemp_work_role_action"
		          sequence="10"/>
	</data>
</odoo>
