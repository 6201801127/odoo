<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<template id="kw_consultancy_job_list" name="Job List">
		<t t-call="website.layout">
			<div class='container'>

				<div class="job-listing">
					<h3 class="mb-5">
						Recent Openings
					</h3>
					<t t-if="jobs">
						<div class="row">
							<div class="jobs-content">
								<table border="1" class="table table-bordered table-hover table-striped">
									<thead>
										<tr>
											<th scope="col" class="col-sm-1">Sl#</th>
											<th scope="col" class="col-sm-2">Job Position</th>
											<th scope="col" class="col-sm-2">Job Code</th>
											<th scope="col" class="col-sm-2">Qualification</th>
											<th scope="col" class="col-sm-2">Min Years(exp)</th>
											<th scope="col" class="col-sm-2">Max Years(exp)</th>
											<th scope="col" class="col-sm-2">Job Location</th>
											<th scope="col" class="col-sm-3">Details</th>
										</tr>
									</thead>
									<tbody>
									<t t-set="index" t-value="1"/>
									<t t-foreach='jobs' t-as='job'>
										<tr>
											<td class="text-left font-weight-bold" t-esc="index"> 
											</td>
											<td>
												<a class="text-info"
													t-attf-href="/c/job-details?{{keep_query(job_id=job.id)}}">
													<t t-esc='job.title'/>
												</a>
											</td>
											<td>
												<t t-if='job.job_code'>
													<t t-esc='job.job_code'/>
												</t>
											</td>
											<td>
												<t t-if='job.qualification'>

													<t t-esc="', '.join(job.qualification.mapped('name')) or 'N/A'"/>
												</t>
											</td>
											<td>
												<t t-if='job.min_exp_year'>
													<t t-esc='job.min_exp_year'/>
												</t>
											</td>
											
											<td>
												<t t-if='job.max_exp_year'>
													<t t-esc='job.max_exp_year'/>
												</t>
											</td>
											<td>
												<t t-if='job.address_id'>
													<t t-esc="', '.join(job.address_id.mapped('name')) or 'N/A'"/>
												</t>
											</td>
											<td>
												<a t-attf-href="/c/applicants?{{keep_query(job_id=job.id)}}"
													class="btn btn-info btn-sm">
													<span class="fa fa-user-o mx-2"/>
													<span t-esc='applicants_counts.get(job.id,0)' class="mr-1"/>
													Applicants
												</a> 
											</td>
											<t t-set="index" t-value="index+1" />
										</tr>
									</t>
									</tbody>
								</table>
							</div>
						</div>
							<!-- <t t-set="count" t-value="0" />
							<t t-foreach='jobs' t-as='job'>
								<div class="col-12 col-md-4 d-flex mb-lg-1">
									<div class="card applicant-card mb-4 w-100">
										<div class="card-body">
											<div class="applicant-content">
												<h5 class="mb-3">
													<a class="text-info"
													   t-attf-href="/c/job-details?{{keep_query(job_id=job.id)}}">
														<t t-esc='job.title'/>
														<small>(<t t-esc='job.job_code'/>)
														</small>
													</a>
												</h5>
												<div class="mb-2">
													<span class="fa fa-map-marker mr-2"/>
													<t t-esc="', '.join(job.address_id.mapped('name')) or 'N/A'"/>
												</div> -->
												<!-- <div class="mb-2">
													<span class="fa fa-clock-o mr-2"/>
													<t t-esc='job.expiration.strftime("%d-%b-%Y")'/>
												</div> -->
												<!-- <a t-attf-href="/c/applicants?{{keep_query(job_id=job.id)}}"
												   class="btn btn-info btn-sm px-3 mt-3">
													<span class="fa fa-user-o mx-2"/>
													<span t-esc='applicants_counts.get(job.id,0)' class="mr-1"/>
													Applicants
												</a> -->
											<!-- </div>
										</div>
									</div>
								</div>
								<t t-set="count" t-value="count + 1" />
							</t> -->
						
					</t>
					<t t-else="">
						<div class="no-data">
							<p>No Jobs Openings Available</p>
						</div>
					</t>
				</div>
			</div>
		</t>
	</template>
	<template id='kw_consultancy_job_details' name='Job Details'>
		<t t-call="website.layout">
			<div class='container'>
				<div class="application-tab">
					<div class="d-flex">
						<h3 class="flex-grow-1">
							<t t-esc="job.title"/>
							<small>
								(<t t-esc="job.job_code"/>)
							</small>
						</h3>
						<a class="btn btn-info ml-4 pull-right" t-attf-href="/c/applicants?{{keep_query(job_id=job.id)}}">
							View Applicants
						</a>
						<a class="btn btn-info ml-4 pull-right" href="/c/job-openings">
							<span class="fa fa-arrow-circle-left mr-1"/>
							Go Back
						</a>
					</div>
					<div class="job-application-form">
						<div class="row">
							<div class="col-12">
								<div class="card p-5">
									<div class="mb-2">
										<h5 class="font-weight-bold">Job Description</h5>
									</div>
									<div class="">
										<div class="job-info">
											<span class="job-icon">
												<i class="fa fa-map-marker"/>
											</span>
											<span>
												<t t-esc="', '.join(job.address_id.mapped('name')) or 'N/A'"/>
											</span>
										</div>
										<div class="job-info">
											<span class="job-icon">
												<i class="fa fa-clock-o"/>
												<span class="ml-2">Experience:</span>
											</span>
											<span>
												<t t-esc="job.min_exp_year"/>
												to
												<t t-esc="job.max_exp_year"/>
												years
											</span>
										</div>
									</div>

									<div class="job-description">
										<div class="news__item">
											<h5 class="font-weight-bold mb-3">Job Profile</h5>
											<div class="new-jobdata">
												<t t-raw="job.description"/>
											</div>
											<br/>
											<h5 class="font-weight-bold mb-3">Candidate Profile</h5>
											<div class="new-jobdata">
												<t t-raw="job.candidate_profile"/>
											</div>
											<h5 class="font-weight-bold mt-3">Qualification:
												<span t-esc="' / '.join(map(lambda x: ( x.name), job.qualification))"
												      class="font-weight-normal"/>
											</h5>
										</div>

									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</t>
	</template>
</odoo>
