<?xml version="1.0"?>
<odoo>
    <data noupdate="0">
        
         <!-- Mail to IT and Admin Authorities -->
         <record id="kw_meeting_calendar_template_meeting_invitation_to_authorities_zoom" model="mail.template">
            <field name="name">Calendar: Meeting Invitation to Authorities</field>
            <field name="model_id" ref="kw_meeting_schedule.model_kw_meeting_events"/>
            <field name="subject">Meeting Scheduled for ${object.name} by ${object.user_id.name} | ${object.display_time}</field>
            <field name="email_from">${object.create_uid.email}</field>
            <field name="email_to" >${object.get_authority_group_users_email() or ''}</field>
            <field name="body_html" type="html">
	            <span>
					<table border="0">
						<tr>
							<td>
								<div style="margin-left: 1.2rem;">
									<h5 style="font-weight: 400;margin-bottom: 0;font-size: 18px;color:#676767;">
										<span style="color:rgb(22, 123, 158);font-size: 18px;margin-right: 2px;font-weight: 600;">Dear </span>
										All,
									</h5>
									<p style="color: #676767;line-height: 145%;margin: 10px 0 0 0;font-size: 17px;">
									${object.user_id.partner_id.name} scheduled a meeting for the ${object.name}. You are requested to look after the facilities for the event to be successful.
									</p>
								</div>
							</td>
						</tr>
						<tr>
							<td>
								<div style="margin:0 20px;padding:20px 0 0px 0;">
									<h2 style="font-size: 2rem;font-weight: unset;color: #444141;">
										Meeting Details
									</h2>
								</div>

								<table border="0" style="border-collapse: collapse;font-size: 16px;">
									% if object.meeting_room_id:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											Where
										</td>
										<td style="color:#167b9e;height: 50px;">
		                                    % if object.meeting_room_id:
		                                          ${object.meeting_room_id.name}
													% if object.meeting_room_id.floor_name:
														(${object.meeting_room_id.floor_name})
													% endif
		                                    % else:
		                                          Virtual
		                                    % endif
		                                </td>
									</tr>
									% endif

									% if not object.recurrency:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											When
										</td>
										<td style="color:#167b9e;height: 50px;">
											${object.get_interval('dayname', tz=object.partner_id.tz if not object.allday else None)}
											${object.get_interval('day', tz=object.partner_id.tz if not object.allday else None)}
											${object.get_interval('month', tz=object.partner_id.tz if not object.allday else None)},
											At:
											${not object.allday and object.get_interval('time', tz=object.partner_id.tz) or ''}
										</td>
									</tr>
									% endif

									% if object.agenda_ids:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											Agenda
										</td>

										<td style="color:#167b9e;height: 50px;">
											
											% for agenda in object.agenda_ids:
												<li>${agenda.name}</li>
											% endfor
											
										</td>
									</tr>
									% endif

									% if object.description:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											Required Information
										</td>
										<td style="color:#167b9e;height: 50px;">
											${object.description or 'NA'}
										</td>
									</tr>
									% endif

									% if object.recurrency:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											Meeting Date
										</td>
										<td style="color:#167b9e;height: 50px;">
											<ul style="list-style-type:disc">
												% for recurring_event in object.child_ids:
													<li>${recurring_event.display_time}</li>
												% endfor
											</ul>
										</td>
									</tr>
									% endif

									% if not object.allday and object.duration:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											Duration
										</td>
										<td style="color:#167b9e;height: 50px;">
											 ${('%dH:%dM' % (object.duration,(object.duration*60)%60))}
										</td>
									</tr>
									% endif

									% if object.mom_required:
									<tr>
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											MoM Controller
										</td>
										<td style="color:#167b9e;height: 50px;">
											${object.mom_controller_id.name}
										</td>
									</tr>
									% endif

									<tr t-if="object.attendee_ids">
										<td style="padding-left: 20px;height: 50px;"
										    width="200px">
											Attendees
										</td>
										<td style="color:#167b9e;height: 50px;">
											% for attendee in object.attendee_ids:
		                                          ${attendee.common_name},
											% endfor
										</td>
									</tr>

									 % if object.external_attendee_ids:
									<tr>
										<td style="padding-left: 20px;height: 50px;vertical-align: text-top;"
										    width="200px">
											External Participants
										</td>
										<td style="color:#167b9e;height: 50px;">
											% for ext_attendee in object.external_attendee_ids:
												 ${ext_attendee.partner_id.name} ${ext_attendee.partner_id.mobile_no},
											% endfor
										</td>
									</tr>
									% endif
								</table>
							</td>

						</tr>
						<tr>
							<td>
								<div style="margin:0 20px;padding:20px 0 0px 0;">
									<p>Thank You.</p>
									% if object.user_id and object.user_id.signature:
										<p>${object.user_id.signature | safe}</p>
									% endif
									</div>
								</td>
							</tr>
					</table>
				
	            </span>
	            </field>
            <field name="auto_delete" eval="False"/>
            <field name="user_signature" eval="False"/>
        </record>
    </data>
</odoo>
