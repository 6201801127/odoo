<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="cr_management_report_form" model="ir.ui.view">
            <field name="name">cr_management_report_form</field>
            <field name="model">cr_management_report</field>
            <field name="arch" type="xml">
                <form string="" edit='0' create='0'>
                    <sheet>
                        <group>

                            <group>
                                <field name="reference_no"/>
                                <field name="project_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="project_code"/>
                                <field name="url_or_service_name"/>
                                <field name="module_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="environment_name"/>
                                <field name="description"/>
                                <field name="state"/>
                            </group>
                            <group>
                                <field name="employee_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="uploaded_by" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="estimate_activity_hour"/>
                                <field name="duration"/>
                                <field name="change_impact"/>
                                <!-- <field name="roll_back" options="{'no_open': True,'no_create':True,'no_edit':True}"/> -->
                                <field name="cr_type"/>
                                <field name="cr_raised_on"/>
                                <field name="cr_uploaded_on"/>
                                <field name="cr_rollbacked_on"/>
                                <field name="cr_cancelled_on"/>
                                <field name="request_rollbacked_on"/>
                                <field name="cr_rejected_on"/>
                                <field name="cr_holded_on"/>
                                <field name="state" invisible="1"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="cr_management_report_tree" model="ir.ui.view">
            <field name="name">cr_management_report.tree</field>
            <field name="model">cr_management_report</field>
            <field name="arch" type="xml">
                <tree create='0' edit='0' delete='0'>
                    <!--                    <field name="id" string="Sl.No"/>-->
                    <!-- <field name="date"/> -->
                    <!-- <field name="date_time"/> -->
                    <field name="reference_no"/>
                    <field name="project_id"/>
                    <field name="project_code"/>
                    <field name="sr_activity"/>
                    <field name="url_or_service_name"/>
                    <field name="module_id"/>
                    <!-- <field name="environment_id" invisible = '1'/> -->
                    <field name="environment_name"/>
                    <field name="platform_id" invisible="context.get('cr_type', False)!='CR'"/>
                    <field name="description"/>
                    <field name="state"/>
                    <field name="employee_id"/>
                    <field name="uploaded_by"/>
                    <field name="estimate_activity_hour"/>
                    <field name="duration"/>
                    <field name="change_impact"/>
                    <!-- <field name="roll_back"/> -->
                    <field name="cr_type"/>
                    <field name="cr_raised_on"/>
                    <field name="cr_uploaded_on"/>
                    <field name="cr_rollbacked_on"/>
                    <field name="state" invisible="1"/>
                </tree>
            </field>
        </record>

        <record id="cr_management_report_search_view" model="ir.ui.view">
            <field name="name">cr_management_report_search_view</field>
            <field name="model">cr_management_report</field>
            <field name="arch" type="xml">
                <search>
                    <field name="project_id"/>
                    <field name="project_code"/>
                    <field name="cr_type"/>
                    <field name="module_id"/>
                    <field name="url_or_service_name"/>
                    <field name="description"/>
                    <field name="reference_no"/>
                    <!-- <field name="create_date"/> -->
                    <field name="state" invisible="1"/>
                    <!-- <filter string="This month" domain="[('create_date', 'like',context_today().strftime('%m'))]" name="current_month_cr"/> -->
                    <filter string="Applied" name="state_applied" domain="[('state','=','Applied')]"/>
                    <filter string="Uploaded" name="state_uploaded" domain="[('state','=','Uploaded')]"/>
                    <filter string="Rollback" name="state_rollbacked" domain="[('state','=','Rollbacked')]"/>
                    <filter string="Request For Rollback" name="state_request" domain="[('state','=','Request')]"/>
                    <filter string="Rejected" name="state_reject" domain="[('state','=','Reject')]"/>
                    <filter string="Hold" name="state_hold" domain="[('state','=','Hold')]"/>
                    <filter string="Applied Date" name="filter_date" date='date' default_period="this_month"/>
                </search>
            </field>
        </record>

        <!-- kw_contract_end_log action window -->
        <!-- <record id="cr_management_report_action" model="ir.actions.act_window">
            <field name="name">CR Report</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">cr_management_report</field>
            <field name="view_mode">tree</field>
            <field name="view_type">form</field>
            <field name="context">{}</field>

        </record> -->
        <record model="ir.ui.view" id="env_project_pivot">
            <field name="name">environment_project_pivot</field>
            <field name="model">cr_management_report</field>
            <field name="arch" type="xml">
                <pivot>
                    <field name="project_id" type="row"/>
                    <field name="environment_name" type="col"/>
                    <field name="cr_type" type="col"/>
                </pivot>
            </field>
       </record>

        <record id="cr_management_report_action" model="ir.actions.server">
            <field name="name">CR Report</field>
            <field name="model_id" ref="model_cr_management_report"/>
            <field name="state">code</field>
            <field name="context">{'search_default_current_month_cr':1,}</field>
            <field name="context">{'type':'cr'}</field>
            <field name="code">action = model.report_project_tagged_employees('cr')</field>
        </record>

        <menuitem id="cr_management_reports_menu"
                  name="CR Report"
                  parent="menu_report_root"
                  action="cr_management_report_action"
                  sequence="2"
                  groups="change_request_management.group_cr_mis_user,change_request_management.group_cr_manager,change_request_management.group_cr_officer,change_request_management.group_cr_user,change_request_management.group_cr_test_lead"/>

        <record model="ir.ui.view" id="sr_env_project_pivot">
            <field name="name">SR_environment_project_pivot</field>
            <field name="model">cr_management_report</field>
            <field name="arch" type="xml">
                <pivot>
                    <field name="environment_name" type="row"/>
                    <field name="project_id" type="col"/>
                </pivot>
            </field>
       </record>

        <record id="sr_management_report_action" model="ir.actions.server">
            <field name="name">SR Report</field>
            <field name="model_id" ref="model_cr_management_report"/>
            <field name="state">code</field>
            <field name="context">{'type':'sr'}</field>
            <field name="code">action = model.report_project_tagged_employees('sr')</field>
        </record>

        <menuitem id="sr_management_reports_menu"
                  name="SR Report"
                  parent="menu_report_root"
                  action="sr_management_report_action"
                  sequence="3"
                  groups="change_request_management.group_cr_mis_user,change_request_management.group_cr_manager,change_request_management.group_cr_officer,change_request_management.group_cr_test_lead,change_request_management.group_cr_user"/>


    </data>
</odoo>