<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="task_management_report_form" model="ir.ui.view">
            <field name="name">task_management_report_form</field>
            <field name="model">task_management_report</field>
            <field name="arch" type="xml">
                <form string="" edit='0' create='0'>
                    <sheet>
                        <div>
                            <h2>
                                <field name="ticket_no" readonly='1'/>
                            </h2>
                        </div>
                        <group>
                            <group>
                                <field name="assign_task_date"/>
                                <field name="assigned_to" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
<!--                                <field name="ticket_no"/>-->
                                <field name="description_of_task"/>
                                <field name="actual_time_to_resolve"/>
                                <field name="working_time_spent" widget="float_time"/>
                                <field name="target_time" widget="float_time"/>
                                <field name="deviation_time" widget="float_time"/>
                                <field name="details_of_acceptance"/>
                                <field name="reported_start_bool" invisible='1'/>
                            </group>
                            <!-- <group>
                                <field name="employee_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="uploaded_by" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="duration"/>
                                <field name="roll_back" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="cr_type"/>
                                <field name="cr_raised_on"/>
                                <field name="cr_uploaded_on"/>
                                <field name="cr_rollbacked_on"/>
                                <field name="cr_cancelled_on"/>
                                <field name="request_rollbacked_on"/>
                                <field name="cr_rejected_on"/>
                                <field name="cr_holded_on"/>
                                <field name="state" invisible="1"/>
                            </group> -->
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="task_management_report_tree" model="ir.ui.view">
            <field name="name">task_management_report.tree</field>
            <field name="model">task_management_report</field>
            <field name="arch" type="xml">
                <tree create='0' edit='0' delete='0' import='0'>
                    
                    <field name="ticket_no"/>
                    <field name="assign_task_date"/>
                    <field name="assigned_to"/>
                    <field name="assigned_by"/>
                    <field name="description_of_task"/>
                    <field name="actual_time_to_resolve"/>
                    <field name="target_time" widget="float_time"/>
                    <field name="working_time_spent" widget="float_time"/>
                    <field name="deviation_time" widget="float_time"/>
                    <field name="details_of_acceptance"/>
                    <!-- <field name="task_raised_by"/> -->
        
                </tree>
            </field>
        </record>

        <record id="task_management_report_search_view" model="ir.ui.view">
            <field name="name">task_management_report_search_view</field>
            <field name="model">task_management_report</field>
            <field name="arch" type="xml">
                <!-- <search>
                    <field name="assign_task_date"/>
                    <field name="assigned_to"/>
                    <field name="ticket_no"/>
                    <field name="description_of_task"/>
                    <field name="actual_time_to_resolve"/>
                    <field name="working_time_spent" widget="float_time"/>
                    
                    <field name="target_time"/>
                    <field name="deviation_time" widget="float_time"/>
                    <field name="details_of_acceptance"/>
                    <filter string="Date" name="filter_raise_date" date="actual_time_to_resolve"/>
                    
                </search> -->
                <search>
                    <field name="assign_task_date"/>
                    <field name="assigned_to"/>
                    <field name="ticket_no"/>
                    <field name="description_of_task"/>
                    <field name="actual_time_to_resolve"/>
                    <field name="working_time_spent" widget="float_time"/>
                    <field name="target_time"/>
                    <field name="deviation_time" widget="float_time"/>
                    <field name="details_of_acceptance"/>
                    <!-- <filter string="Date" name="filter_raise_date" date="actual_time_to_resolve"/> -->

                    <filter string="This Year" domain="[('task_assign_year', '=',context_today().strftime('%Y'))]" name="current_year_task"/>
                    <filter string="Last Year" domain="[('task_assign_year', '=',(context_today()-relativedelta(years=1)).strftime('%Y'))]" name="last_year_task"/>  


                    <separator/>

                    <filter string="This Month" domain="[('month_number','&gt;',(context_today()-relativedelta(months=1)).strftime('%Y-%m-01')),('month_number','&lt;',(context_today()+relativedelta(months=1)).strftime('%Y-%m-01'))]" name="current_month_task"/>
              
                    <filter string="Last Month" domain="[('month_number','&gt;',(context_today()-relativedelta(months=2)).strftime('%Y-%m-01')),('month_number','&lt;',(context_today()).strftime('%Y-%m-01'))]" name="last_month_task"/>
                    <separator/>
                    
                    <filter string="January" domain="[('month_index','=',1)]" name="january_task"/>
                    <filter string="February" domain="[('month_index','=',2)]" name="february_task"/>
                    <filter string="March" domain="[('month_index','=',3)]" name="march_task"/>
                    <filter string="April" domain="[('month_index','=',4)]" name="april_task"/>
                    <filter string="May" domain="[('month_index','=',5)]" name="may_task"/>
                    <filter string="June" domain="[('month_index','=',6)]" name="june_task"/>
                    <filter string="July" domain="[('month_index','=',7)]" name="july_task"/>
                    <filter string="August" domain="[('month_index','=',8)]" name="august_task"/>
                    <filter string="September" domain="[('month_index','=',9)]" name="september_task"/>
                    <filter string="October" domain="[('month_index','=',10)]" name="october_task"/>
                    <filter string="November" domain="[('month_index','=',11)]" name="november_task"/>
                    <filter string="December" domain="[('month_index','=',12)]" name="december_task"/>
                    <separator/>
                </search>
            </field>
        </record>

        <!-- <record id="task_management_report_action" model="ir.actions.act_window">
            <field name="name">Task Management Report</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">task_management_report</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="context">{'search_default_current_month_task':1,}</field>

        </record> -->

        <record id="task_management_report_action" model="ir.actions.server">
            <field name="name">Task Management Report</field>
            <field name="model_id" ref="model_task_management_report"/>
            <field name="state">code</field>
            <field name="context">{}</field>
            <field name="code">action = model.report_task_management()</field>
        </record>
       
        <menuitem id="task_management_reports_menu"
                  name="Task Management Report"
                  parent="task_management_reports_root_menu"
                  action="task_management_report_action"
                  sequence="1"/>

    </data>
</odoo>