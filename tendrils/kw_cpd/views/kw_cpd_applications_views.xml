<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <record id="kw_cpd_application_apply_tree" model="ir.ui.view">
            <field name="name">kw_cpd_application_apply_tree</field>
            <field name="model">kw_cpd_applications</field>
            <field name="arch" type="xml">
                <tree class='cpd_applications_tree'>
                    <field name="employee_id"/>
                    <field name="institute_id"/>
                    <field name="course_id"/>
                    <field name="course_duration"/>
                    <field name="course_fee"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="kw_cpd_application_apply_form" model="ir.ui.view">
            <field name="name">kw_cpd_application_apply_form</field>
            <field name="model">kw_cpd_applications</field>
            <field name="arch" type="xml">
                <form duplicate='0' delete='0'>
                    <header>
                        <field name="state" widget="statusbar"/>
                        <button name="kw_cpd_apply_btn" string=" APPLY" type="object" class="fa fa-arrow-circle-right kw_cpd_green" attrs="{'invisible': [('show_user_apply_cpd_btn', '=', False)]}"/>
                        <button name="cpd_action_buttons" string=" APPROVE" type="object" class="fa fa-check kw_cpd_green" attrs="{'invisible': [('show_ra_approve_cpd_btn', '=', False)]}" context="{'ctx_val':'RA_APPROVAL','record':active_id}"/>
                        <button name="cpd_action_buttons" string=" APPROVE" type="object" class="fa fa-check kw_cpd_green" attrs="{'invisible': [('show_dh_approve_cpd_btn', '=', False)]}" context="{'ctx_val':'DH_APPROVAL'}"/>
                        <button name="cpd_action_buttons" string=" APPROVE" type="object" class="fa fa-check kw_cpd_green" attrs="{'invisible': [('show_lnk_approve_cpd_btn', '=', False)]}" context="{'ctx_val':'LNK_APPROVAL'}"/>
                        <button name="cpd_action_buttons" string=" APPROVE" type="object" class="fa fa-check kw_cpd_green" attrs="{'invisible': [('show_chro_approve_cpd_btn', '=', False)]}" context="{'ctx_val':'CHRO_APPROVAL'}"/>
                        <button name="cpd_action_buttons" string=" HOLD" type="object" class="fa fa-undo kw_cpd_orange" attrs="{'invisible': [('show_lnk_approve_cpd_btn', '=', False)]}" context="{'ctx_val':'LNK_HOLD'}"/>
                        <button name="cpd_action_buttons" string=" REJECT" type="object" class="fa fa-times reject_cpd" attrs="{'invisible': [('show_reject_button', '=', False)]}" context="{'ctx_val':'REJECTED'}"/>
                    </header>
                    <sheet>
                        <group>
                            <group string='Details'>
                                <field name="is_eligible" invisible="1"/>
                                <field name="is_user_department_head" invisible="1"/>
                                <field name="is_user_l_and_k_mngr" invisible="1"/>
                                <field name="show_user_apply_cpd_btn" invisible="1"/>
                                <field name="show_reject_button" invisible="1"/>
                                <field name="show_ra_approve_cpd_btn" invisible="1"/>
                                <field name="show_dh_approve_cpd_btn" invisible="1"/>
                                <field name="show_lnk_approve_cpd_btn" invisible="1"/>
                                <field name="show_chro_approve_cpd_btn" invisible="1"/>
                                <field name="employee_id" options="{'no_open': True, 'no_create': True, 'no_edit': True}"/>
                                <field name="institute_id" options="{'no_open': True, 'no_create': True, 'no_edit': True}" attrs="{'readonly': [('state', 'not in', [-1,0])]}"/>
                                <field name="course_id" options="{'no_open': True, 'no_create': True, 'no_edit': True}" attrs="{'readonly': [('state', 'not in', [-1,0])]}"/>
                                <field name="course_duration" attrs="{'readonly': [('state', 'not in', [-1,0])]}"/>
                                <field name="course_fee" attrs="{'readonly': [('state', 'not in', [-1,0])]}"/>
                                <field name="to_disburse_course_fee" readonly='1' force_save='1'/>
                                <field name="description" attrs="{'readonly': [('state', 'not in', [-1,0])]}"/>
                            </group>
                            <group string='Approval Logs'>
                                <div>
                                <field name="approval_log_ids" readonly='1' style="pointer-events:none;"/>
                                </div>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>







        <record id="kw_cpd_apply_act_window" model="ir.actions.act_window">
            <field name="name">Apply CPD</field>
            <field name="res_model">kw_cpd_applications</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="view_ids" eval="[(5, 0, 0),
                     (0, 0, {'view_mode': 'tree', 'view_id': ref('kw_cpd_application_apply_tree')}),
                     (0, 0, {'view_mode': 'form', 'view_id': ref('kw_cpd_application_apply_form')})]"/>
            <field name="context">{'delete':False,'import':False,'duplicate':False}</field>
            <field name="domain">['|', ('employee_id.user_id','=',uid), '&amp;',('employee_id.parent_id.user_id', '=', uid),('state','!=',0)]</field>
        </record>




        <record id="kw_cpd_ra_approvals_act_window" model="ir.actions.act_window">
            <field name="name">CPD Approvals</field>
            <field name="res_model">kw_cpd_applications</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="context">{'create': False,'edit':False,'delete':False,'import':False}</field>
            <field name="domain">['&amp;',('state','=',1),('employee_id.parent_id.user_id','=',uid)]</field>
        </record>
        <record id="kw_cpd_dh_approvals_act_window" model="ir.actions.act_window">
            <field name="name">CPD Approvals</field>
            <field name="res_model">kw_cpd_applications</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="context">{'create': False,'edit':False,'delete':False,'import':False}</field>
            <field name="domain">['&amp;',('state','=',2),('employee_id.department_id.manager_id.user_id','=',uid)]</field>
        </record>
        <record id="kw_cpd_lnk_approvals_act_window" model="ir.actions.act_window">
            <field name="name">CPD Approvals</field>
            <field name="res_model">kw_cpd_applications</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="domain">[('state','=',3)]</field>
            <field name="context">{'create': False,'edit':False,'delete':False,'import':False}</field>
        </record><record id="kw_cpd_chro_approvals_act_window" model="ir.actions.act_window">
            <field name="name">CPD Approvals</field>
            <field name="res_model">kw_cpd_applications</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="context">{'create': False,'edit':False,'delete':False,'import':False}</field>
            <field name="domain">[('state','=',4)]</field>
        </record>






        <record id="kw_cpd_approvals_server_window" model="ir.actions.server">
            <field name="name">CDP Approvals</field>
            <field name="model_id" ref="model_kw_cpd_applications"/>
            <field name="state">code</field>
            <field name="code">
                action = model.cpd_approval_server_action()
            </field>
        </record>

        <menuitem name="CPD" id="menu_kw_cpd" parent="main_menu_kw_cpd" sequence="1"/>
        <menuitem name="Apply" id="menu_kw_cpd_apply" parent="menu_kw_cpd" action="kw_cpd_apply_act_window" sequence="1"/>
        <menuitem name="Take Action" id="menu_kw_cpd_take_action" parent="menu_kw_cpd" action="kw_cpd_approvals_server_window" sequence="5"/>


    </data>
</odoo>
