<?xml version="1.0"?>
<odoo>

    <record id="kw_hr_leave_type_report_search_view" model="ir.ui.view">
        <field name="name">kw_hr_leave_type_report.filter</field>
        <field name="model">kw_hr_leave_type_report</field>
        <field name="arch" type="xml">
            <search string="Search Leave">
                <field name="employee_id" />
                <field name="designation" />
                <field name="department" />
                <field name="division" />
                <field name="section"/>
                <field name="holiday_status_id" string="Leave Type"/>
                <separator/>
                <filter string="Current Financial Year" name="current_financial_year" domain="[('current_financial_year','=',True)]"/>
                <filter string="Previous Financial Year" name="previous_financial_year" domain="[('previous_financial_year','=',True)]"/>
                <separator/>
                <filter string="My Requests" name="my_leaves" domain="[('employee_id.user_id', '=', uid)]"/>
                <separator/>
                <group expand="0" string="Group By">
                    <filter name="fisc_year" string="Year" context="{'group_by':'fisc_year'}"/>
                    <filter name="employee" string="Employee" context="{'group_by':'employee_id'}"/>
                    <filter name="group_type" string="Leave Type" context="{'group_by':'holiday_status_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <record id="kw_hr_leave_type_report_tree" model="ir.ui.view">
        <field name="name">kw_hr_leave_type_report.tree</field>
        <field name="model">kw_hr_leave_type_report</field>
        <field name="arch" type="xml">
            <tree default_order="type asc">
                <field name="employee_id" />
                <field name="designation" />
                <field name="department" />
                <field name="division" />
                <!-- <field name="section"/> -->
                <field name="holiday_status_id"/>
                <field name="type" invisible='1'/>
                <field name="entitle" attrs="{'invisible': ['|',('type','!=','allocation'),('lapse','&gt;',0)] }"/>
                <!-- <field name="taken" string="Leave" attrs="{'invisible': [('type','!=','request')] }"/> -->
                <field name="lapse" string="Lapse" attrs="{'invisible': ['|',('type','!=','allocation'),('lapse','&lt;=',0)]}"/>
                <!-- <field name="balance"/> -->
                <field name="no_of_days_applied" attrs="{'invisible': [('type','!=','request')] }"/>
                <field name="applied_date" />
                <field name="date_from" invisible='1'/>
                <field name="date_to" invisible='1'/>
                <field name="from_day_half" />
                <field name="to_day_half"/>
                <field name="no_of_days_approved" attrs="{'invisible': [('type','!=','request')] }"/>
                <field name="note_reason"/>
                <field name="action_taken_on"/>
            </tree>
        </field>
    </record>

    <record id="kw_hr_leave_type_report_form" model="ir.ui.view">
        <field name="name">kw_hr_leave_type_report.view.form</field>
        <field name="model">kw_hr_leave_type_report</field>
        <field name="arch" type="xml">
            <form create='false' edit='false' delete='false' duplicate='false'>
                <sheet>
                    <group>
                        <group>
                            <field name="employee_id"  options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                            <field name="designation" />
                            <field name="department" />
                            <field name="division" />
                            <field name="section"/>
                            <field name="holiday_status_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                            <field name="type" invisible='1'/>
                            <field name="entitle" attrs="{'invisible': [('type','!=','allocation')] }"/>
                            <field name="taken" string="Leave" attrs="{'invisible': [('type','!=','request')] }"/>
                            <field name="lapse" string="Lapse" attrs="{'invisible': ['|',('type','!=','allocation'),('lapse','&lt;=',0)]}"/>
                        </group>
                        <group>
                            <field name="no_of_days_applied" attrs="{'invisible': [('type','!=','request')] }"/>
                            <field name="applied_date" />
                            <field name="date_from" invisible='1'/>
                            <field name="date_to" invisible='1'/>
                            <field name="from_day_half" />
                            <field name="to_day_half"/>
                            <field name="note_reason"/>
                            <field name="action_taken_on"/>
                        </group>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="kw_hr_leave_type_report_pivot" model="ir.ui.view">
        <field name="name">view.kw_hr_leave_type_report.pivot</field>
        <field name="model">kw_hr_leave_type_report</field>
        <field name="arch" type="xml">
            <pivot string="Pivot Description">
                <field name="employee_id" type="row"/>
                <field name="holiday_status_id" type="col"/>
                <field name="entitle" type="measure"/>
                <field name="taken" type="measure"/>
                <field name="lapse" type="measure"/>
                <field name="balance" type="measure"/>
            </pivot>
        </field>
    </record>

    <record id="kw_hr_leave_type_report_actions" model="ir.actions.act_window">
        <field name="name">Leaves Entitlement Summary</field>
        <field name="res_model">kw_hr_leave_type_report</field>
        <field name="view_mode">pivot</field>
        <field name="view_id" eval="kw_hr_leave_type_report_tree"/>
        <field name="context">{
            'search_default_current_financial_year': 1 ,
            'create':False,'edit':False,'delete':False,'import':False,
            }</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create a new leave request
            </p>
        </field>
        <field name="domain"></field>
        <field name="search_view_id" ref="kw_hr_leave_type_report_search_view"/>
    </record>

    <menuitem id="kw_hr_leave_type_report_menu" name="Leave Entitlement Summary" parent="hr_holidays.menu_hr_holidays_report" action="kw_hr_leave_type_report_actions" sequence="11" groups="hr_holidays.group_hr_holidays_manager" />



</odoo>
