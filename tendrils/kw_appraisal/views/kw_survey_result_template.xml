<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data noupdate="0">
		<template id="no_result_found" name="Appraisal NO Answer">
			<t t-call="website.layout">
				<div class="container">
					<div class="jumbotron mt32 text-center">
						<div class="swal2-icon swal2-error swal2-animate-error-icon" style="display: flex;">
							<span class="swal2-x-mark">
								<span class="swal2-x-mark-line-left"></span>
								<span class="swal2-x-mark-line-right"></span>
							</span>
						</div>
						<h4 t-esc="self_employee_id"></h4>
						<h5 class="mt-2">
							Sorry, you may not complete your appraisal.
						</h5>
						<button onclick="window.history.go(-1);" class="btn btn-secondary">
							Back to Appraisal
						</button>
					</div>
				</div>
			</t>
		</template>
		<template id="kw_survey_print" name="Appraisal Results">
			<t t-call="website.layout">
				<div class="wrap mb-5">
					<div class="container">
						<div class="card mt-3">
							<div class="card-header text-uppercase font-weight-bold text-center white-text">
							Appraisal form
							</div>
							<div class="card-body">
								<div class="mt-2 mb-4">
									<div t-foreach='user_input' t-as='user_inputs' class="float-left logedin-user">
										<img t-attf-src="data:image_small/*;base64,{{user_inputs.appraisal_id.emp_id.image_small}}" />
										<div class="info">
											<p class="m-0 font-weight-bold h4">
												<span t-esc="user_inputs.appraisal_id.emp_id.name+ ' ('+ user_inputs.appraisal_id.emp_id.emp_code +')' " />
											</p>
											<p class="m-0 badge badge-pill badge-primary">
												<span t-esc='user_inputs.appraisal_id.emp_id.job_id.name' />
											</p>
										</div>

									</div>
									<button onclick="window.history.go(-1);" id='back' class="btn btn-secondary btn-md float-right">
                                        Back to Appraisal
									</button>
									<div class="clearfix" />
								</div>
								<div t-if="prev_goal">
									<h6 class="alert alert-info al text-dark">Goal Accomplishment : Please update the status of previous goals set by clicking against the appropriate milestones.</h6>
									<t t-foreach="prev_goal" t-as="goals">
										<div class="form-group">
											<label class="text-uppercase font-weight-bold" for="goal_name_vals">Goal :</label>
											<br />
											<span t-esc="goals.name" class="col-md-12" id="goal_name_vals" name="goal_name_vals" readonly="1" />
										</div>
										<div class="form-group row ml-0">
											<label class="text-uppercase font-weight-bold">Milestones :</label>
											<div t-foreach="goals.milestone_id" t-as="milestones" class="row col-sm-12" style="left: 1%;">
												<div class="funkyradio">
													<div class="funkyradio-primary">
														<t t-if="milestones.status and not manager_record and not collaborator_record">
															<input type="checkbox" checked="checked" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<t t-if="not milestones.status and not manager_record and not collaborator_record">
															<input type="checkbox" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<t t-if="milestones.status and manager_record or milestones.status and collaborator_record">
															<input type="checkbox" checked="checked" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<t t-if="not milestones.status and manager_record or not milestones.status and collaborator_record">
															<input type="checkbox" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<label t-att-for="milestones.id" t-raw="milestones.name" class="milestone_label" t-if="not manager_record and not collaborator_record" />
														<label t-raw="milestones.name" class="milestone_label" t-if="manager_record or collaborator_record" />
													</div>
												</div>
											</div>
										</div>
									</t>
								</div>
								<div t-if="current_goal">
									<h6 class="alert alert-info al text-dark">Goal Plan : Please set goals for the next appraisal period along with the milestones.</h6>
									<t t-foreach="current_goal" t-as="goals">
										<div class="form-group">
											<label class="text-uppercase font-weight-bold" for="goal_name_vals">Goal :</label>
											<br />
											<span t-esc="goals.name" class="col-md-12" id="goal_name_vals" name="goal_name_vals" readonly="1" />
										</div>
										<div class="form-group row ml-0">
											<label class="text-uppercase font-weight-bold">Milestones :</label>
											<div t-foreach="goals.milestone_id" t-as="milestones" class="row col-sm-12" style="left: 1%;">
												<div class="funkyradio">
													<div class="funkyradio-primary">
														<t t-if="milestones.status and not manager_record and not collaborator_record">
															<input type="checkbox" checked="checked" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<t t-if="not milestones.status and not manager_record and not collaborator_record">
															<input type="checkbox" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<t t-if="milestones.status and manager_record or milestones.status and collaborator_record">
															<input type="checkbox" checked="checked" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<t t-if="not milestones.status and manager_record or not milestones.status and collaborator_record">
															<input type="checkbox" t-att-id="milestones.id" t-att-name="milestones.id" onclick="return false" />
														</t>
														<label t-att-for="milestones.id" t-raw="milestones.name" class="milestone_label" t-if="not manager_record and not collaborator_record"/>
														<label t-raw="milestones.name" class="milestone_label" t-if="manager_record or collaborator_record" />
													</div>
												</div>
											</div>
											<label t-if="goals.training" class="text-uppercase font-weight-bold">Need Training(if any) :</label>
											<br />
											<span t-esc="goals.training" class="col-md-12" />
										</div>
										<div t-if="goals.lm_score and manager_inputs_vals" class="form-group">
											<label class="text-uppercase font-weight-bold">LM Score :</label>
											<br />
											<span t-esc="goals.lm_score" class="col-md-12" />
										</div>
										<div t-if="goals.lm_remarks and manager_inputs_vals" class="form-group">
											<label class="text-uppercase font-weight-bold">LM Remark :</label>
											<br />
											<span t-esc="goals.lm_remarks" class="col-md-12" />
										</div>
										<div t-if="goals.ulm_remarks and collaborator_input_vals" class="form-group">
											<label class="text-uppercase font-weight-bold">ULM Remark :</label>
											<br />
											<span t-esc="goals.ulm_remarks" class="col-md-12" />
										</div>
									</t>
									<hr style='border: 4px solid #108fbb;padding:0;border-radius: 4px;' />
								</div>

								<div class="mt-4" t-att-name="'%s' % (survey.id)">
									<table t-foreach="survey.page_ids" t-as="page" id="survey_table" class="table table-bordered auto-index mb-5">
										<h4 t-field="page.title" class="text-uppercase font-weight-bold text-dark" />
										<thead class="thead-orange">
											<tr>
												<t t-set="a" t-value="page.question_ids.mapped('id')" />
												<t t-set="b" t-value="request.env['survey.question'].sudo().search([('id','in',a)]).mapped('type')" />
												<t t-set="c" t-value="request.env['survey.question'].sudo().search([('id','in',a)]).mapped('indicator')" />
												<t t-if="'numerical_box' in b">
													<th scope="col">KRA</th>
												</t>
												<t t-if="'numerical_box' in b">
													<th scope="col">KPI</th>
												</t>
												<t t-else="">
													<t t-if="False not in c and 'textbox' not in b">   
														<th scope="col">
															Competencies
															<span class="text-danger">*</span>
														</th>
													</t>
													<t t-if="False not in c and 'textbox' not in b">   
														<th scope="col" width="40%">
															Behaviour Indicators
														</th>
													</t>
													<t t-if="'textbox'  in b">   
														<th scope="col" width="20%">
															Training Planned hours	
														</th>
														<th scope="col" width="20%">
															Attended hours	
														</th>
														<th scope="col" width="20%">
															Percentage
														</th>
													</t>
													
												</t>
												<t t-if="'textbox' not in b">   
													<th width='10%'>
													Score
													</th>
												</t>
												<th scope="col">
												Justify/Quote an Instance
												</th>
												<t t-if="'textbox' not in b">   
													<th t-if="manager_inputs_vals" width='10%'>
													LM Score
													</th>
												</t>
												<th t-if="manager_inputs_vals" scope="col">
												LM Remarks
												</th>
												<th t-if="collaborator_input_vals" scope="col">
													ULM Score
												</th>
												<th t-if="collaborator_input_vals" scope="col">
												ULM Remarks
												</th>
											</tr>
										</thead>
										<tbody>
											<t t-set="prev_indicator" t-value="" />
											<t t-value="list(set(page.question_ids.mapped('indicator')))" t-set="indicator" />
											<t t-foreach="indicator" t-as="category">
											<tr t-foreach="page.question_ids.filtered(lambda x : x.indicator == category)" t-as="question">
												<t t-set="prefix" t-value="'%s_%s_%s' % (survey.id, page.id, question.id)" />
												<t class="js_question-wrapper" t-att-id="prefix" />
												<!-- <t t-foreach="page.question_ids" t-as="abc">
													<t t-set="cnt" t-value="0" />
													<t t-set="set_indicator" t-value="111" />
													<t t-if="prev_indicator != question.indicator">
														<t t-set="prev_indicator" t-value="question.indicator" />
														<t t-set="set_indicator" t-value="'Yes'" />
													</t>
	
	
													<t t-foreach="page.question_ids" t-as="abc">
														<t t-if="abc.indicator == question.indicator">
															<t t-set="cnt" t-value="cnt+1" />
														</t>
													</t>
													<t t-if="set_indicator == 'Yes'">
														<t t-if="question.type == 'numerical_box'">
															<td scope="col" width='30%' t-att-rowspan='cnt'>
																<span t-field="question.indicator" />
															</td>
														</t>
													</t>
												</t> -->
												<td scope="col" width="40%">
													<t t-if="question.type != 'textbox'">  
														<span t-field="question.question" />
													</t>
													<t t-else="">  
														<span t-esc="planned_training_hours" />
													</t>
													
												</td>
												<t t-if="question.indicator">
													<td scope="col">
														<span t-field="question.indicator" />
													</td>
												</t>
												<!-- Self datas -->
												<td t-if="employee_data_vals" width='10%'>
													<span t-foreach="employee_data_vals" t-as="employee">
														<t t-if="employee.question_id.id == question.id and employee.question_id.type == 'simple_choice'">
															<p t-esc="employee.value_suggested.value" />
														</t>
														<t t-elif="employee.question_id.id == question.id and employee.question_id.type == 'numerical_box'">
															<p t-esc="employee.value_number" />
														</t>
														<t t-elif="employee.question_id.id == question.id and employee.question_id.type == 'textbox'">
															<p t-esc="achieved_duration" />
														</t>
													</span>
												</td>
												<td t-if="employee_data_vals and question.type != 'textbox'" scope="col" width='300px'>
													<span t-foreach="employee_data_vals" t-as="employee">
														<p t-if="employee.question_id.id == question.id" t-esc="employee.value_text" style='word-break: break-word;' />
													</span>
												</td>
												<td t-if="question.type == 'textbox'" scope="col" width='300px'>
													<span>
														<p t-if="question.type == 'textbox'" t-esc="training_percentage" style='word-break: break-word;' />
													</span>
												</td>
												<td t-if="employee_data_vals and question.type=='textbox'" scope="col" width='300px'>
													<span t-foreach="employee_data_vals" t-as="employee">
														<p t-if="employee.question_id.id == question.id and  employee.question_id.type == 'textbox'" t-esc="employee.value_text" style='word-break: break-word;' />
													</span>
												</td>
												<!-- LM datas -->
												<td t-if="manager_inputs_vals" width='10%'>
													<span t-foreach="manager_inputs_vals" t-as="manager">
														<t t-if="manager.question_id.id == question.id and manager.question_id.type == 'simple_choice'">
															<p t-esc="manager.value_suggested.value" />
														</t>
														<t t-elif="manager.question_id.id == question.id and manager.question_id.type == 'numerical_box'">
															<p t-esc="manager.value_number" />
														</t>
														<t t-elif="manager.question_id.id == question.id and manager.question_id.type == 'textbox'">
															<p t-esc="manager.value_text" style='word-break: break-word;' />
														</t>
													</span>
												</td>
												<td t-if="manager_inputs_vals and question.type != 'textbox'" scope="col" width='300px'>
													<span t-foreach="manager_inputs_vals" t-as="manager">
														<p t-if="manager.question_id.id == question.id" t-esc="manager.value_text" style='word-break: break-word;' />
													</span>
												</td>
												<!-- ULM datas -->
												<td t-if="collaborator_input_vals" scope="col" width='300px'>
													<span t-foreach="manager_inputs_vals" t-as="collaborators">
														<t t-if="collaborators.question_id.id == question.id and collaborators.question_id.type == 'simple_choice'">
															<p t-esc="collaborators.value_suggested.value" />
														</t>
														<t t-elif="collaborators.question_id.id == question.id and collaborators.question_id.type == 'numerical_box'">
															<p t-esc="collaborators.value_number" />
														</t>
													</span>
												</td>
											</tr>
											</t>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</t>
		</template>
		<template id="kw_survey_assets_no_result" inherit_id="kw_appraisal.no_result_found">
			<xpath expr="." position="inside">
				<link href="/kwantify_theme/static/src/mdb/css/mdb.min.css?v=12" rel="stylesheet" />
				<link href="/kw_appraisal/static/src/css/front_style.css?v=12" rel="stylesheet" />
				<link href="/kw_appraisal/static/src/css/success.css?v=12" rel="stylesheet" />
				<script type="text/javascript" src="/kwantify_theme/static/src/mdb/js/mdb.min.js?v=12" />
			</xpath>
		</template>
		<template id="kw_survey_assets_results" inherit_id="kw_appraisal.kw_survey_print">
			<xpath expr="." position="inside">
				<link href="/kwantify_theme/static/src/mdb/css/mdb.min.css?v=12" rel="stylesheet" />
				<link href="/kw_appraisal/static/src/css/front_style.css?v=12" rel="stylesheet" />
				<link href="/kw_appraisal/static/src/css/selection_box_arrow.css?v=12" rel="stylesheet" />
				<style>
					table.table.table-bordered tbody tr:hover { background-color: #d1ecf1;}
				</style>
				<script type="text/javascript" src="/kwantify_theme/static/src/mdb/js/mdb.min.js?v=12" />

			</xpath>
		</template>
	</data>
</odoo>