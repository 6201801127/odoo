<odoo>
    <data>

        <!--        Fy Wise  Budget Tree View    class="customer_tree"-->

        <record id="view_fy_wise_budget_plan_tree" model="ir.ui.view">
            <field name="name">fy_wise_budget_plan_tree</field>
            <field name="model">fy_wise_budget_plan</field>
            <field name="arch" type="xml">
                <tree duplicate="false" delete="false" class="budget_allocation_tree">
                    <field name="fy_work_order_id" invisible="1"/>
                    <field name="fy_wo_code"/>
                    <field name ="fy_client_name"/>
                    <field name="fy_order_name"/>
                    <field name="fy_order_value"/>
                    <field name="fy_order_date"/>
                </tree>
            </field>
        </record>

        <!--        search view-->


        <record id="view_fy_budget_allocation_search" model="ir.ui.view">
            <field name="name">view_budget_allocation.view.search</field>
            <field name="model">fy_wise_budget_plan</field>
            <field name="arch" type="xml">
                <search string="Search Description">
                    <field name="fy_wo_code"/>
                    <field name="fy_client_name"/>
                    <field name="fy_order_name"/>
                    <field name="fy_order_value"/>
                    <field name="fy_order_date"/>
                    <field name="fy_plan_year"/>
                    <filter name="fiscalyr_filter" string="Current Fiscal Year"
                            domain="['&amp;',('fy_plan_year.date_start', '&lt;=',context_today().strftime('%Y-%m-%d')),('fy_plan_year.date_stop', '&gt;=',context_today().strftime('%Y-%m-%d'))]"
                            context="{}" readonly="1"/>
                    <filter name="prev_fiscalyr_filter" string="Previous Fiscal Year"
                            domain="['&amp;', ('fy_plan_year.date_stop', '&lt;', context_today().strftime('%Y-%m-%d')), ('fy_plan_year.date_stop', '&gt;', (context_today() - relativedelta(years=1)).strftime('%Y-%m-%d'))]"
                            context="{}" readonly="1"/>
                    <separator/>
                    <group expand="0" string="Group By">
                        <filter name="group_by_fiscal_year" string="Fiscal Year" context="{'group_by': 'fy_plan_year'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!--    FY Wise  Budget Allocation Form View    -->

        <record model="ir.ui.view" id="view_fy_wise_budget_plan_form">
            <field name="name">fy_wise_budget_plan_form</field>
            <field name="model">fy_wise_budget_plan</field>
            <field name="arch" type="xml">
                <form duplicate="false" delete="false">
                    <header>
                        <button name="applied_fy_budget" string="Apply" type="object" class="btn-success" states="draft"/>
                        <field name="state" widget="statusbar" />
                    </header>
                    <sheet>
                        <group string="Work Order Details" style="background-color: rgb(242, 229, 244);">
                            <group>
                                <field name="fy_work_order_id" attrs="{'readonly': [('state','=','applied')]}" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name ="fy_client_name" readonly="1" force_save="1"/>
                                <field name="fy_plan_year" readonly="1" force_save="1" invisible="1"/>
                                <field name="fy_order_name" force_save="1" readonly="1"/>
                            </group>
                            <group>
                                <field name="fy_wo_code" force_save="1" readonly="1"/>
                                <field name="fy_order_value" readonly="1" style="color: red;" force_save="1"/>
                            </group>
                        </group>
                        <group style="border: 1px solid rgb(242, 229, 244);">
                            <group>
                                <group>
                                    <field name="fy_order_date" force_save="1" readonly="1"/>
                                </group>
                                <group>
                                    <field name="pro_commencement_month" force_save="1" options="{'no_open': True,'no_create':True,'no_edit':True}" required="1" readonly="1"/>
                                </group>
                            </group>
                            <group>
                                <group>
                                    <group>
                                        <field name="pro_month" force_save="0" attrs="{'readonly': [('state','=','applied')]}" required="1"/>
                                    </group>
                                </group>
                                <group>
                                    <label for="tot_project_duration" string="Total Project Duration [As Per Contract]"/>
                                    <div >
                                        <field name="tot_project_duration" class="oe_inline" />
                                        <span style="margin-left: 150px;" ><button name="action_add_budget_plan" type="object" string="Add Plan" class="btn-success fa fa-plus"/></span>

                                    </div>
                                </group>
                            </group>

                        </group>
                        <button name="update_budget_amount_details"  type="object" string="Sync Budget"  class="btn-success fa fa-refresh"/>

                        <group string="Budget Allocate">
                            <field name="fy_account_line_ids"  nolabel="1" widget="x2many_2d_matrix"  field_y_axis="compute_char_data" field_x_axis="fiscal_year" field_value="budget_to_be_planned">
                                <tree delete="0" class="budget_allocation_tree" editable="bottom">
                                    <field name="fiscal_year" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="group_head_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="group_name_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="account_head_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="account_sub_head_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="budget_amount" widget="monetary"/>
                                    <field name="compute_char_data" invisible="1"/>
                                    <field name="budget_to_be_planned" widget="monetary"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="fiscal_year" string="Fiscal Year" options="{'no_open': True,'no_create':True,'no_edit':True}" required="1"/>
                                            </group>
                                            <group>
                                            </group>
                                        </group>

                                        <group string="Allocate Budget Fiscal Year Wise">
                                            <group>

                                            </group>

                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <!--     Fy Wise Budget Action   -->

        <record model="ir.actions.act_window" id="fy_wise_budget_allocation_action_window">
            <field name="name">Financial Year Wise Budget Allocation</field>
            <field name="res_model">fy_wise_budget_plan</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Click to create a new FY Wise Budget Allocation.
                </p>
                <p>
                </p>
            </field>
        </record>
        <!--        Fy Wise Tree View Take Action-->

        <record id="view_fy_wise_budget_plan_take_action_tree" model="ir.ui.view">
            <field name="name">fy_wise_budget_plan_tree</field>
            <field name="model">fy_wise_budget_plan</field>
            <field name="arch" type="xml">
                <tree duplicate="false" delete="false" class="budget_allocation_tree" create="0" edit="0">
                    <field name="fy_work_order_id" invisible="1"/>
                    <field name="fy_wo_code"/>
                    <field name ="fy_client_name"/>
                    <field name="fy_order_name"/>
                    <field name="fy_order_value"/>
                    <field name="fy_order_date"/>
                </tree>
            </field>
        </record>





        <!--    FY Wise  Budget Allocation Form View    -->

        <record model="ir.ui.view" id="view_fy_wise_budget_plan_take_action_form">
            <field name="name">fy_wise_budget_plan_form</field>
            <field name="model">fy_wise_budget_plan</field>
            <field name="arch" type="xml">
                <form duplicate="false" delete="false" create="false">
                    <header>
                        <button name="approved_fy_budget" string="Approve" type="object" class="btn-success" states="applied"/>
                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group string="Work Order Details" style="background-color: rgb(242, 229, 244);">
                            <group>
                                <field name="fy_work_order_id" options="{'no_open': True,'no_create':True,'no_edit':True}" readonly="1"/>
                                <field name ="fy_client_name" readonly="1"/>
                                <field name="fy_order_date" readonly="1" invisible="1"/>
                                <field name="fy_plan_year" readonly="1" invisible="1"/>
                                <field name="fy_order_name" readonly="1"/>
                            </group>
                            <group>

                                <field name="fy_wo_code" readonly="1"/>
                                <field name="fy_order_value" readonly="1" style="color: red;"/>
                            </group>
                        </group>
                        <group style="border: 1px solid rgb(242, 229, 244);">
                            <group>
                                <group>
                                    <field name="fy_order_date" force_save="1" readonly="1"/>
                                </group>
                                <group>
                                    <field name="pro_commencement_month" force_save="1" options="{'no_open': True,'no_create':True,'no_edit':True}" required="1" readonly="1"/>
                                </group>
                            </group>
                            <group>
                                <group>
                                    <group>
                                        <field name="pro_month" force_save="0" required="0" string="Project Commencement [Month]" readonly="1"/>
                                    </group>
                                </group>
                                <group>
                                    <label for="tot_project_duration" string="Total Project Duration [As Per Contract]"/>
                                    <div >
                                        <field name="tot_project_duration"  readonly="1"/>
                                    </div>
                                </group>
                            </group>
                        </group>
                        <group string="Budget Allocate">
                            <field name="fy_account_line_ids"  nolabel="1" widget="x2many_2d_matrix"  field_y_axis="compute_char_data" field_x_axis="fiscal_year" field_value="budget_to_be_planned">
                                <tree delete="0" class="budget_allocation_tree" editable="bottom">
                                    <field name="fiscal_year" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="group_head_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="group_name_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="account_head_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="account_sub_head_id" options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                    <field name="budget_amount" widget="monetary"/>
                                    <field name="compute_char_data" invisible="1"/>
                                    <field name="budget_to_be_planned" widget="monetary"/>
                                </tree>
                                <form>
                                    <sheet>
                                        <group>
                                            <group>
                                                <field name="fiscal_year" string="Fiscal Year" options="{'no_open': True,'no_create':True,'no_edit':True}" required="1" readonly="1"/>
                                            </group>
                                            <group>
                                            </group>
                                        </group>

                                        <group string="Allocate Budget Fiscal Year Wise">
                                            <group>

                                            </group>
                                        </group>
                                    </sheet>
                                </form>
                            </field>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

        <record id="view_fy_wise_budget_allocation_search" model="ir.ui.view">
            <field name="name">view_fy_budget_allocation.view.search</field>
            <field name="model">fy_wise_budget_plan</field>
            <field name="arch" type="xml">
                <search string="Search Description">
                    <field name="fy_wo_code"/>
                    <field name ="fy_client_name"/>
                    <field name="fy_order_name"/>
                    <field name="fy_order_value"/>
                    <field name="fy_order_date"/>
                    <field name="fy_plan_year"/>
                    <filter name="fiscalyr_filter" string="Current Fiscal Year"
                            domain="['&amp;',('fy_plan_year.date_start', '&lt;=',context_today().strftime('%Y-%m-%d')),('fy_plan_year.date_stop', '&gt;=',context_today().strftime('%Y-%m-%d'))]"
                            context="{}" readonly="1"/>
                    <filter name="prev_fiscalyr_filter" string="Previous Fiscal Year"
                            domain="['&amp;', ('fy_plan_year.date_stop', '&lt;', context_today().strftime('%Y-%m-%d')), ('fy_plan_year.date_stop', '&gt;', (context_today() - relativedelta(years=1)).strftime('%Y-%m-%d'))]"
                            context="{}" readonly="1"/>
                    <separator/>
                    <group expand="0" string="Group By">
                        <filter name="group_by_fiscal_year" string="Fiscal Year" context="{'group_by': 'fy_plan_year'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!--        Fy Wise Budget Allocation Take Action-->

        <record model="ir.actions.act_window" id="fy_wise_budget_allocation_take_action_window">
            <field name="name">Financial Year Wise Budget Allocation Take Action</field>
            <field name="res_model">fy_wise_budget_plan</field>
            <field name="view_mode">tree,form</field>
            <field name="view_type">form</field>
            <field name="search_view_id" ref='view_fy_wise_budget_allocation_search'/>
            <field name="domain">[('state', '=', 'applied')]</field>
            <field name="view_ids"
                   eval="[(5, 0, 0),
                (0, 0, {'view_mode': 'tree', 'view_id': ref('kw_budget.view_fy_wise_budget_plan_take_action_tree')}),
                (0, 0, {'view_mode': 'form', 'view_id': ref('kw_budget.view_fy_wise_budget_plan_take_action_form')})
                ]" />
        </record>

    </data>
</odoo>