<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
		<!-- model.name form view -->
		<record id="kw_kt_view_form" model="ir.ui.view">
			<field name="name">kt view Form</field>
			<field name="model">kw_kt_view</field>
			<field name="priority">86</field>
			<field name="arch" type="xml">
				<form string="KT View" delete='false'>
					<header>
						<field name="state" widget="statusbar"
						       statusbar_visible="Draft,Applied,Approved,Rejected,Scheduled,Completed"/>
						<button name="btn_comp" type="object" string="Complete KT" class="text-center btn btn-success"
						        attrs="{'invisible':['|',('is_completed','=',False),('state', 'not in', ['Approved'])]}"/>
						<button name="btn_apply" type="object" string="Apply" class="text-center btn btn-success"
						        attrs="{'invisible':[('state', 'not in', ['Draft'])]}"/>
						<button name="btn_re_apply" type="object" string="Re-Apply" class="text-center btn btn-success"
						        attrs="{'invisible':[('state', 'not in', ['Rejected'])]}"/>

					</header>
					<sheet>
						<group>
							<group>
								<field name="manual" invisible="1"/>
								<field name="is_completed" invisible="1"/>
								<field name="is_RA" invisible="1"/>
								<field name="applied_for" widget="radio" options="{'horizontal': True}"
								       attrs="{'invisible': [('is_RA','!=',True)],'readonly': ['|',('state', 'not in', ['Applied']),('id', '>',0)]}"
								       invisible='1'/>
								<field name="applicant_id"
								       options="{'no_edit': True,'no_open':True,'no_create':True}"
								       attrs="{'invisible': [('applied_for','=','self')],'readonly':[('state', '!=', 'Draft')]}"/>
								<field name="kt_type_id"
								       options="{'no_edit': True,'no_open':True,'no_create':True}"
								       attrs="{'readonly':['|',('state', '!=', 'Draft'),('manual', '=', False)]}"/>
								<field name='effective_form' attrs="{'invisible':[('manual', '=', True)]}"
								       readonly='1'/>
								<field name='last_working_date' attrs="{'invisible':[('manual', '=', True)]}"
								       readonly='1'/>

							</group>
						</group>
						<notebook>
							<page string="KT Schedule">
								<field name="id" invisible="1"/>
								<field name="kt_end" invisible="1"/>
								<field name="project_str_ids" invisible="1"/>
								<field name="time_line_plan_ids"
								       attrs="{'readonly': [('state', 'not in', ['Draft','Approved','Applied','Scheduled'])]}">
									<tree editable="bottom" delete='false'>
										<field name="code" invisible="1"/>
										<!-- <field name="check_state" invisible="1"/> -->
										<field name="kt_status" invisible="1"/>
										<field name='kt_type' required='1'
										       attrs="{'readonly': [('kt_status','in',['Approved'])]}"/>
										<field name='activities'
										       attrs="{'readonly': ['|',('kt_type','!=','others'),('kt_status','in',['Approved'])],'required': [('kt_type','=','others')]}"/>
										<field name="project_id"
										       options="{'no_open': True,'no_create':True,'no_edit':True}"
										       attrs="{'readonly': ['|',('kt_type','=','others'),('kt_status', 'in', ['Approved','Upload','Scheduled','Rejected','Completed'])],
										       'required': [('kt_type','!=','others')]}"/>
										<field name="description"
										       attrs="{'readonly': [('kt_status','in',['Approved','Upload','Scheduled','Rejected','Completed'])]}"/>
										<field name="employee_ids" widget="many2many_tags"
										       options="{'no_open': True,'no_create':True,'no_edit':True}"
										       attrs="{'readonly': [('kt_status', 'in', ['Approved','Upload','Scheduled','Rejected','Completed'])]}"/>
										<field name="kt_date" attrs="{'readonly': [('kt_status','in',['Upload'])]}"/>
										<field name="start_time" attrs="{'readonly': [('kt_status','in',['Upload'])]}"/>
										<field name="end_time" attrs="{'readonly': [('kt_status','in',['Upload'])]}"/>
										<field name="document_attach" style="width: 50 %%" string="Upload Document"
										       widget="binary" filename="doc_file_name"
										       attrs="{'readonly': ['|',('kt_status','in',['Completed']),('check_document','=',True)],
										       'invisible':[('check_document','=',True)]}"/>
										<field name="doc_file_name" invisible="1"/>
										<field name="status" readonly='1'/>
										<field name="check_document" invisible="1"/>
									</tree>
								</field>
							</page>
							<page string="Additional Documents">
								<field name="id" invisible="1"/>
								<field name="kt_project_doc_ids" context="{'default_project_strs':project_str_ids}">
									<tree>
										<field name="document_attach" widget="binary" filename="doc_file_name"
										       required='1'/>
										<field name="details" required='1'/>
										<field name="project_id"
										       options="{'no_open': True,'no_create':True,'no_edit':True}"/>
										<field name="doc_file_name" invisible="1"/>
									</tree>
								</field>
							</page>
						</notebook>
					</sheet>
					<div class="oe_chatter">
						<field name="message_follower_ids" widget="mail_followers"/>
						<field name="activity_ids" widget="mail_activity"/>
						<field name="message_ids" widget="mail_thread"/>
					</div>
				</form>
			</field>
		</record>

		<!-- model.name tree view -->
		<record id="kw_kt_view_tree" model="ir.ui.view">
			<field name="name">KT View Tree</field>
			<field name="model">kw_kt_view</field>
			<field name="arch" type="xml">
				<tree>
					<!-- <field name="kt_cnfig_rec_check" invisible='1'/> -->
					<!-- <field name="show_button" invisible='1'/> -->
					<field name="kt_type_id"/>
					<field name="apply_date"/>
					<field name="effective_form"/>
					<field name="last_working_date"/>
					<field name="state"/>
					<field name="ra_check" invisible='1'/>
					<field name="dept_head_check" invisible='1'/>
					<field name="action_by"/>
				</tree>
			</field>
		</record>
		<!-- kw_kt_view action window -->
		<record id="kt_view_action" model="ir.actions.act_window">
			<field name="name">KT Application</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">kw_kt_view</field>
			<field name="view_mode">tree,form</field>
			<field name="view_type">form</field>
			<!-- <field name="domain">['&amp;','|',('create_uid','=',uid),('applicant_id.parent_id.user_id','=',uid),('state','not in',['Completed'])]</field> -->
			<field name="domain">[('applicant_id.user_id','=',uid)]</field>
			<field name="view_ids"
			       eval="[(5, 0, 0),
			       (0, 0, {'view_mode': 'tree', 'view_id': ref('kw_kt_view_tree')}),
			       (0, 0, {'view_mode': 'form', 'view_id': ref('kw_kt_view_form')})]"/>
			<field name="help" type="html">
				<p class="o_view_nocontent_smiling_face">
					Records not available.
				</p>
			</field>
		</record>

		<record id="kw_complete_kt_pop_up_form" model="ir.ui.view">
			<field name="name">Confirmation</field>
			<field name="model">kw_kt_view</field>
			<field name="priority" eval="500"/>
			<field name="arch" type="xml">
				<form create='false' edit='false'>
					<div class="row">
						<div class="col-sm-12 mx-auto">
							<p class="h6 font-weight-light text-left text-justify">
								Are you sure to submit?
							</p>
						</div>
					</div>
					<footer>
						<button type="object" name="btn_complete_kt" class="text-center btn btn-info"
						        style="margin-right:10px; width:70px;">Ok
						</button>
						<button string="Cancel" class="btn-danger" special="cancel"/>
					</footer>
				</form>
			</field>
		</record>
		<record id="kw_complete_kt_pop_up_action" model="ir.actions.act_window">
			<field name="name">Release Card</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">kw_kt_view</field>
			<field name="view_type">form</field>
			<field name="view_mode">form</field>
		</record>

		<record id="action_kw_kt_view_pop_up" model="ir.actions.act_window.view">
			<field eval="140" name="sequence"/>
			<field name="view_mode">form</field>
			<field name="view_id" ref="kw_complete_kt_pop_up_form"/>
			<field name="act_window_id" ref="kw_complete_kt_pop_up_action"/>
		</record>

	</data>
</odoo>
