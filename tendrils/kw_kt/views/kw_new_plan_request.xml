<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>
        <!-- model.name form view -->
        <record id="kw_new_plan_request_form" model="ir.ui.view">
            <field name="name">Take Action Form</field>
            <field name="model">kw_kt_view</field>
            <field name="priority">85</field>
            <field name="arch" type="xml">
                <form string="KT View" create='0'>
                    <header>
                        <field name="dept_head_check" invisible="1"/>
                        <field name="forward_check" invisible="1"/>
                        <field name="ra_check" invisible="1"/>
                        <field name="state" widget="statusbar" statusbar_visible="Draft,Applied,Approved,Rejected,Scheduled,Completed"/>
                        <button name="btn_approve" type="object" string="Approve" class="text-center btn btn-success" attrs= "{'invisible': [('state', 'in', ['Approved','Rejected','Scheduled'])]}"/>
                        
                        <button name="btn_complete" type="object" string="Grant" class="text-center btn btn-success" attrs= "{'invisible': [('state', 'not in', ['Scheduled'])]}"/>
                        <button name="btn_reject" type="object" string="Reject" class="text-center btn btn-danger" attrs= "{'invisible': [('state', 'not in', ['Applied','Scheduled'])]}"/>
                    </header>
                    <sheet>
                        <group>
                            <group>
                                <field name="dept_head_check" invisible="1"/>
                                <field name="forward_check" invisible="1"/>
                                <field name="ra_check" invisible="1"/>
                                <field name="manual" invisible="1"/>
                                <field name="is_completed" invisible="1"/>
                                <field name="is_RA" invisible="1"/>
                                <field name="applicant_id" options="{'no_edit': True,'no_open':True,'no_create':True}" readonly='1'/>
                                <field name="kt_type_id" options="{'no_edit': True,'no_open':True,'no_create':True}" readonly="1"/>
                                <field name='effective_form' attrs= "{'invisible':[('manual', '=', True)]}" readonly='1'/>
                                <field name='last_working_date' attrs= "{'invisible':[('manual', '=', True)]}" readonly='1'/>
                                </group><group>
                                <field name="department_id" options="{'no_create': True, 'no_edit':True, 'no_open':True}" readonly="1"/>
                                <field name="division" options="{'no_open': True,'no_create':True,'no_edit':True}" readonly="1"/>
                                <field name="section" options="{'no_open': True,'no_create':True,'no_edit':True}"  readonly="1"/>
                                <field name="practise" options="{'no_open': True,'no_create':True,'no_edit':True}"  readonly="1"/>
                                <field name="job_id" options="{'no_create': True, 'no_edit':True, 'no_open':True}" readonly="1"/>
                           
                            </group>
                        </group>
                        <notebook>
                            <page string="KT Schedule">
                                <field name="id" invisible="1"/>
                                <field name="project_str_ids"  invisible="1"/>
                                <field name="time_line_plan_ids" context="{'form_view_ref':'kw_kt.kw_time_line_plan_form','default_kt_view_id':id}" attrs= "{'readonly': [('state', 'not in', ['Applied','Scheduled'])]}">
                                    <tree editable="bottom">
                                        <field name="kt_status" invisible="1"/>
                                        <field name='kt_type' required='1'/>
                                        <field name='activities' attrs= "{'readonly': ['|',('kt_type','!=','others'),('kt_status','in',['Approved'])],'required': [('kt_type','=','others')]}" />
                                        <field name="project_id"  options="{'no_open': True,'no_create':True,'no_edit':True}" attrs= "{'readonly': ['|',('kt_type','!=','project'),('kt_status', 'in', ['Approved','Upload','Scheduled','Rejected','Completed'])],'required': [('kt_type','=','project')]}"/>
                                        <field name="description" attrs= "{'readonly': [('kt_status','in',['Upload'])]}"/>
                                        <field name="employee_ids" widget="many2many_tags"  options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                        <field name="kt_date"/>
                                        <field name="start_time"/>
                                        <field name="end_time"/>
                                        <field name="status"/>
                                        <field name="document_attach" widget="binary" style = "width: 50 %%" filename="doc_file_name" attrs= "{'readonly': ['|',('kt_status','in',['Approved']),('check_document','=',True)]}"/>
                                        <field name="doc_file_name" invisible="1"/>
                                        <field name="status" readonly='1'/>
                                        <field name="check_document" invisible="1"/>
                                       
                                       </tree>
                                </field>
                            </page> 
                            <page string="Additional Documents" >
                                <field name="id" invisible="1"/>
                                <field name="kt_project_doc_ids"  context="{'default_project_strs':project_str_ids}" >
                                    <tree>
                                <field name="document_attach" widget="binary" filename="doc_file_name" />
                                <field name="details" />
                                <field name="project_id"  options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="doc_file_name" invisible="1"/>
                                </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <!-- model.name tree view -->
        <record id="kw_new_plan_request_tree" model="ir.ui.view">
            <field name="name">Take Action</field>
            <field name="model">kw_kt_view</field>
            <field name="arch" type="xml">
                <tree create='0' edit='0' default_order="id desc" import='0'>
                    <field name="applicant_id" options="{'no_open': True,'no_create':True,'no_edit':True}" />
                    <field name="department_id"/>
                    <field name="division"/>
                    <field name="section"/>
                    <field name="practise"/>
                    <field name="job_id" />
                    <field name="kt_type_id"/>
                    <field name="apply_date" string="KT Apply Date"/>
                    <field name="effective_form"/>
                    <field name="last_working_date"/>
                    <field name="state"/>
                    <button name="btn_take_action" type="object" string="Take Action" class="text-center oe_highlight" attrs= "{'invisible': [('state', 'not in', ['Applied'])]}"/>
                    <button name="btn_complete_take_action" type="object" string="Take Action" class="text-center oe_highlight" attrs= "{'invisible': [('state', 'not in', ['Scheduled'])]}"/>
                    <field name="ra_check" invisible='1'/>
                    <field name="dept_head_check" invisible='1'/>
                    <field name="forward_check" invisible='1'/>
                    <field name="active" invisible='1'/>
                </tree>
            </field>
        </record>

         
<record id="kw_subordinates_plan_form" model="ir.ui.view">
            <field name="name">Subordinates Form</field>
            <field name="model">kw_kt_view</field>
            <field name="priority">87</field>
            <field name="arch" type="xml">
                <form string="KT View" create='0' edit='0'>
                     <sheet>
                        <group>
                            <group>
                                <field name="manual" invisible="1"/>
                                <field name="state" invisible="1"/>
                                <field name="is_completed" invisible="1"/>
                                <field name="is_RA" invisible="1"/>
                                <field name="applied_for" widget="radio" options="{'horizontal': True}" attrs= "{'invisible': [('is_RA','!=',True)],'readonly': ['|',('state', 'not in', ['Applied']),('id', '>',0)]}" invisible='1'/>
                                <field name="applicant_id" options="{'no_edit': True,'no_open':True,'no_create':True}" 
                                    attrs="{'invisible': [('applied_for','=','self')],'readonly':[('state', '!=', 'Draft')]}"/>
                                <field name="kt_type_id" options="{'no_edit': True,'no_open':True,'no_create':True}" attrs= "{'readonly':['|',('state', '!=', 'Draft'),('manual', '=', False)]}"/>
                                <field name='effective_form' attrs= "{'invisible':[('manual', '=', True)]}" readonly='1'/>
                                <field name='last_working_date' attrs= "{'invisible':[('manual', '=', True)]}" readonly='1'/>
                                <field name="department_id" options="{'no_create': True, 'no_edit':True, 'no_open':True}" readonly="1"/>
                                <field name="division" options="{'no_open': True,'no_create':True,'no_edit':True}" readonly="1"/>
                                <field name="section" options="{'no_open': True,'no_create':True,'no_edit':True}"  readonly="1"/>
                                <field name="practise" options="{'no_open': True,'no_create':True,'no_edit':True}"  readonly="1"/>
                                <field name="job_id" options="{'no_create': True, 'no_edit':True, 'no_open':True}" readonly="1"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="KT Schedule">
                                <field name="id" invisible="1"/>
                                <field name="kt_end"  invisible="1"/>
                                <field name="project_str_ids"  invisible="1"/>
                                <field name="time_line_plan_ids"   attrs= "{'readonly': [('state', 'not in', ['Draft','Approved','Scheduled'])]}">
                                    <tree editable="bottom">
                                        <field name="code"  invisible="1"/>
                                        <field name="kt_status" invisible="1"/>
                                        <field name='kt_type' required='1'/>
                                        <field name='activities' attrs= "{'readonly': ['|',('kt_type','!=','others'),('kt_status','in',['Approved'])],'required': [('kt_type','=','others')]}" />
                                        <field name="project_id"  options="{'no_open': True,'no_create':True,'no_edit':True}" attrs= "{'readonly': ['|',('kt_type','!=','project'),('kt_status', 'in', ['Approved','Upload','Scheduled','Rejected','Completed'])],'required': [('kt_type','=','project')]}"/>
                                        <field name="description" attrs= "{'readonly': [('kt_status','in',['Upload'])]}"/>
                                        <field name="employee_ids" widget="many2many_tags"  options="{'no_open': True,'no_create':True,'no_edit':True}"  attrs= "{'readonly': [('kt_status', 'in', ['Approved','Upload','Scheduled','Rejected','Completed'])]}"/>
                                        <field name="kt_date" attrs= "{'readonly': [('kt_status','in',['Upload'])]}"/>
                                        <field name="start_time" attrs= "{'readonly': [('kt_status','in',['Upload'])]}"/>
                                        <field name="end_time" attrs= "{'readonly': [('kt_status','in',['Upload'])]}"/>
                                        <field name="status"/>
                                        <field name="document_attach" widget="binary" filename="doc_file_name"  attrs= "{'readonly': [('kt_status','in',['Completed'])]}"/>
                                        <field name="doc_file_name" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Additional Documents" >
                                <field name="id" invisible="1"/>
                                <field name="kt_project_doc_ids"  context="{'default_project_strs':project_str_ids}" >
                                    <tree>
                                <field name="document_attach" widget="binary" filename="doc_file_name" />
                                <field name="details" />
                                <field name="project_id"  options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                <field name="doc_file_name" invisible="1"/>
                                </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="kw_self_plan_form" model="ir.ui.view">
            <field name="name">Subordinates Form</field>
            <field name="model">kw_kt_view</field>
            <field name="priority">88</field>
            <field name="arch" type="xml">
                <form string="KT View" create='0' edit='0'>
                    <sheet>
                        <group>
                            <group>
                                <field name="dept_head_check" invisible="1"/>
                                <field name="forward_check" invisible="1"/>
                                <field name="ra_check" invisible="1"/>
                                <field name="applicant_id" options="{'no_edit': True,'no_open':True,'no_create':True}" readonly='1'/>
                                <field name="kt_type_id" options="{'no_edit': True,'no_open':True,'no_create':True}" readonly="1"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="KT Schedule">
                                <field name="id" invisible="1"/>
                                <field name="time_line_plan_ids" readonly='1'>
                                    <tree editable="top"> 
                                        <field name="project_id"  options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                        <field name="employee_ids" widget="many2many_tags"  options="{'no_open': True,'no_create':True,'no_edit':True}"/>
                                        <field name="kt_date"/>
                                        <field name="start_time"/>
                                        <field name="end_time"/>
                                        <field name="status"/>
                                        <field name="document_attach" widget="binary" filename="doc_file_name" readonly='1'/>
                                        <field name="doc_file_name" invisible="1"/>
                                        </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>
        
        <record id="kw_subordinates_plan_tree" model="ir.ui.view">
            <field name="name">Subordinates Tree</field>
            <field name="model">kw_kt_view</field>
            <field name="arch" type="xml">
                <tree create='0' edit='0' default_order="sort asc" decoration-warning="state == 'Rejected'" decoration-success="state == 'Completed'" import='0'>
                    <field name="kt_type_id"/>
                    <field name="applicant_id" options="{'no_open': True,'no_create':True,'no_edit':True}" />
                    <field name="job_id"  options="{'no_open': True,'no_create':True,'no_edit':True}" />
                    <field name="department_id"  options="{'no_open': True,'no_create':True,'no_edit':True}" />
                    <field name="division"  options="{'no_open': True,'no_create':True,'no_edit':True}" />
                    <field name="apply_date"/>
                    <field name="effective_form"/>
                    <field name="last_working_date"/>
                    <field name="state"/>
                    <field name="ra_check" invisible='1'/>
                    <field name="dept_head_check" invisible='1'/>
                    <field name="forward_check" invisible='1'/>
                    <field name="action_taken_by"/>
                    <field name="sort" invisible='1'/>
                    </tree>
            </field>
        </record>

<record id="kw_self_plan_tree" model="ir.ui.view">
            <field name="name">Subordinates Tree</field>
            <field name="model">kw_kt_view</field>
            <field name="arch" type="xml">
                <tree create='0' edit='0' default_order="id desc">
                    <field name="applicant_id" options="{'no_open': True,'no_create':True,'no_edit':True}" />
                    <field name="kt_type_id"/>
                    <field name="apply_date"/>
                    <field name="state"/>
                    <field name="ra_check" invisible='1'/>
                    <field name="dept_head_check" invisible='1'/>
                    <field name="forward_check" invisible='1'/></tree>
            </field>
        </record>
        <!-- New Plan request action window -->
        <record id="kt_report_self_action" model="ir.actions.act_window">
            <field name="name">Self KT Report</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">kw_kt_view</field>
            <field name="view_mode">form,tree</field>
            <field name="domain">[('applicant_id.user_id','=',uid)]</field>
            <field name="view_ids" eval="[(5, 0, 0),(0, 0, {'view_mode': 'tree', 'view_id': ref('kw_self_plan_tree')}),(0, 0, {'view_mode': 'form', 'view_id': ref('kw_self_plan_form')})]"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Records not available.
                </p>
            </field>
        </record>
        <record id="kt_subordinates_plan_action" model="ir.actions.act_window">
            <field name="name"> KT Report</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">kw_kt_view</field>
            <field name="view_mode">form,tree</field>
            <field name="view_ids" eval="[(5, 0, 0),(0, 0, {'view_mode': 'tree', 'view_id': ref('kw_subordinates_plan_tree')}),(0, 0, {'view_mode': 'form', 'view_id': ref('kw_subordinates_plan_form')})]"/>
            <!-- <field name="domain">['|','|',('applicant_id.user_id','=',uid),('applicant_id.parent_id.user_id','=',uid),('applicant_id.department_id.manager_id.user_id','=',uid)]</field> -->
            <field name='domain'>[]</field>
            <field name="context">{'kt_report': True}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Records not available.
                </p>
            </field>
        </record>
        <record id="kt_new_plan_request_action" model="ir.actions.act_window">
            <field name="name">KT Plan Take Action</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">kw_kt_view</field>
            <field name="view_mode">tree</field>
            <!-- <field name="domain">['|','&amp;',('applicant_id.parent_id.user_id','=',uid),('state','in',['Applied','Scheduled']),'&amp;',('stored_forward_emp_id.user_id','=',uid),('state','=','Forwarded')]</field> -->
            <field name="domain">[('applicant_id.parent_id.user_id','=',uid),('state','in',['Applied','Scheduled'])]</field>
            <field name="view_ids" eval="[(5, 0, 0),(0, 0, {'view_mode': 'tree', 'view_id': ref('kw_new_plan_request_tree')})]"/>

            <!-- <field name="view_type">form</field> -->
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Records not available.
                </p>
            </field>
        </record>
    </data>
</odoo>