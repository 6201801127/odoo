<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>
		<record id="kw_greetings_employee_birthday_kanban_view" model="ir.ui.view">
			<field name="name">Employee Greetings</field>
			<field name="model">hr_employee_greetings</field>
			<field name="arch" type="xml">

				<!-- default_order="birthday_month asc"  class="o_hr_employee_kanban"  js_class="send_wish_kanban" -->
				<kanban class="o_hr_employee_kanban" edit="false" quick_create="false"
				        default_order="greeting_type_int desc">

					<field name="id"/>
					<field name="greeting_type_int"/>
					<field name="greeting_type"/>

					<field name="birthday_month"/>
					<field name="birthday"/>

					<field name="anniversary_month"/>
					<field name="wedding_anniversary"/>
					<field name="formatted_wedding_anniversary"/>

					<field name="date_of_joining"/>
					<field name="joining_month"/>

					<field name="work_anniversary_years"/>
					<field name="work_anniversary_day"/>

					<field name="send_wish_status"/>
					<field name="emp_id"/>
					<field name="user_send_wish_status"/>
					<templates>
						<t t-name="kanban-box">
							<div class="o_kanban_record_has_image_fill o_hr_kanban_record">
								<!-- Medium employee's picture -->

								<div class="o_kanban_image_fill_left d-none d-md-block"
								     t-attf-style="background-image: url(#{kanban_image('hr.employee', 'image_medium', record.emp_id.raw_value)})"
								     role="img"/>

								<!-- Employee's picture optimized for mobile -->

								<div class="o_kanban_image d-md-none rounded-circle"
								     t-attf-style="background-image: url(#{kanban_image('hr.employee', 'image_small', record.emp_id.raw_value)})"
								     role="img"/>

								<div class="oe_kanban_details">
									<div class="o_kanban_record_top">
										<div class="o_kanban_record_headings">
											<strong class="o_kanban_record_title">
												<field name="name"/>
											</strong>
											<!--  <span t-if="record.department_id.raw_value" class="o_kanban_record_subtitle"><field name="department_id"/></span> -->
											<span t-if="record.job_id.raw_value" class="o_kanban_record_subtitle">
												<field name="job_id"/>
											</span>
											<!-- <ul>
												<li t-if="record.job_id.raw_value"><field name="job_id"/></li>
											</ul>  -->
										</div>

										<!--   <t t-esc="record.user_send_wish_status.raw_value" /> -->
									</div>

									<t t-if="record.greeting_type.raw_value == 'birth_day'">
										<field name="formatted_birthday"/>
									</t>

									<t t-elif="record.greeting_type.raw_value == 'anniversary'">
										<field name="formatted_wedding_anniversary"/>
									</t>

									<span t-elif="record.greeting_type.raw_value == 'year_of_service'"
									      class="o_kanban_record_subtitle">
										<t t-esc="record.work_anniversary_years.raw_value"/>
										Year(s)
										<br/>
										<t t-esc="record.work_anniversary_day.raw_value"/>
									</span>

									<t t-elif="record.well_wish_subject.raw_value">
										<span class="text-info">
											<field name="well_wish_subject"/>
										</span>
										<br/>
										<small>
											<field name="formatted_wish_date"/>
										</small>
									</t>

									<ul>
										<t t-if="(record.send_wish_status.raw_value == 1)">
											<div class="row">
												<div class="col-12 o_kanban_primary_left">

													<t t-if="record.user_send_wish_status.raw_value == 0">
														<button class="btn btn-info" name="button_send_wishes"
														        type="object">Send Wishes
														</button>
													</t>
													<t t-else="">
														<i class="fa fa-fw o_button_icon fa-check text-success"/>
														Message Sent
													</t>
												</div>
											</div>
										</t>
									</ul>
								</div>
							</div>
						</t>
					</templates>
				</kanban>
			</field>
		</record>

		<!-- js_class="send_wish_tree"  -->
		<!-- <record id="kw_greetings_employee_birthday_tree_view" model="ir.ui.view">
			<field name="name">Employee Greetings Tree</field>
			<field name="model">hr_employee_greetings</field>
			<field name="arch" type="xml">
				<tree default_order="greeting_type_int desc">
					<field name="name"/>
					<field name="department_id"/>
					<field name="job_id"/>
					<field name="formatted_birthday" attrs="{'invisible':['|',('greeting_type','!=','birth_day')]}" />
					<field name="formatted_wedding_anniversary" string="Anniversary" attrs="{'invisible':['|',('greeting_type','!=','anniversary')]}" />

					<field name="work_anniversary_years" string="Experience in year(s)" attrs="{'invisible':['|',('greeting_type','!=','year_of_service')]}" />
					<field name="work_anniversary_day" string="Year of Service" attrs="{'invisible':['|',('greeting_type','!=','year_of_service')]}" />

					<field name="birthday_day" invisible="1"/>
					<field name="birthday_month" invisible="1"/>

					<field name="greeting_type" invisible="1"/>

					<field name="anniversary_month" invisible="1"/>
					<field name="anniversary_day" invisible="1"/>

					<field name="joining_month" invisible="1"/>
					<field name="joining_day" invisible="1"/>

					<field name="send_wish_status" invisible="1"/>
					<field name="user_send_wish_status" invisible="1"/>


					<button class="btn btn-info" string="Send Wishes" name="button_send_wishes" type="object" attrs="{'invisible': ['|',('send_wish_status', '=',0),('user_send_wish_status', '&gt;',0)]}"  />

					<button string="Message Sent" attrs="{'invisible': [('send_wish_status', '=',1),('user_send_wish_status', '=',0)]}"  type="button" icon="fa-check text-success"  />

				</tree>
			</field>
		</record> -->

		<record id="view_kw_greetings_employee_birthday_filter" model="ir.ui.view">
			<field name="name">kw_greetings_birthday_employee_filter_records</field>
			<field name="model">hr_employee_greetings</field>
			<field name="arch" type="xml">
				<search string="Search Birthdays">
					<field name="name"/>
					<field name="department_id"/>
					<field name="job_id"/>

					<filter string="Today's Greetings" domain="[('send_wish_status', '=',1)]" name="today_greetings"/>

					<filter string="Current Month Greetings"
					        domain="['|','|',('birthday', 'like',context_today().strftime('%-%m-%')),('date_of_joining', 'like',context_today().strftime('%-%m-%')), ('wedding_anniversary', 'like',context_today().strftime('%-%m-%'))]"
					        name="upcoming_greetings"/>
					<separator/>
					<filter string="Birthdays" domain="[('greeting_type', '=','birth_day')]" name="only_birthday"/>


					<filter string="Year of Services" domain="[('greeting_type', '=','year_of_service')]"
					        name="only_work_anniversay"/>

					<filter string="Anniversaries" domain="[('greeting_type', '=','anniversary')]"
					        name="only_anniversary"/>

					<filter string="Well Wishes" domain="[('greeting_type', '=','well_wish')]"
					        name="only_well_wish"/>
					<separator/>
					<filter string="January"
					        domain="['|','|',('birthday_month', '=',1),('joining_month', '=',1),('anniversary_month', '=',1)]"
					        name="january_birthday"/>
					<filter string="February"
					        domain="['|','|',('birthday_month', '=',2),('joining_month', '=',2),('anniversary_month', '=',2)]"
					        name="february_birthday"/>
					<filter string="March"
					        domain="['|','|',('birthday_month', '=',3),('joining_month', '=',3),('anniversary_month', '=',3)]"
					        name="march_birthday"/>
					<filter string="April"
					        domain="['|','|',('birthday_month', '=',4),('joining_month', '=',4),('anniversary_month', '=',4)]"
					        name="april_birthday"/>
					<filter string="May"
					        domain="['|','|',('birthday_month', '=',5),('joining_month', '=',5),('anniversary_month', '=',5)]"
					        name="may_birthday"/>
					<filter string="June"
					        domain="['|','|',('birthday_month', '=',6),('joining_month', '=',6),('anniversary_month', '=',6)]"
					        name="june_birthday"/>
					<filter string="July"
					        domain="['|','|',('birthday_month', '=',7),('joining_month', '=',7),('anniversary_month', '=',7)]"
					        name="july_birthday"/>
					<filter string="August"
					        domain="['|','|',('birthday_month', '=',8),('joining_month', '=',8),('anniversary_month', '=',8)]"
					        name="august_birthday"/>
					<filter string="September"
					        domain="['|','|',('birthday_month', '=',9),('joining_month', '=',9),('anniversary_month', '=',9)]"
					        name="sepetember_birthday"/>
					<filter string="October"
					        domain="['|','|',('birthday_month', '=',10),('joining_month', '=',10),('anniversary_month', '=',10)]"
					        name="oct_birthday"/>
					<filter string="November"
					        domain="['|','|',('birthday_month', '=',11),('joining_month', '=',11),('anniversary_month', '=',11)]"
					        name="nov_birthday"/>
					<filter string="December"
					        domain="['|','|',('birthday_month', '=',12),('joining_month', '=',12),('anniversary_month', '=',12)]"
					        name="dec_birthday"/>

					<group expand="0" string="Group By">
						<filter name="group_greeting_type" string="Greeting Type"
						        context="{'group_by':'greeting_type'}"/>
					</group>

				</search>
			</field>
		</record>

		<record id="kw_greetings_employee_birthday_action_window" model="ir.actions.act_window">
			<field name="name">Greetings</field>
			<field name="res_model">hr_employee_greetings</field>
			<field name="view_mode">kanban</field>

			<field name="context">{'search_default_today_greetings':1,'search_default_group_greeting_type':1}</field>
			<field name="domain">[]</field>
			<field name="help" type="html">
				<p class="o_view_nocontent_smiling_face">
					There is no greetings today..
				</p>
			</field>
		</record>

		<menuitem name="Greetings" id="kw_greetings_emp_birthday_menu" parent='kw_greetings_parent_menu' sequence="1"
		          action="kw_greetings_employee_birthday_action_window"/>

	</data>
</odoo>

